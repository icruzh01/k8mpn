<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Emergencia k8</title>
    <!-- Web App Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icons/favicon-32x32.png">
    <!-- Incluir jsQR desde un CDN -->
    <script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Three.js para efectos 3D -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <!-- Meta tags para mejorar la experiencia -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Emergencia">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
   
    <!-- Estilos -->
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            background-color: #000000;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            font-family: Arial;
            position: relative;
            overflow: hidden;
        }

        /* Evitar selección de texto y elementos */
        body {
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* IE10+/Edge */
            user-select: none; /* Estándar */
        }

        /* Permitir selección solo en campos de entrada y textarea */
        input, textarea {
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
        }

        /*---------------- CONTENEDOR  DEL  M A P A  ---------------------------------*/
        #map-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            transition: filter 0.5s ease;
        }

        /* Estilos para el mapa */
        #map {
            width: 100%;
            height: 100%;
        }

        /*----------- Botón para cambiar el modo - icono Modo DÍA y NOCHE --------------------*/
        #theme-toggle {
            position: fixed;
            top: 80px; /* Cambiado de bottom a top */
            left: 10px; /* Alinera a la izquierda */
            z-index: 1000;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            font-size: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            /* Eliminado transform: translateX(-50%); ya que no es necesario con left fijo */
        }

        /* Modo oscuro */
        .dark-mode {
            filter: grayscale(50%) invert(100%) brightness(110%) contrast(1.2) hue-rotate(180deg);
        }
        
        /*--------- Mensaje INICIAL -------------------------*/

        /* Contenedor del fondo negro */
        #initialMessageContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgb(0, 0, 0);
            z-index: 1020;
        }

        /* Contenedor del contenido (texto y línea) */
        #initialMessageContent {
            position: absolute;
            font-family: sans-serif;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
            font-weight: 500;
            letter-spacing: 4px;
            min-height: auto;
            justify-content: center;
            align-items: center;
            font-size: 2.3rem;
            letter-spacing: 4px;
            z-index: 1009;
        }

        /* Animación para el contenido */
        @keyframes slideUpAndFade {
            0% {
                transform: translate(-50%, -50%);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -300%);
                opacity: 1;
            }
        }

        /* Clase para aplicar la animación */
        .slide-up-and-fade {
            animation: slideUpAndFade 1s forwards;
        }

        /* Dentro de este Header se encuentran los Códigos*/
        header {
            width: 100%;
            height: 70px;
            background: linear-gradient(to bottom, #000000, #000000d7, #000000c0, #000000a5, #00000098, #00000070, #00000030, #00000005);
            color: #b4b4b4;
            text-align: center;
            align-items: center;
            flex-direction: column;
            padding: 0;
            z-index: 1000;
        }
        
        /*header h1 {
            width: 100%;
            background-color: #44ff00;
            color: #ef0303;
            text-align: center;
            padding: 20px 0;
            margin: 0;
            z-index: 2000;
        } */

        /*------- Efectos LUCES CÓDIGOS TORRETA ---------------------------------------*/
        .codigos {
            margin-bottom: 2px;
            border: 0;
            height: 8px;
            width: 100%;
            background: linear-gradient(to right, #770000, #770000 41.33%, #770000 49.33%, #001eb4 53.33%, #001eb4 66.66%, #001eb4 100%);
            box-shadow: 0 0 5px #740000, 0 0 10px #740000, 0 0 20px #250000, 0 0 40px #00009b, 0 0 80px #00009b;
            animation: neon-blink 1s infinite;
            position: relative;
            overflow: hidden;
            border-radius: 50%;
            z-index: 1001;
        }

        /* Pseudo-elemento para el efecto de barra roja */
        .codigos::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 20%;
            height: 100%;
            background: linear-gradient(to right, transparent, #ff0000 50%, transparent);
            animation: move-red 1.5s infinite;
        }

        /* Pseudo-elemento para el efecto de barra azul */
        .codigos::after {
            content: '';
            position: absolute;
            top: 0;
            right: -100%;
            width: 20%;
            height: 100%;
            background: linear-gradient(to left, transparent, #00b7ff 50%, transparent);
            animation: move-blue 1.5s infinite;
        }

        /* Animación para mover la barra roja */
        @keyframes move-red {
            0% {
                left: 0%;
            }
            50% {
                left: 30%;
            }
            100% {
                left: 0%;
            }
        }

        /* Animación para mover la barra azul */
        @keyframes move-blue {
            0% {
                right: 0%;
            }
            50% {
                right: 30%;
            }
            100% {
                right: 0%;
            }
        }

        /* Animación de parpadeo neón */
        @keyframes neon-blink {
            0%, 60% {
                box-shadow: 0 0 2px #ff0000c0, 0 0 10px #ff0000c0, 0 0 20px #ff0000c0, 0 0 40px #ff0000c0, 0 0 80px #ff0000c0;
            }
            25%, 75% {
                box-shadow: 0 0 2px #000000, 0 0 10px #000000, 0 0 20px #000000, 0 0 40px #000000, 0 0 80px #000000;
            }
            100% {
                box-shadow: 0 0 2px #00b7ffc0, 0 0 10px #00b7ffc0, 0 0 20px #00b7ffc0, 0 0 40px #00b7ffc0, 0 0 80px #00b7ffc0;
            }
        }

        /*---------- Título EMERGENCA k8 ------------------------*/
        h1.title_1 {
            position: relative;
            padding: 0;
            margin: 0 auto; /* Centra horizontalmente y elimina márgenes innecesarios */
            top: -5px;
            font-family: sans-serif;
            text-transform: none;
            display: flex;
            justify-content: center; /* Centra el contenido horizontalmente */
            align-items: center; /* Centra el contenido verticalmente */
            text-align: center;
            color: #000000;
            width: 100%; /* Ocupa todo el ancho disponible */
            max-width: 400px; /* Máximo ancho permitido */
            height: 70px;
            font-weight: 900;
            font-size: 2rem;
            letter-spacing: 4px;
            text-shadow: 0 0 5px #ffffff, 0 0 10px #ffffff;
            -webkit-text-stroke: 1px rgb(255, 255, 255);
            z-index: 1000;
        }
        
        /*h1.title_2 {
            position: relative;    
            margin: 0;
            bottom: 35px;
            margin-bottom: 30px;
            padding: 0 0;
            font-family: sans-serif;
            text-transform: lowercase;
            min-height: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #000000;
            font-weight: 500;
            font-size: 2.3rem;
            letter-spacing: 4px;
            z-index: 1000; 
        } */
        
        /*---------- GIRO y NOMBRE del Establecimiento ------------------*/
        h1.giroNegocio {
            top: 150px;
            margin-bottom: 11px;
            padding: 0 0;
            font-family: sans-serif;
            text-transform: capitalize;
            min-height: 0;
            display: block;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: #ffffff;
            position: relative;
            font-weight: 900;
            font-size: 1.8rem;
            letter-spacing: 4px;
            text-shadow:0 0 2px #ff0000, 0 0 4px #ff0000;
            z-index: 1000;
        }

        h1.nombreNegocio {
            top: 130px;
            margin-bottom: 20px;
            padding: 0 0;
            font-family: sans-serif;
            text-transform: capitalize;
            min-height: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: #ffffff;
            position: relative;
            font-weight: 900;
            font-size: 1.8rem;
            letter-spacing: 4px;
            text-shadow:0 0 2px #ff0000, 0 0 4px #ff0000;
            z-index: 1000;
        }
        
        /*----------- Estilo para el botón de EMERGENCIA NEGOCIO 3D ------------------------------*/
        
        #emergencyButtonContainer {
            position: relative;
            top: 110px;
            width: 200px;
            height: 200px;
            perspective: 1000px;
            margin: 40px;
            margin-bottom: 60px;
            z-index: 1000;
            filter: drop-shadow(0 0 15px rgba(255, 0, 0, 0.7));
        }

        #emergencyButton3D {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        #emergencyButton3D:active {
            transform: translateZ(-30px) scale(0.9);
            animation: none;
        }

        .button-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            backface-visibility: hidden;
            transition: all 0.3s;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.7);
        }

        .button-front {
            background: radial-gradient(circle at center, #ff3333, #990000);
            transform: translateZ(30px);
            animation: pulse-glow 1.5s infinite alternate, pulse-scale 2s infinite ease-in-out;
        }

        .button-back {
            background: radial-gradient(circle at center, #cc0000, #990000);
            transform: rotateY(180deg) translateZ(30px);
        }

        .button-side {
            background: linear-gradient(to bottom, #ff3333, #cc0000);
            transform: rotateY(90deg) translateZ(100px);
            width: 40px;
            height: 100%;
            left: calc(50% - 20px);
        }

        .button-top {
            background: linear-gradient(to right, #ff6666, #ff3333);
            transform: rotateX(90deg) translateZ(100px);
            height: 40px;
            width: 100%;
            top: calc(50% - 20px);
        }

        /* Nuevas animaciones */

        @keyframes pulse-glow {
            0% {
                box-shadow: 0 0 10px #ff0000, 0 0 20px #ff0000, 0 0 30px #ff0000;
            }
            100% {
                box-shadow: 0 0 20px #ff0000, 0 0 40px #ff0000, 0 0 60px #ff0000;
            }
        }

        @keyframes pulse-scale {
            0%, 100% {
                transform: translateZ(30px) scale(1);
            }
            50% {
                transform: translateZ(30px) scale(1.05);
            }
        }

        #emergencyButton3D:active::after {
            opacity: 1;
            animation: sparkle 0.5s forwards;
        }

        @keyframes sparkle {
            0% {
                transform: scale(0.5);
                opacity: 1;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        /*Oculte los botones URL, GIRO Y NOMBRE porque ya estan en el menu*/

        /*#modifyUrlButton, #modifyGiroButton, #modifyNombreButton {
            background-color: #000000;
            color: #7c7c7c;
            text-transform: uppercase;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 14px;
            width: 100px;
            height: 40px;
            border: 2px solid rgb(65, 61, 61);
            cursor: pointer;
            display: none; /*Le puse none para que no se vean los botones*/
            /* align-items: center;
            justify-content: center;
            text-align: center;
            transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
            box-sizing: border-box;
            /* box-shadow: 3px 3px rgb(157, 151, 151); */
            /* position: absolute;
            bottom: 20px;
            left: 20px;
            margin: 0 0;
        }*/

        /* #modifyUrlButton:active, #modifyGiroButton:active, #modifyNombreButton:active {
            box-shadow: none;
            transform: translate(3px, 3px);
        }

        #modifyGiroButton {
            left: 130px;
        }

        #modifyNombreButton {
            left: 240px;
        }

        #modifyUrlButton:active, #modifyUrlButton.active, #modifyGiroButton:active, #modifyGiroButton.active, #modifyNombreButton:active, #modifyNombreButton.active {
            background-color: #1e90ff;
            border-color: #00bfff;
            transform: scale(0.95);
        } */

        /*Aquí se modifican los mensensajes que se mandan CUANDO NO INGRESAS un dato en los campoos giro, nombre, url*/
        .custom-alert {
            display: none;
            position: fixed;
            width: 300px;
            height: auto; /* Cambiado de altura fija a auto */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #ff0000;
            padding: 20px;
            box-shadow: 0 0 20px #ff0000;
            text-align: center;
            font-size: 20px;
            border-radius: 10px;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1032;
        }

        .custom-alert p {
            margin: 0 0 20px;
            color: #ffffff;
            text-align: center;
            width: 100%;
        }

        /*--- Mensaje que va dentro del contenedor"Ingrese un giro valido" ---*/
        #alertMessage {
            margin: 0; /* Elimina el margen predeterminado del párrafo */
            text-align: center;
            line-height: 1.5; /* Mejora la legibilidad del texto */
            color: #ffffff;
            
        }

        #alertCloseButton {
            background-color: #ff0000;
            color: #ffffff;
            padding: 10px 20px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
            width: auto;
            align-self: center;
        }

        #alertCloseButton:hover {
            background-color: #cc0000; /* Cambia el color de fondo al pasar el mouse */
            border: 2px solid #cc0000; /* Cambia el color del borde al pasar el mouse */
            box-shadow: 0 0 10px #cc0000; /* Cambia el color de la sombra al pasar el mouse */
        }

        #alertCloseButton:active {
            background-color: #990000; /* Cambia el color de fondo al hacer clic */
        }
        
        /* Estilos para el mensaje de CONFIRMACIÓN DE ACTIVACIÓN que aparece despúes de cerrarse la ventana de alerta*/
        .custom-alert.confirmation {
            display: none;
            position: fixed;
            width: 300px;
            height: auto;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #00000050;
            border: 1px solid #00ff00;
            padding: 20px;
            box-shadow: 0 0 20px #00ff00;
            text-align: center;
            font-size: 20px;
            line-height: 1.5;
            border-radius: 10px;
            z-index: 1015;
        }

        /*----------- Estilos para el Mensaje de CONFIRMACIÓN DE ACTIVACIÓN DE EMERGENCIA ------------*/
        .custom-confirm {
            display: none;
            position: fixed;
            width: 280px; /* Ancho un poco mayor para mejor legibilidad */
            height: auto; /* Altura automática para adaptarse al contenido */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #00000050;
            border: 1px solid #f70d1a;
            color: rgb(185, 185, 185);
            padding: 25px;
            box-shadow: 0 0 20px #ff0000;
            z-index: 1010;
            text-align: center;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .custom-confirm p {
            margin: 0 0 25px 0;
            font-size: 18px;
            line-height: 1.4;
            text-align: center;
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .custom-confirm .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            width: 100%;
            margin-top: 5px;
        }

        .custom-confirm button {
            background-color: #000000;
            color: #ffffff;
            border: 2px solid #ff0000;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
            box-shadow: 0 0 10px #f8212c;
            flex: 1;
            max-width: 120px;
        }

        .custom-confirm button:hover {
            background-color: #000000;
            border: 3px solid #0095ff;
            box-shadow: 0 0 10px #0debf7;
        }

        #confirmNo {
            background-color: #000000;
            color: #ffffff;
            border: 2px solid #7a7a7a;
            box-shadow: 0 0 10px #a4a3a3;
        }

        #confirmNo:hover {
            background-color: #000000;
            border: 3px solid #898989;
            box-shadow: 0 0 10px #ffffff;
        }

        /*---------- INPUPT para AGREGAR NUEVA URL -----------------*/
        .custom-url-input {
            /*position: relative; /* Asegura que el botón se posicione relativamente a este contenedor */
            display: none;
            position: fixed;
            width: 250px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #00000050;
            border: 1px solid #ff0000;
            padding: 20px;
            box-shadow: 0 0 20px #ff0000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            border-radius: 10px;
            z-index: 1031;
        }   

        /* Botón [-] dentro del Input URL */
        #scanQRButton {
            position: absolute;
            right: 25px; /* Ajusta la posición a la derecha */
            top: 29%; /* Centra verticalmente */
            transform: translateY(-50%); /* Ajusta el centrado vertical */
            background-color: #000000;
            color: #d41717;
            border: 0px solid #d41717;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 15px;
            border-radius: 5px;
            z-index: 1001; /* Asegura que esté por encima del input */
        }
        
        #scanQRButton:hover {
            background-color: #d41717;
            color: #000000;
        }

        .custom-url-input input {
            width: 90%;
            padding: 10px;
            margin-bottom: 7px;
            font-size: 16px;
            background: #ffbdbd;
            color: #000000;
            border: 1px solid #f50404;
            box-shadow: 0 0 5px #e81717;
            border-radius: 5px;
        }

        .custom-url-input input:hover {
            background: #000000;
            border: 0.5px solid #d41717;
            color: #d41717;
        }

        .custom-url-input input:focus {
            background: #000000;
            border: 0.5px solid #bd0202;
            color: #d41717;
        }

        .custom-url-input .button-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .custom-url-input .button-container button {
            background-color: #000000;
            color: white;
            border: 1px solid #d41717;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
        }

        .custom-url-input .button-container button:hover {
            background-color: #000000;
            border: 2px solid #c20303;
            box-shadow: 0 0 10px #ff0000;
        }
        /*-------- Cuadro para AGREGAR GIRO del establecimiento ------------------*/
        .custom-giro-input {
            display: none;
            position: fixed;
            width: 250px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #00000050;
            border: 1px solid #07edf5;
            padding: 20px;
            box-shadow: 0 0 20px #4ee2ec;
            z-index: 1010;
            text-align: center;
            border-radius: 10px;
        }

        .custom-giro-input input {
            width: 90%;
            padding: 10px;
            margin-bottom: 7px;
            font-size: 16px;
            background: #bbf9ff;
            color: #000000;
            border: 1px solid #07edf5;
            box-shadow: 0 0 5px #4ee2ec;
            border-radius: 5px;
        }

        .custom-giro-input input:hover {
            background: #000000;
            border: 0.5px solid #4ee2ec;
            color: #4ee2ec;
        }

        .custom-giro-input input:focus {
            background: #000000;
            border: 0.5px solid #5cbd02;
            color: #4ee2ec;
        }

        .custom-giro-input .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .custom-giro-input .button-container button {
            background-color: #000000;
            color: white;
            border: 1px solid #4ee2ec;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
        }

        .custom-giro-input .button-container button:hover {
            background-color: #000000;
            border: 2px solid #d7159d;
            box-shadow: 0 0 10px #ec4ebd;
        }
        /*---------- Cuadro para AGREGAR NOMBRE --------------------*/
        .custom-nombre-input {
            display: none;
            position: fixed;
            width: 250px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #00000050;
            border: 1px solid #f30086;
            padding: 20px;
            box-shadow: 0 0 20px #f507dd;
            z-index: 1010;
            text-align: center;
            border-radius: 10px;
        }

        .custom-nombre-input input {
            width: 90%;
            padding: 10px;
            margin-bottom: 7px;
            font-size: 16px;
            background: #ffb1f7;
            color: #000000;
            border: 1px solid #f507dd;
            box-shadow: 0 0 5px #f507dd;
            border-radius: 5px;
        }

        .custom-nombre-input input:hover {
            background: #000000;
            border: 0.5px solid #f507dd;
            color: #f507dd;
        }

        .custom-nombre-input input:focus {
            background: #000000;
            border: 0.5px solid #5cbd02;
            color: #f507dd;
        }

        .custom-nombre-input .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .custom-nombre-input .button-container button {
            background-color: #000000;
            color: white;
            border: 1px solid #f30086;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
        }

        .custom-nombre-input .button-container button:hover {
            background-color: #000000;
            border: 2px solid #027e94;
            box-shadow: 0 0 10px #00d9ff;
        }
        
        /*Fondo destras de los input url, giro, nombre,...*/
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85); /* Fondo opaco */
            z-index: 1010;
        }
        /*----------------  S C A N N E R ---------------------------------------------------*/

        /* Estilos para el contenedor del escáner con efecto glow */
        /*----------------  S C A N N E R ---------------------------------------------------*/
#qrScannerContainer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999; /* Asegurar que esté por encima de todo */
    margin: 0;
    padding: 0;
}

/* Estilos para el video del escáner */
#qrScanner {
    position: relative;
    width: 90%; /* Usar porcentaje para mejor adaptación */
    max-width: 400px; /* Máximo ancho */
    height: auto;
    aspect-ratio: 1/1; /* Mantener relación cuadrada */
    border: 2px solid rgb(0, 94, 255);
    object-fit: cover;
    background-color: black;
    border-radius: 15px;
    box-shadow: 0 0 10px rgba(1, 104, 133, 0.8), 
                0 0 20px rgba(0, 112, 211, 0.8), 
                0 0 30px rgba(1, 145, 255, 0.8);
    z-index: 10000;
}

/* Efecto láser para el escáner QR */
#qrLaser {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    height: 3px;
    background: linear-gradient(to right, 
        rgba(0, 255, 255, 0), 
        rgba(255, 0, 0, 0.9), 
        rgba(0, 255, 255, 0));
    box-shadow: 0 0 10px rgba(255, 0, 0, 0.9),
                0 0 20px rgba(255, 0, 0, 0.7);
    border-radius: 100%;
    animation: laser-scan 2s infinite alternate ease-in-out;
    z-index: 10001;
    display: none;
    top: 10%;
}

/* Animación del láser con márgenes */
@keyframes laser-scan {
    0% {
        top: 30%;
        opacity: 0.8;
    }
    100% {
        top: 70%;
        opacity: 1;
    }
}

/* Estilos para el botón de cerrar el escáner */
#closeScannerButton {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: #ff0000;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 30px;
    cursor: pointer;
    font-size: 16px;
    display: none;
    box-shadow: 0 0 10px rgba(255, 0, 0, 0.8);
    z-index: 10002;
    font-weight: bold;
}

#closeScannerButton:hover {
    background-color: #cc0000;
    box-shadow: 0 0 15px rgba(255, 0, 0, 1);
}


/* Estilos para el loader del escáner QR */
.qr-loader {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10002; /* Por encima del video pero debajo del botón cerrar */
    display: none; /* Inicialmente oculto */
}

.loader-content {
    text-align: center;
    color: white;
}

.loader-spinner {
    width: 50px;
    height: 50px;
    border: 5px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: #00bfff;
    animation: spin 1s ease-in-out infinite;
    margin: 0 auto 15px;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}


/* Efecto de resplandor azul neón para el input */
.neon-glow {
    animation: neon-glow-effect 1.5s ease-in-out;
    box-shadow: 0 0 10px #00bfff, 0 0 20px #00bfff, 0 0 30px #00bfff;
}

@keyframes neon-glow-effect {
    0% {
        box-shadow: 0 0 5px #00bfff;
    }
    50% {
        box-shadow: 0 0 20px #00bfff, 0 0 30px #00bfff;
    }
    100% {
        box-shadow: 0 0 5px #00bfff;
    }
}







        /* Estilos para los botones "Guardar", "Borrar" y "Cancelar" que se encuentran en los diferentes inputs ---*/
        .button-container {
            display: flex;
            justify-content: center;
            gap: 10px; /* Espacio entre los botones */
            margin-top: 20px;
            z-index: 1000;
        }

        /*---- Estilos para botones Tipo de Emergencia c5,cuadrante,extorsión y conocido, estan debajo del botón de emeregencia ------*/

        .button-containerTipoEmergencias {
            position: fixed;
            display: flex;
            justify-content: center;
            gap: 10px;
            top: 650px;
            flex-wrap: wrap;
            width: 100%;
            z-index: 1000;
        }

        .custom-button {
            display: flex;
            background-color: #000000;
            color: #FFFFFF;
            text-transform: uppercase;
            /*padding: 10px 20px;*/
            border-radius: 10px;
            font-size: 10px;
            width: 70px;
            height: 40px;
            border: 2px solid rgb(255, 0, 0);
            cursor: pointer;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
            box-sizing: border-box;
            box-shadow: 3px 3px rgb(250, 0, 0);
        }
        /* Te da el efecto de "Pulsar en profundidad" de los botones*/
        .custom-button:active {
            box-shadow: none;
            transform: translate(3px, 3px);
        }


        /* Estilo para botones activos */
        /*.custom-button.active {
            background: rgb(0, 0, 0);
            color: white;
            box-shadow: none;
            transform: translate(3px, 3px);
        } */


        /* Estilo cuando el botón está deshabilitado */
        /*.custom-button:disabled {
            background-color: #047900; /* Fondo más oscuro */
            /*color: #ffffff;
            border-color: #09ff00; /* Borde más claro */
            /*cursor: not-allowed; /* Cambiar el cursor a "no permitido" */
            /*box-shadow: none; /* Eliminar la sombra */
            /*opacity: 0.7; /* Reducir la opacidad */
        /*}


        /*--------------- C5 NEGOCIO ---------------------------*/
        #c5Button {
            background: #3a3a3a;
            border: 2px solid #960000;
            color: rgb(148, 148, 148);
            box-shadow: 5px 5px #700000;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        /* Estilo cuando el botón está activo (durante el clic) */
        #c5Button:active, #c5Button.active {
            background: rgb(0, 0, 0);
            color: white;
            border: 2px solid #ff0000;
            box-shadow: 0 0 10px #e20000, 0 0 20px #ff0000;
            transform: translate(3px, 3px);
        }
        /*-------------------- CUADRANTE --------------------------*/
        
        #cuadranteButton {
            background: #3a3a3a;
            border: 2px solid #005f8b;
            color: rgb(116, 116, 116);
            box-shadow: 5px 5px #004e72;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        /* Estilo cuando el botón está activo (durante el clic) */
        #cuadranteButton:active, #cuadranteButton.active {
            background: rgb(0, 0, 0);
            color: white;
            border: 2px solid #0084ff;
            box-shadow: 0 0 10px #0084ff, 0 0 20px #0084ff;
            transform: translate(3px, 3px);
        }

        /*--------------------- EXTORSIÓN ------------------------*/
        
        #extorsionButton {
            background: #3a3a3a;
            border: 2px solid #cc5500;
            color: rgb(116, 116, 116);
            box-shadow: 5px 5px #813600;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        /* Estilo cuando el botón está activo (durante el clic) */
        #extorsionButton:active, #extorsionButton.active {
            background: rgb(0, 0, 0);
            color: white;
            border: 2px solid #ffaa00;
            box-shadow: 0 0 10px #ffaa00, 0 0 20px #ffaa00;
            transform: translate(3px, 3px);
        }

        /*---------------------- CONOCIDO ---------------------------*/
        
        #conocidoButton {
            background: rgb(26, 26, 26);
            border: 2px solid #cc0066;
            color: rgb(116, 116, 116);
            box-shadow: 5px 5px #8b0046;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        /* Estilo cuando el botón está activo (durante el clic) */
        #conocidoButton:active, #conocidoButton.active {
            background: rgb(0, 0, 0);
            color: white;
            border: 2px solid #ff69b4;
            box-shadow: 0 0 10px #ff69b4, 0 0 20px #ff69b4;
            transform: translate(3px, 3px);
        }

        /*-------------- Estilo para el botón 3D de CUADRANTE ------------------------------------*/
        #emergencyCuadranteButtonContainer {
            display: none; 
            position: relative;
            top: 110px;
            width: 200px;
            height: 200px;
            perspective: 1000px;
            margin: 40px;
            margin-bottom: 60px;
            filter: drop-shadow(0 0 15px rgba(0, 110, 255, 0.7));
            z-index: 1000;
        }
        

        #emergenciaCuadranteButton3D {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        #emergenciaCuadranteButton3D:active {
            transform: translateZ(-30px) scale(0.9);
            animation: none;
        }

        .buttonCuadrante-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            backface-visibility: hidden;
            transition: all 0.3s;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.7);
            text-align: center;
            line-height: 1.2;
        }

        .buttonCuadrante-front {
            background: radial-gradient(circle at center, #0077ff, #003399);
            transform: translateZ(30px);
            animation: pulse-glow-blue 1.5s infinite alternate, pulse-scale 2s infinite ease-in-out;
        }

        .buttonCuadrante-back {
            background: radial-gradient(circle at center, #0055cc, #003399);
            transform: rotateY(180deg) translateZ(30px);
        }

        .buttonCuadrante-side {
            background: linear-gradient(to bottom, #0077ff, #0055cc);
            transform: rotateY(90deg) translateZ(100px);
            width: 40px;
            height: 100%;
            left: calc(50% - 20px);
        }

        .buttonCuadrante-top {
            background: linear-gradient(to right, #66aaff, #0077ff);
            transform: rotateX(90deg) translateZ(100px);
            height: 40px;
            width: 100%;
            top: calc(50% - 20px);
        }

        @keyframes pulse-scale {
            0%, 100% {
                transform: translateZ(30px) scale(1);
            }
            50% {
                transform: translateZ(30px) scale(1.05);
            }
        }

        /* Animaciones de glow específicas para cada color */
        @keyframes pulse-glow-blue {
            0% {
                box-shadow: 0 0 10px #0066ff, 0 0 20px #0066ff, 0 0 30px #0066ff;
            }
            100% {
                box-shadow: 0 0 20px #0066ff, 0 0 40px #0066ff, 0 0 60px #0066ff;
            }
        }

        #emergenciaCuadranteButton3D:active::after {
            opacity: 1;
            animation: sparkle 0.5s forwards;
        }

        @keyframes sparkle {
            0% {
                transform: scale(0.5);
                opacity: 1;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        /*------------------- Estilo para el botón 3D de EXTORSIÓN -------------------------------*/
        #emergencyExtorsionButtonContainer {
            display: none; 
            position: relative;
            top: 110px;
            width: 200px;
            height: 200px;
            perspective: 1000px;
            margin: 40px;
            margin-bottom: 60px;
            filter: drop-shadow(0 0 15px rgba(255, 165, 0, 0.7));
            z-index: 1000;
        }

        #emergenciaExtorsionButton3D {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        #emergenciaExtorsionButton3D:active {
            transform: translateZ(-30px) scale(0.9);
            animation: none;
        }

        .buttonExtorsion-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            backface-visibility: hidden;
            transition: all 0.3s;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.7);
            text-align: center;
            line-height: 1.2;
        }

        .buttonExtorsion-front {
            background: radial-gradient(circle at center, #ffaa00, #cc5500);
            transform: translateZ(30px);
            animation: pulse-glow-yellow 1.5s infinite alternate, pulse-scale 2s infinite ease-in-out;
        }

        .buttonExtorsion-back {
            background: radial-gradient(circle at center, #ff7700, #cc5500);
            transform: rotateY(180deg) translateZ(30px);
        }

        .buttonExtorsion-side {
            background: linear-gradient(to bottom, #ffaa00, #ff7700);
            transform: rotateY(90deg) translateZ(100px);
            width: 40px;
            height: 100%;
            left: calc(50% - 20px);
        }

        .buttonEXtorsion-top {
            background: linear-gradient(to right, #ffcc66, #ffaa00);
            transform: rotateX(90deg) translateZ(100px);
            height: 40px;
            width: 100%;
            top: calc(50% - 20px);
        }

        @keyframes pulse-scale {
            0%, 100% {
                transform: translateZ(30px) scale(1);
            }
            50% {
                transform: translateZ(30px) scale(1.05);
            }
        }

        @keyframes pulse-glow-yellow {
            0% {
                box-shadow: 0 0 10px #ffaa00, 0 0 20px #ffaa00, 0 0 30px #ffaa00;
            }
            100% {
                box-shadow: 0 0 20px #ffaa00, 0 0 40px #ffaa00, 0 0 60px #ffaa00;
            }
        }

        #emergenciaExtorsionButton3D:active::after {
            opacity: 1;
            animation: sparkle 0.5s forwards;
        }

        @keyframes sparkle {
            0% {
                transform: scale(0.5);
                opacity: 1;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        /*----------- Estilo para el botón 3D de "CONOCIDO" ----------------------------------*/
        #emergencyConocidoButtonContainer {
            display: none; 
            position: relative;
            top: 110px;
            width: 200px;
            height: 200px;
            perspective: 1000px;
            margin: 40px;
            margin-bottom: 60px;
            filter: drop-shadow(0 0 15px rgba(255, 105, 180, 0.7));
            z-index: 1000;
        }

        #emergenciaConocidoButton3D {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: all 0.3s ease;
            cursor: pointer;
            }

        #emergenciaConocidoButton3D:active {
            transform: translateZ(-30px) scale(0.9);
            animation: none;
        }

        .buttonConocido-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            backface-visibility: hidden;
            transition: all 0.3s;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.7);
            text-align: center;
            line-height: 1.2;
        }

        .buttonConocido-front {
            background: radial-gradient(circle at center, #ff69b4, #cc0066);
            transform: translateZ(30px);
            animation: pulse-glow-pink 1.5s infinite alternate, pulse-scale 2s infinite ease-in-out;
        }

        .buttonConocido-back {
            background: radial-gradient(circle at center, #ff1493, #cc0066);
            transform: rotateY(180deg) translateZ(30px);
        }

        .buttonConocido-side {
            background: linear-gradient(to bottom, #ff69b4, #ff1493);
            transform: rotateY(90deg) translateZ(100px);
            width: 40px;
            height: 100%;
            left: calc(50% - 20px);
        }

        .buttonConocido-top {
            background: linear-gradient(to right, #ff99cc, #ff69b4);
            transform: rotateX(90deg) translateZ(100px);
            height: 40px;
            width: 100%;
            top: calc(50% - 20px);
        }

        @keyframes pulse-scale {
            0%, 100% {
                transform: translateZ(30px) scale(1);
            }
            50% {
                transform: translateZ(30px) scale(1.05);
            }
        }

        @keyframes pulse-glow-pink {
            0% {
                box-shadow: 0 0 10px #ff69b4, 0 0 20px #ff69b4, 0 0 30px #ff69b4;
            }
            100% {
                box-shadow: 0 0 20px #ff69b4, 0 0 40px #ff69b4, 0 0 60px #ff69b4;
            }
        }

        #emergenciaConocidoButton3D:active::after {
            opacity: 1;
            animation: sparkle 0.5s forwards;
        }

        @keyframes sparkle {
            0% {
                transform: scale(0.5);
                opacity: 1;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        /*---- Oculte los botones URL, GIRO Y NOMBRE porque ya estan en el menu ------------------------*/
        /*#modifyTelCuadranteButton, #modifyTelExtorsionButton, #modifyTelConocidoButton {
            background-color: #000000;
            color: #7c7c7c;
            text-transform: uppercase;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 14px;
            width: 100px;
            height: 40px;
            border: 2px solid rgb(65, 61, 61);
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
            box-sizing: border-box;
            position: absolute;
            bottom: 20px;
            left: 350px; /* Ajusta la posición según sea necesario */
           /* margin: 0 0;
        } */

       /* #modifyTelExtorsionButton {
            left: 460px; /* Ajusta la posición según sea necesario */
        /*}*/

        /*#modifyTelConocidoButton {
            left: 570px; /* Ajusta la posición según sea necesario */
        /*} */

        /*#modifyTelCuadranteButton:active, #modifyTelExtorsionButton:active, #modifyTelConocidoButton:active {
            box-shadow: none;
            transform: translate(3px, 3px);
        }*/

        /*#modifyTelCuadranteButton:active, #modifyTelCuadranteButton.active, #modifyTelExtorsionButton:active, #modifyTelExtorsionButton.active, #modifyTelConocidoButton:active, #modifyTelConocidoButton.active {
            background-color: #1e90ff;
            border-color: #00bfff;
            transform: scale(0.95);
        }*/

        /*-------------------- Estilos para el INPUT de CUADRANTE -------------------*/
        .custom-tel-cuadrante-input {
            display: none;
            position: fixed;
            width: 250px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #00000050;
            border: 1px solid #1e90ff;
            padding: 20px;
            box-shadow: 0 0 20px #00bfff;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            border-radius: 10px;
            z-index: 1010;
        }

        .custom-tel-cuadrante-input input {
            width: 90%;
            padding: 10px;
            margin-bottom:7px;
            font-size: 16px;
            background: #bdefff;
            color: #000000;
            border: 1px solid #00bfff;
            box-shadow: 0 0 5px #00bfff;
            border-radius: 5px;
        }


        .custom-tel-cuadrante-input input:hover {
            background: #000000;
            border: 0.5px solid #00bfff;
            color: #00bfff;
        }

        .custom-tel-extorsion-input input:focus {
            background: #000000;
            border: .5px solid #00bfff;
            color: #00bfff;
        }


        .custom-tel-cuadrante-input .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .custom-tel-cuadrante-input .button-container button {
            background-color: #000000;
            color: white;
            border: 1px solid #00bfff;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
        }

        .custom-tel-cuadrante-input .button-container button:hover {
            background-color: #000000;
            border: 2px solid #00bfff;
            box-shadow: 0 0 10px #1e90ff;
        }

        /*-------------- Estilos para el INPUT de EXTORSIÓN ---------------*/
        .custom-tel-extorsion-input {
            display: none;
            position: fixed;
            width: 250px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #00000050;
            border: 1px solid #d4a017;
            padding: 20px;
            box-shadow: 0 0 20px #e8a317;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            border-radius: 10px;
            z-index: 1010;
        }

        .custom-tel-extorsion-input input {
            width: 90%;
            padding: 10px;
            margin-bottom:7px;
            font-size: 16px;
            background: #ffefd0;
            color: #000000;
            border: 1px solid #f5b104;
            box-shadow: 0 0 5px #e8a317;
            border-radius: 5px;
        }

        .custom-tel-extorsion-input input:hover {
            background: #000000;
            border: 0.5px solid #f7b100;
            color: #f5b104;
        }

        .custom-tel-extorsion-input input:focus {
            background: #000000;
            border: .5px solid #f7b100;
            color: #f5b104;
        }

        .custom-tel-extorsion-input .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .custom-tel-extorsion-input .button-container button {
            background-color: #000000;
            color: white;
            border: 1px solid #d4a017;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
        }

        .custom-tel-extorsion-input .button-container button:hover {
            background-color: #000000;
            border: 2px solid #d4a017;
            box-shadow: 0 0 10px #d4a017;
        }

        /*---------------- Estilos para INPUT de CONOCIDO -------------------*/
        .custom-tel-conocido-input {
            display: none;
            position: fixed;
            width: 250px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #00000050;
            border: 1px solid #ff69b4;
            padding: 20px;
            box-shadow: 0 0 20px #ff69b4;
            text-align: center;
            border-radius: 10px;
            z-index: 1010;
        }

        .custom-tel-conocido-input input {
            width: 90%;
            padding: 10px;
            margin-bottom:7px;
            font-size: 16px;
            background: #ecb0ce;
            color: #000000;
            border: 1px solid #ff69b4;
            box-shadow: 0 0 5px #ff69b4;
            border-radius: 5px;
        }

        .custom-tel-conocido-input input:hover {
            background: #000000;
            border: 0.5px solid #ff69b4;
            color: #ff69b4;
        }

        .custom-tel-conocido-input input:focus {
            background: #000000;
            border: 0.5px solid #ff69b4;
            color: #ff69b4;
        }

        .custom-tel-conocido-input .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .custom-tel-conocido-input .button-container button {
            background-color: #000000;
            color: white;
            border: 1px solid #ff69b4;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
        }

        .custom-tel-conocido-input .button-container button:hover {
            background-color: #000000;
            border: 2px solid #ff69b4;
            box-shadow: 0 0 10px #ff69b4;
        }

        /*------------------ Estilos para el MENÚ DE HAMBURGUESA ------------------------*/
        .hamburger-menu {
            position: fixed;
            top: 180px; /* Cambiado de bottom a top */
            left: 10px; /* Para posicionar a la izquierda */
            z-index: 1001;
        }

        .hamburger-icon {
            background-color: #ffffff70;
            color: #000000;
            border-radius: 50%;
            width:35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size:29px;
            cursor: pointer;
            line-height: 1;
            transition: all 0.3s;
            padding: 0;
            border: 1px solid #939393;
        }

        .hamburger-icon:hover {
            background-color: #00ffff;
            color: #000000;
            border: 1px solid #000000;
            transform: scale(1.1);
            box-shadow: 0 0 15px #00ffff, 0 0 30px #00ffff;
        }

        .menu-options {
            top: 20px; /* Cambiado de bottom a top */
            left: 60px; /* Para posicionar a la izquierda */
            display: none;
            position: absolute;
            right: 0;
            background-color: #000000bb;
            border: 1px solid #00ffff;
            border-radius: 10px;
            padding: 10px;
            width: 150px;
            box-shadow: 0 0 10px #00ffff;
            z-index: 1000; /* Asegurar que esté por encima del overlay */
        }

        .menu-item {
            color: #00ffff;
            padding: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .menu-item:hover {
            background-color: #000000;
            border: 2px solid #008787;
            color: #00ffff;
            border-radius: 5px;
            box-shadow: 0 0 10px #00ffff;
        }

        /* Estilos para el overlay del menú */
        .menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Fondo opaco */
            z-index: 1001;
        }

        /* Para ajustar la posición del Texto y contenedor */
        
        /* Ajusta el contenedor de registros para que no incluya el título */
        
        .registros-container {
            position: fixed;
            bottom: 18%; /* Cambiado de bottom: 05px */
            left: 50%;
            transform: translate(-50%, 50%); /* Centra horizontal y verticalmente */
            background-color: rgba(0, 0, 0, 0.9);
            border: 2px solid #00ffff;
            border-radius: 15px;
            padding: 10px;
            height: 250px;
            width: 300px;
            color: #ffffff;
            max-height: 300px;
            overflow-y: auto;
            box-shadow: 0 0 5px #00ffff, 0 0 15px rgba(0, 255, 255, 0.5);
            z-index: 1020;
        }

        /* Estilos para el título de registros - centrado */
        #registrosTitulo {
            position: fixed;
            bottom: calc(35%); /* Ajusta esta posición para que esté arriba del contenedor */
            left: 50%;
            transform: translateX(-50%); /* Centra horizontalmente */
            background-color: rgba(0, 0, 0, 0.9);
            border: 2px solid #00ffff;
            border-radius: 15px;
            padding: 10px;
            color: #ffffff;
            width: 300px;
            box-shadow: 0 0 5px #00ffff, 0 0 15px rgba(0, 255, 255, 0.5);
            z-index: 1020;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.3rem;
            text-align: center; /* Asegura que el texto esté centrado */
        }

        .close-button {
            background-color: #ff0000;
            color: #ffffff;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            margin-left: 10px; /* Espacio entre el título y el botón */
        }

        .close-button:hover {
            background-color: #cc0000;
        }

        #listaRegistros {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        #listaRegistros li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 255, 255, 0.3);
            transition: all 0.3s;
        }

        #listaRegistros li:hover {
            background-color: rgba(0, 255, 255, 0.1);
            transform: translateX(5px);
        }

        #listaRegistros li:last-child {
            border-bottom: none;
        }

        /* Estilo para el overlay de REGISTROS DE ACTIVACIÓN*/
        .registros-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            z-index: 1020;
        }

        /* Estilo ICONO para el BOTÓN REGISTRO */
        #toggleRegistrosButton {
            position: fixed;
            display: flex;
            top: 130px; /* Cambiado de bottom a top */
            left: 10px; /* Para posicionar a la izquierda */
            border-radius: 50%;
            border: 1px solid #7b7b7b;
            background-color: #ffffff70;
            color: #000000;
            width: 35px;
            height: 35px;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: none;
            font-size: 30px;
            line-height: 1;
            padding: 0;
            z-index: 1000;
        }

        #toggleRegistrosButton:hover {
            background-color: #000000;
            color: #ffffff;
            transform: scale(1.1);
            box-shadow: 0 0 15px #000000, 0 0 30px #000000;
        }
        
        #toggleRegistrosButton:active, #toggleRegistrosButton.active {
            background-color: #000000;
            border-color: #ffffff;
            transform: scale(0.95);
        }

        .emergencia-negocio {
            color: rgb(211, 0, 0);
        }

        .emergencia-extorsion {
            color: #daa520;
        }

        .emergencia-cuadrante {
            color: #00aaff;
        }

        .emergencia-conocido {
            color: #ff69b4;
        }

        /*------------- Estilos para las   G R Á F I C A S -------------------------------*/
        
        /* En este contenedor estan todas las graficas y el contador de totales*/
        .graficas-container {
            display: none;
            position: fixed;
            top: 23%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 15px;
            padding: 20px;
            width: 90%;
            max-width: 600px;
            /*backdrop-filter: blur(5px);*/
            /*background: rgba(4, 131, 32, 0.85);
            text-align: center;
            /*border: 1px solid #00ffff;*/
            /*box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);*/
            z-index: 1020;
        }

        .graficas-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            justify-items: center;
            align-items: center;
            margin-top: 20px;
        }

        .dona-wrapper {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        /* Las 4 donas*/
        .dona-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 10px 0;
            /*background: #00009b; */
        }

        .dona-wrapper:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 0 15px currentColor);
        }

        .dona-wrapper.active {
            border: 2px solid currentColor;
            border-radius: 50%;
            box-shadow: 0 0 20px currentColor;
        }

        .dona-percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            /*color: white;*/
            font-size: 1.8rem;
            text-shadow: 0 0 0 currentColor;
            /*transition: all 0.3s ease;*/
            pointer-events: none;
        }

        .dona-count {
            position: absolute;
            top: 70%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1rem;
            font-weight: bold;
            text-shadow: 0 0 0 currentColor;
            opacity: 0;
            /*transition: opacity 0.3s ease;*/
            pointer-events: none;
        }

        /* Efectos neon mejorados */
        .neon-yellow {
            color: #ff0000;
            text-shadow: 0 0 5px #ff0000, 0 0 15px #ff0000;
        }

        .neon-blue {
            color: #00bfff;
            text-shadow: 0 0 5px #00bfff, 0 0 15px #00bfff;
        }

        .neon-pink {
            color: #daa520;
            text-shadow: 0 0 5px #daa520, 0 0 15px #daa520;
        }

        .neon-rose {
            color: #ff69b4;
            text-shadow: 0 0 5px #ff69b4, 0 0 15px #ff69b4;
        }

        .graficas-title {
            color: #00ffff;
            text-align: center;
            font-size: 1.8rem;
            text-shadow: 0 0 10px #00ffff;
            margin: 0 0 20px 0;
            flex-grow: 1;
            animation: neon-pulse 2s infinite alternate;
        }

        .graficas-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            justify-items: center;
        }

        @keyframes neon-pulse {
            from {
                text-shadow: 0 0 5px #00ffff, 0 0 10px #00ffff;
            }
            to {
                text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff, 0 0 30px #00ffff;
            }
        }

        /* Estilo mejorado para el NÚMERO DE ACTIVACIONES */
        .graficas-total {
            position: relative; /* Cambiado de flex a relative */
            margin: 5% auto; /* Centrado horizontal con auto */
            color: #00ffff;
            border: 2px solid #00ffff;
            border-radius: 15px;
            width: 300px;
            height: 30px;
            font-weight: bold;
            font-size: 1.5rem;
            display: block; /* Cambiado de inline-block a block */
            padding: 10px;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.3);
            box-shadow: 0 0 10px #00ffff;
        }

        /*Esto alinea verticalmente el contenedor al CONTADOR DE ACTIVACIONES .graficas-total*/
        .graficas-header {
            display: flex;
            margin-top: 40px;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            /*background: red; */
        }

        /*------- Estilos para el TOOLTIP (el cuadrdo al pulsar la gráfica) de emergencia -----*/
        .emergency-tooltip {
            display: none;
            font-size: 14px;
            line-height: 1.4;
            pointer-events: none;
        }

        /*------------------------ Efecto de HUMO BLANCO -------------------------*/
        .smoke-letter {
            display: inline-block;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            color: inherit;
            will-change: transform, opacity, filter;
            white-space: normal; /* Asegura que el espacio en blanco se maneje normalmente */
            word-wrap: normal; /* Mantiene las palabras juntas */
            word-break: keep-all; /* Evita dividir palabras */
        }
        
        @keyframes white-smoke {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1) rotate(0deg);
                filter: blur(0);
                text-shadow: 0 0 0 rgba(255, 255, 255, 0);
            }
            50% {
                opacity: 0.8;
                transform: translateY(-10px) scale(1.2) rotate(5deg);
                text-shadow: 
                    0 0 10px rgba(255, 255, 255, 0.8),
                    0 0 20px rgba(255, 255, 255, 0.6);
            }
            100% {
                opacity: 0;
                transform: translateY(-30px) scale(1.5) rotate(10deg);
                filter: blur(3px);
                text-shadow: 
                    0 0 20px rgba(255, 255, 255, 0.9),
                    0 0 40px rgba(255, 255, 255, 0.7),
                    0 0 60px rgba(255, 255, 255, 0.5);
            }
        }
        
        .smoke-letter.fade-out {
            animation: white-smoke 1.5s ease-out forwards;
            pointer-events: none;
        }
        
        .space {
            display: inline-block;
            width: 0.3em;
        }
        
        /* Asegurar que los textos sean visibles (efecto humo) */
        .title_1, .title_2, .giroNegocio, .nombreNegocio {
            color: white;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        /*------ Botón BORRAR y botón CHECK (paloma) del imput giroNegocio --------*/
        .check-icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: #4CAF50;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 20px;
            margin-left: 5px;
        }
        
        #giroSubmitButton.saved {
            background-color: #4CAF50;
            border-color: #4CAF50;
        }
        
        #giroCancelButton.delete {
            background-color: #f44336;
            border-color: #f44336;
        }

        /*------------ Contador de 16 caracteres para giro y nombre ---------------*/
        .char-counter {
            color: #666;
            font-size: 12px;
            text-align: right;
            width: 90%;
            margin-top: -30px;
            margin-bottom: 10px;
        }
        
        /*------------- Estilos para CONSEJO del Botón C5 -----------*/
        .custom-alert-c5 {
        display: none;
        position: fixed;
        width: 100%; /* Cambiado de 300px a 100% */
        height: 100%; /* Cambiado de auto a 100% */
        top: 0;
        left: 0;
        transform: none; /* Eliminado translate */
        background-color: #000000;
        border: none; /* Eliminado el borde */
        padding: 0; /* Eliminado el padding */
        box-shadow: none; /* Eliminado la sombra */
        text-align: center;
        font-size: 17.5px;
        line-height: 1.5;
        border-radius: 0; /* Eliminado el border-radius */
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1030; /* Aumentado el z-index para estar sobre todo */
    }

    /* Estilos para el video a pantalla completa */
    .custom-alert-c5 video {
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
        object-fit: contain; /* Mantiene la relación de aspecto */
        background-color: #000;
    }

    /* Estilos para el botón en pantalla completa */
    .custom-alert-c5 button {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #ff3838;
        color: #000000;
        border: none;
        padding: 15px 30px; /* Aumentado el padding */
        border-radius: 15px;
        font-size: 18px; /* Aumentado el tamaño de fuente */
        cursor: pointer;
        transition: all 0.3s;
        z-index: 1031; /* Para que esté sobre el video */
    }

    .custom-alert-c5 button:hover {
        background-color: #fb5959;
        box-shadow: 0 0 15px #ff0000;
    }

    /* Ocultar el overlay cuando el video está en pantalla completa */
    .custom-alert-c5 ~ .overlay {
        display: none !important;
    }
    
        /*--------- Consejos en Casos de Extorsión ------------------*/
        .custom-alert-extorsion {
            display: none;
            position: fixed;
            width: 300px;
            height: auto;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #daa520;
            padding: 20px;
            box-shadow: 0 0 20px #daa520;
            text-align:left;
            font-size: 17.5px;
            line-height: 1.5;
            border-radius: 10px;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1015;
        }

        .custom-alert-extorsion p {
            margin: 0 0 20px;
            color: #ffffff;
        }

        .custom-alert-extorsion p strong {
            font-size: 1.4rem; /* Tamaño aún más grande para el título */
            display: block; /* Hacer que el título esté en su propia línea */
            margin-bottom: 10px; /* Espacio después del título */
            color: red;
            text-transform:uppercase;
            text-align: center;
        }

        .custom-alert-extorsion button {
            background-color: #daa520;
            color: #000000;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .custom-alert-extorsion button:hover {
            background-color: #ffd700;
            box-shadow: 0 0 10px #ffd700;
        }

        /*------------ Estilos para CONSEJO de la alerta Cuadrante -------------*/
        .custom-alert-cuadrante {
            display: none;
            position: fixed;
            width: 300px;
            height: auto;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #1e90ff;
            padding: 20px;
            box-shadow: 0 0 20px #00bfff;
            text-align: center;
            font-size: 17.5px;
            line-height: 1.5;
            border-radius: 10px;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1015;
        }

        .custom-alert-cuadrante p {
            margin: 0 0 20px;
            color: #ffffff;
        }

        .custom-alert-cuadrante button {
            background-color: #1e90ff;
            color: #000000;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .custom-alert-cuadrante button:hover {
            background-color: #00bfff;
            box-shadow: 0 0 10px #00bfff;
        }


        /*---------- Estilos para CONSEJO de la alerta de Conocido -------------------*/
        .custom-alert-conocido {
            display: none;
            position: fixed;
            width: 300px;
            height: auto;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #ff0080;
            padding: 20px;
            box-shadow: 0 0 20px #ff69b4;
            text-align: center;
            font-size: 17.5px;
            line-height: 1.5;
            border-radius: 10px;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1015;
        }

        .custom-alert-conocido p {
            margin: 0 0 20px;
            color: #ffffff;
        }

        .custom-alert-conocido button {
            background-color: #ff3c9d;
            color: #000000;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .custom-alert-conocido button:hover {
            background-color: #fd60ae;
            box-shadow: 0 0 10px #ff69b4;
        }

        /*---------------- Estilos para el FORMULARIO DE UBICACIÓN -------------------------*/
        #ubicacionFormContainer {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #00000050;
            border: 1px solid #00ffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
            z-index: 1020;
            width: 300px;
            max-width: 90%;
        }

        #ubicacionForm {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #ubicacionForm input {
            padding: 10px;
            background-color: #222;
            border: 1px solid #00ffff;
            color: #fff;
            border-radius: 5px;
        }

        #ubicacionForm .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        #ubicacionForm button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        #guardarUbicacion {
            background-color: #00bfff;
            color: #000;
        }

        #guardarUbicacion:hover {
            background-color: #0080ff;
        }

        #cancelarUbicacion {
            background-color: #ff5555;
            color: #000;
        }

        #cancelarUbicacion:hover {
            background-color: #ff0000;
        }

        /*---------------- Estilo para el POPUP DEL MARCADOR -----------------------*/
        .leaflet-popup-content {
            font-family: Arial, sans-serif;
            color: #333;
            text-align: center;
            text-transform: uppercase;
            width: 100px;  /* Cambiado de 30% a auto */
            height: auto;
            padding: 0;
            font-size: 14px;
            line-height: 1.4;
            min-width: 200px;
        }

        .leaflet-popup-content-wrapper {
            border-radius: 5px;
            box-shadow: 0 0 10px #00FFFF;
            background-color: #ffffff;
            border: 1px solid #00FFFF;
            position: relative;
            transition: transform 0.1s;
        }

        .leaflet-popup-tip {
            background-color: #00ffff;
        }

        /* Clase para aplicar la vibración */
        .vibrating-popup {
            animation: vibrate 0.5s ease-in-out;
            position: relative; /* Importante para que la animación funcione */
        }
        /* Animación de vibración */
        @keyframes vibrate {
            0% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }
              
        /*-------------- Estilos para el marcador personalizado ----------------*/
        .ubicacion-marker {
            background-color: #4285F4;
            border-radius: 50%;
            border: 2px solid white;
            width: 22px !important;
            height: 22px !important;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .ubicacion-marker::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid #4285F4;
        }

        /* Estilo para el overlay de coordenadas generadas */
        .coordenadas-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1030;
            justify-content: center;
            align-items: center;
        }

        .coordenadas-message {
            display: none;
            position: fixed;
            width: 300px;
            height: auto;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #00ffff;
            padding: 20px;
            border-radius: 10px;
            color: #ffffff;
            text-align: center;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1031;
        }

        .coordenadas-message p {
            margin: 0;
            padding: 0;
            line-height: 1.5;
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Estilo para el overlay de coordenadas generadas */
        .coordenadas-overlay_2 {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1015;
            justify-content: center;
            align-items: center;
        }

        .coordenadas-message_2 {
            background-color: #000000;
            border: 1px solid #00ffff;
            padding: 20px;
            border-radius: 10px;
            color: #ffffff;
            text-align: center;
            max-width: 80%;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        /* Loader moderno */
        .loader_2 {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin_2 1s linear infinite;
            margin: 10px auto;
        }

        @keyframes spin_2 {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }






        /*----MESSAGE_3 ----------------------------------------*/
        .coordenadas-message_3 {
            display: none;
            position: fixed;
            width: 300px;
            height: auto;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #daa520;
            padding: 20px;
            box-shadow: 0 0 20px #daa520;
            text-align:left;
            font-size: 17.5px;
            line-height: 1.5;
            border-radius: 10px;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1031;
        }

        .coordenadas-message_3 p {
            margin: 0 0 20px;
            color: #ffffff;
        }

        .coordenadas-message_3 p strong {
            font-size: 1.4rem; /* Tamaño aún más grande para el título */
            display: block; /* Hacer que el título esté en su propia línea */
            margin-bottom: 10px; /* Espacio después del título */
            color: red;
            text-transform:uppercase;
            text-align: center;
        }

        .coordenadas-message_3 button {
            background-color: #daa520;
            color: #000000;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .coordenadas-message_3 button:hover {
            background-color: #ffd700;
            box-shadow: 0 0 10px #ffd700;
        }








        /*--------------- Estilo para el marcador arrastrable ------------------------*/
        .ubicacion-marker {
            cursor: move; /* Cambia el cursor a "move" cuando está sobre el marcador */
            transition: transform 0.2s ease;
        }

        .ubicacion-marker.dragging {
            transform: scale(1.2); /* Efecto visual cuando se está arrastrando */
            filter: drop-shadow(0 0 5px rgba(255, 0, 0, 0.7));
        }

        /*----------- Estilos para la CUENTA REGRESIVA ---------------------*/
       
        .countdown-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            color: white;
        }

        .countdown-message {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .countdown-number {
            font-size: 5rem;
            font-weight: bold;
            color: #ff0000;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.7);
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .countdown-cancel-btn {
            background-color: #ff0000;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 30px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
        }

        .countdown-cancel-btn:hover {
            background-color: #cc0000;
            transform: scale(1.05);
        }

        .countdown-number.envio {
            color: #00ff00;
            text-shadow: 0 0 10px #00ff00;
            transform: scale(1.2);
            font-size: 3rem;
        }

        /*-------- BARRA DE PROGRESO de la cuenta regresiva ----------------*/

        .countdown-progress-container {
            width: 80%;
            height: 10px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
        }

        .countdown-progress-bar {
            position: absolute;
            height: 100%;
            width: 0;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(to right, #ff0000, #ff5252);
            border-radius: 5px;
            transition: width 1s linear;
        }

        /*------- BOTONES DE AYUDA ( H E L P ) que aparecen debajo de los Tipos de Botones -------------*/

        .button-with-help {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 5px;
        }

        .help-container {
            position: relative;
            width: 100%;
            display: flex;
            justify-content: center;
            margin-top: 15px; /* Espacio entre los Botones Emergencia y Help */
            z-index: 1000;
        }

        /* Estilos para los botones de ayuda (HELP) */
        .help-icon {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            position: relative;
        }

        /* Estilo específico para el botón de ayuda de C5 */
        #c5Help {
            background-color: #3a3a3abb;
            color: #ff0000;
            border: 1px solid #ff0000;
            box-shadow: 0 0 5px #c50000;
        }

        #c5Help:hover {
            background-color: #960000;
            color: white;
            box-shadow: 0 0 10px #ff0000;
        }

        /* Estilo específico para el botón de ayuda de Cuadrante */
        #cuadranteHelp {
            background-color: #3a3a3abb;
            color: #00b7ff;
            border: 1px solid #00b7ff;
            box-shadow: 0 0 5px #007a99;
        }

        #cuadranteHelp:hover {
            background-color: #003399;
            color: white;
            box-shadow: 0 0 10px #0084ff;
        }

        /* Estilo específico para el botón de ayuda de Extorsión */
        #extorsionHelp {
            background-color: #3a3a3abb; 
            color: #ffa420;
            border: 1px solid #ffa420;
            box-shadow: 0 0 5px #cc5500;
        }

        #extorsionHelp:hover {
            background-color: #cc5500;
            color: white;
            box-shadow: 0 0 10px #ffaa00;
        }

        /* Estilo específico para el botón de ayuda de Conocido */
        #conocidoHelp {
            background-color: #3a3a3abb;
            color: #ff0080;
            border: 1px solid #ff0080;
            box-shadow: 0 0 5px #cc0066;
        }

        #conocidoHelp:hover {
            background-color: #cc0066;
            color: white;
            box-shadow: 0 0 10px #ff69b4;
        }

        /* Animación de pulso para todos los botones de ayuda */
        .help-icon {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }


        /* Estilo para el botón de CENTRAR MAPA - Checar si se ocupan estos estilos ya que los esta tomando directamente en el java script */
       
        #center-map-button {
            position: fixed;
            bottom: 200px;
            left: 10px;
            z-index: 1000;
            background-color: rgba(255, 255, 255, 0.7);
            color: rgb(0, 0, 0);
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            font-size: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
            transition: all 0.3s ease;
        }

        #center-map-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
                
        /*------ Estilo personalizado para el CONTROL DE ZOOM ----------------------*/
        .leaflet-control-zoom {
            margin-top: 450px !important;
            margin-left: 10px !important;
        }

        /*----- Estilo para la advertencia de modificación de URL ---------------*/
        .custom-warning {
            display: none;
            position: fixed;
            width: 300px;
            height: auto;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #00bfff;
            padding: 20px;
            box-shadow: 0 0 20px #00bfff;
            text-align: center;
            font-size: 18px;
            border-radius: 10px;
            z-index: 1030;
        }

        .custom-warning p {
            margin: 0 0 20px;
            color: #ffffff;
        }

        .custom-warning .button-container {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .custom-warning button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        #warningModify {
            background-color: #00bfff;
            color: #000;
            box-shadow: 0 0 10px #00bfff;
        }

        #warningModify:hover {
            background-color: #0088cc;
            box-shadow: 0 0 15px #00bfff;
        }

        #warningCancel {
            background-color: #ff5555;
            color: #000;
            box-shadow: 0 0 10px #ff5555;
        }

        #warningCancel:hover {
            background-color: #cc0000;
            box-shadow: 0 0 15px #ff5555;
        }


        /* Otro efecto del PopUp*/
        .leaflet-popup-content-wrapper {
            transition: opacity 0.5s ease;
        }

        .leaflet-popup.fade-out {
            opacity: 0;
        }

    </style>
    
</head>
<body>

        <!-- Contenedor del mapa MODO OBSCURO -->
        <div id="map-container" class="dark-mode">
            <div id="map"></div>
        </div>

            <!-- Botón para cambiar el tema -->
            <button id="theme-toggle" title="Cambiar modo día/noche">🌙</button>


            <!-- Mensaje inicial cuando abres la app -->
            <div id="initialMessageContainer">
                <!-- Contenido del mensaje inicial -->
                <div id="initialMessageContent">
                    <hr class="codigos">EMERGENCIA<br>k8
                </div>
            </div>

            <!-- Resto del contenido de la página -->
            <div id="overlay" class="overlay"></div>

            <!-- Overlay para el menú -->
            <div id="menuOverlay" class="menu-overlay"></div>

            <!-- Overlay para los registros de activación -->
            <div id="registrosOverlay" class="registros-overlay"></div>


            <header>
                <hr class="codigos">
                <h1 class="title_1">EMERGENCIA k8</h1>
            </header>

            
            <div>
                <!--<h1 class="title_1">EMERGENCIA k8</h1>-->
                <h1 class="title_2">.</h1>
            </div>

            <div>

                <h1 id="giroNegocioText" class="giroNegocio">GIRO DEL NEGOCIO</h1>
                <h1 id="nombreNegocioText" class="nombreNegocio">"NOMBRE"</h1>

            </div>

            <!-- Contenedor del botón de emergencia 3D -->
            <div id="emergencyButtonContainer">
                <div id="emergencyButton3D">
                    <div class="button-face button-front">NEGOCIO</div>
                    <div class="button-face button-back">EMERGENCIA</div>
                    <div class="button-face button-side"></div>
                    <div class="button-face button-side" style="transform: rotateY(-90deg) translateZ(100px);"></div>
                    <div class="button-face button-top"></div>
                    <div class="button-face button-top" style="transform: rotateX(-90deg) translateZ(100px);"></div>
                </div>
            </div>
            
            <!-- Nuevo botón EmergenciaCuadrante (inicialmente oculto) -->
            <!-- <button id="emergenciaCuadranteButton" class="custom-button">Cuadrante<br>Negocio</button> -->

            <!-- Contenedor del botón de emergencia 3D para Cuadrante -->
            <div id="emergencyCuadranteButtonContainer">
                <div id="emergenciaCuadranteButton3D">
                    <div class="buttonCuadrante-face buttonCuadrante-front">CUADRANTE<br>NEGOCIO</div>
                    <div class="buttonCuadrante-face buttonCuadrante-back">EMERGENCIA</div>
                    <div class="buttonCuadrante-face buttonCuadrante-side"></div>
                    <div class="buttonCuadrante-face buttonCuadrante-side" style="transform: rotateY(-90deg) translateZ(100px);"></div>
                    <div class="buttonCuadrante-face buttonCuadrante-top"></div>
                    <div class="buttonCuadrante-face buttonCuadrante-top" style="transform: rotateX(-90deg) translateZ(100px);"></div>
                </div>
            </div>

            <!-- Nuevo botón EmergenciaExtorsion (inicialmente oculto) -->
            <!-- <button id="emergenciaExtorsionButton" class="custom-button">Denunciar<br>Extorsión</button>-->
            
            <!-- Contenedor del botón de emergencia 3D para Extorsión -->
            <div id="emergencyExtorsionButtonContainer">
                <div id="emergenciaExtorsionButton3D">
                    <div class="buttonExtorsion-face buttonExtorsion-front">DENUNCIAR<br>EXTORSIÓN</div>
                    <div class="buttonExtorsion-face buttonExtorsion-back">EMERGENCIA</div>
                    <div class="buttonExtorsion-face buttonExtorsion-side"></div>
                    <div class="buttonExtorsion-face buttonExtorsion-side" style="transform: rotateY(-90deg) translateZ(100px);"></div>
                    <div class="buttonExtorsion-face buttonExtorsion-top"></div>
                    <div class="buttonExtorsion-face buttonExtorsion-top" style="transform: rotateX(-90deg) translateZ(100px);"></div>
                </div>
            </div>


            <!-- Nuevo botón EmergenciaConocido (inicialmente oculto) -->
            <!--<button id="emergenciaConocidoButton" class="custom-button">Llamar a<br>Conocido</button>-->

            <!-- Contenedor del botón de emergencia 3D para Conocido -->
            <div id="emergencyConocidoButtonContainer">
                <div id="emergenciaConocidoButton3D">
                    <div class="buttonConocido-face buttonConocido-front">LLAMAR A<br>CONOCIDO</div>
                    <div class="buttonConocido-face buttonConocido-back">EMERGENCIA</div>
                    <div class="buttonConocido-face buttonConocido-side"></div>
                    <div class="buttonConocido-face buttonConocido-side" style="transform: rotateY(-90deg) translateZ(100px);"></div>
                    <div class="buttonConocido-face buttonConocido-top"></div>
                    <div class="buttonConocido-face buttonConocido-top" style="transform: rotateX(-90deg) translateZ(100px);"></div>
                </div>
            </div>

            <!-- botones debajo del botón de emergencia y Contenedores de ayuda para los botones -->
            <div class="button-containerTipoEmergencias">
                <div class="button-with-help">
                    <button id="c5Button" class="custom-button" disabled>C5</button>
                    <div id="c5HelpContainer" class="help-container" style="display: flex;">
                        <div id="c5Help" class="help-icon">!</div>
                    </div>
                </div>
                
                <div class="button-with-help">
                    <button id="cuadranteButton" class="custom-button">Cuadrante</button>
                    <div id="cuadranteHelpContainer" class="help-container" style="display: none;">
                        <div id="cuadranteHelp" class="help-icon">!</div>
                    </div>
                </div>
                
                <div class="button-with-help">
                    <button id="extorsionButton" class="custom-button">Extorsión</button>
                    <div id="extorsionHelpContainer" class="help-container" style="display: none;">
                        <div id="extorsionHelp" class="help-icon">!</div>
                    </div>
                </div>
                
                <div class="button-with-help">
                    <button id="conocidoButton" class="custom-button">Conocido</button>
                    <div id="conocidoHelpContainer" class="help-container" style="display:none;">
                        <div id="conocidoHelp" class="help-icon">!</div>
                    </div>
                </div>
            </div>

            <button id="modifyUrlButton" aria-label="Modificar URL">URL MPN</button>
            <button id="modifyGiroButton" aria-label="Modificar Giro">Giro</button>
            <button id="modifyNombreButton" aria-label="Modificar Nombre">Nombre</button>
            <button id="modifyTelCuadranteButton" aria-label="Modificar Tel Cuadrante">Tel Cuadrante</button>
            <button id="modifyTelExtorsionButton" aria-label="Modificar Tel Extorsión">Tel Extorsión</button>
            <button id="modifyTelConocidoButton" aria-label="Modificar Tel Conocido">Tel Conocido</button>

            <!-- Ventana de mensaje personalizada -->
            <div id="customAlert" class="custom-alert">
                <p id="alertMessage"></p>
                <button id="alertCloseButton">Entendido</button>
            </div>

            <!-- Alerta personalizada para C5 -->
            <div id="customAlertC5" class="custom-alert-c5">
                <video id="c5Video" width="100%" height="100%" autoplay loop muted playsinline>
                    <!-- Ruta relativa desde la carpeta del proyecto -->
                    <source src="videos/procesoMPN.mp4" type="video/mp4">
                    Tu navegador no soporta videos HTML5.
                </video>
                <button id="alertC5CloseButton">Cerrar</button>
            </div>


            <!-- Alerta personalizada para Cuadrante -->
            <div id="customAlertCuadrante" class="custom-alert-cuadrante">
                <p id="alertCuadranteMessage">Te comunicarás con el jefe de cuadrante correspondiente al negocio o establecimiento registrado.</p>
                <button id="alertCuadranteCloseButton">Entendido</button>
            </div>
            
            
            <!-- Para el mensaje de Casos de Extorsión -->
            <div id="customAlertExtorsion" class="custom-alert-extorsion">
                <p><strong>Ante un caso de Extorsión:</strong><br>
                    1. Trata de mantener la calma<br>
                    2. De acuerdo a la situación cuelga o actúa con cautela<br>
                    3. Comunícate al teléfono de atención</p>
                <button id="alertExtorsionCloseButton">Entendido</button>
            </div>

            <!-- Alerta personalizada para Conocido -->
            <div id="customAlertConocido" class="custom-alert-conocido">
                <p id="alertConocidoMessage">Te comunicarás con una persona de confianza.</p>
                <button id="alertConocidoCloseButton">Entendido</button>
            </div>

            <!-- Cuadro de confirmación personalizado -->
            <div id="customConfirm" class="custom-confirm" style="display: none;">
                <p>¿Confirma activar la emergencia? <br>Esto enviará una alerta a las autoridades.</p>
                <div class="button-container">
                    <button id="confirmYes">Activar</button>
                    <button id="confirmNo">Cancelar</button>
                </div>
            </div>

            <!-- Cuadro de diálogo para modificar la URL -->
            <div id="customUrlInput" class="custom-url-input">
                <input type="text" id="newUrlInput" placeholder="Ingresa una URL MPN">
                <div class="button-container">
                    <button id="urlSubmitButton">Guardar</button>
                    <button id="urlCancelButton">Cancelar</button>
                    
                </div>
                <button id="scanQRButton">[-]</button>  
            </div>
            
            <div id="qrScannerContainer">
                <video id="qrScanner">
                    
                </video>
                <div id="qrLaser"></div> <!-- Nuevo elemento para el láser -->
                <button id="closeScannerButton">Cerrar</button>
            </div>

            <!-- Cuadro de diálogo para modificar el giro del negocio -->
            <div id="customGiroInput" class="custom-giro-input">
                <input type="text" id="newGiroInput" placeholder="Giro del Negocio" maxlength="16">
                <div class="char-counter" id="giroCharCounter">0/16</div>
                <div class="button-container">
                    <button id="giroSubmitButton">Guardar</button>
                    <button id="giroCancelButton">Cancelar</button>
                </div>
            </div>

            <!-- Cuadro de diálogo para modificar el nombre del negocio -->
            <div id="customNombreInput" class="custom-nombre-input">
                <input type="text" id="newNombreInput" placeholder="Nombre del Negocio" maxlength="15">
                <div class="char-counter" id="nombreCharCounter">0/15</div>
                <div class="button-container">
                    <button id="nombreSubmitButton">Guardar</button>
                    <button id="nombreCancelButton">Cancelar</button>
                </div>
            </div> 

            <!-- Cuadro de diálogo para ingresar el número de teléfono -->
        <div id="customTelCuadranteInput" class="custom-tel-cuadrante-input">
            <input type="tel" id="newTelCuadranteInput" placeholder="Teléfono de 10 dígitos" maxlength="10">
            <div class="char-counter" id="telCuadranteCharCounter">0/10</div>
            <div class="button-container">
                <button id="telCuadranteSubmitButton">Guardar</button>
                <button id="telCuadranteCancelButton">Cancelar</button>
            </div>
        </div>

            <!-- Cuadro de diálogo para ingresar el número de teléfono -->
        <div id="customTelExtorsionInput" class="custom-tel-extorsion-input">
            <input type="tel" id="newTelExtorsionInput" placeholder="Teléfono de 10 dígitos" maxlength="10">
            <div class="char-counter" id="telExtorsionCharCounter">0/10</div>
            <div class="button-container">
                <button id="telExtorsionSubmitButton">Guardar</button>
                <button id="telExtorsionCancelButton">Cancelar</button>
            </div>
        </div>

        <!-- Cuadro de diálogo para modificar el teléfono de conocido -->
        <div id="customTelConocidoInput" class="custom-tel-conocido-input">
            <input type="tel" id="newTelConocidoInput" placeholder="Teléfono de 10 dígitos" maxlength="10">
            <div class="char-counter" id="telConocidoCharCounter">0/10</div>
            <div class="button-container">
                <button id="telConocidoSubmitButton">Guardar</button>
                <button id="telConocidoCancelButton">Cancelar</button>
            </div>
        </div>

            <!-- Menú de hamburguesa -->
            <div id="hamburgerMenu" class="hamburger-menu">
                <div class="hamburger-icon" title="Menú" onclick="toggleMenu()">&#9881;</div>
                <div id="menuOptions" class="menu-options">
                    <div class="menu-item" onclick="showCustomUrlInput()">URL</div>
                    <div class="menu-item" onclick="showCustomGiroInput()">Giro y Nombre</div>
                    <!-- <div class="menu-item" onclick="showCustomNombreInput()">Nombre</div> -->
                    <div class="menu-item" onclick="showCustomTelCuadranteInput()">Tel Cuadrante</div>
                    <div class="menu-item" onclick="showCustomTelExtorsionInput()">Tel Extorsión</div>
                    <div class="menu-item" onclick="showCustomTelConocidoInput()">Tel Conocido</div>
                    <div class="menu-item" onclick="mostrarFormularioUbicacion()">Ubicación</div>
                </div>
            </div>

        <!-- Apartado para mostrar los registros de activación -->
        <h2 id="registrosTitulo" style="display: none;">Registros de Activación <button id="closeRegistrosButton" class="close-button">X</button></h2>
        <div id="registrosActivacion" class="registros-container" style="display: none;">
            <ul id="listaRegistros"></ul>
        </div>

        <!-- Botón para consultar los registros de activación -->
        <button id="toggleRegistrosButton" class="custom-button"  title="Registros de Activación" aria-label="Registros">≡</button>

        <div id="graficasOverlay" class="overlay"></div>

        <div id="graficasContainer" class="graficas-container">
            <div class="graficas-header">
                <div class="graficas-total" id="totalActivaciones">Total de activaciones: 0</div>
            </div>
            <div class="graficas-grid">
                <div class="dona-container">
                    <div class="dona-wrapper neon-yellow" id="donaNegocioWrapper">
                        <canvas id="donaNegocio"></canvas>
                        <div class="dona-percentage neon-yellow" id="porcentajeNegocio">0%</div>
                        <!--<div class="dona-count neon-yellow" id="contadorNegocio">0</div>-->
                    </div>
                </div>
                <div class="dona-container">
                    <div class="dona-wrapper neon-blue" id="donaCuadranteWrapper">
                        <canvas id="donaCuadrante"></canvas>
                        <div class="dona-percentage neon-blue" id="porcentajeCuadrante">0%</div>
                        <!--<div class="dona-count neon-blue" id="contadorCuadrante">0</div>-->
                    </div>
                </div>
                <div class="dona-container">
                    <div class="dona-wrapper neon-pink" id="donaExtorsionWrapper">
                        <canvas id="donaExtorsion"></canvas>
                        <div class="dona-percentage neon-pink" id="porcentajeExtorsion">0%</div>
                        <!--div class="dona-count neon-pink" id="contadorExtorsion">0</div>-->
                    </div>
                </div>
                <div class="dona-container">
                    <div class="dona-wrapper neon-rose" id="donaConocidoWrapper">
                        <canvas id="donaConocido"></canvas>
                        <div class="dona-percentage neon-rose" id="porcentajeConocido">0%</div>
                        <!--<div class="dona-count neon-rose" id="contadorConocido">0</div>-->
                    </div>
                </div>
            </div>
        </div>

        <!-- Formulario de Ubicación -->
        <div id="ubicacionFormContainer">
            <form id="ubicacionForm">
                <h3 style="color: #00ffff; margin-top: 0; text-align: center;">Ubicación del Establecimiento</h3>
                <input type="text" id="calle" placeholder="Calle" required>
                <input type="text" id="noExt" placeholder="No. Ext." required>
                <input type="text" id="noInt" placeholder="No. Int. (No requerido)" disabled>
                <input type="text" id="colonia" placeholder="Colonia" required>
                <input type="text" id="codigoPostal" placeholder="Código Postal" required>
                <input type="text" id="alcaldia" placeholder="Alcaldía" required>
                <input type="text" id="ciudad" placeholder="Ciudad" required>
                
                <div class="button-container">
                    <button type="button" id="cancelarUbicacion">Cancelar</button>
                    <button type="submit" id="guardarUbicacion">Guardar</button>
                </div>
                
                <!-- Contenedor para las coordenadas (inicialmente oculto) -->
                <div id="coordenadasContainer" style="display: none; margin-top: 20px; padding: 10px; background-color: rgba(0,0,0,0.5); border-radius: 5px; text-align: center;">
                    <p style="color: #00ffff; margin: 0 0 5px 0;">Coordenadas generadas:</p>
                    <p id="coordenadasText" style="color: white; margin: 0 0 10px 0; font-family: monospace;"></p>
                    <button type="button" id="mostrarUbicacionButton" style="background-color: #00bfff; color: black; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;">Mostrar Ubicación en Mapa</button>
                </div>
            </form>
        </div>

        <!-- Overlay para mensaje de coordenadas generadas -->
        <div id="coordenadasOverlay" class="coordenadas-overlay"></div>
         
        <div id="coordenadasGeneradas" class="coordenadas-message">
            <p>Coordenadas generadas.<br> Haga clic en 'Mostrar Ubicación' para ver en el mapa.</p>
        </div>
        
        <!-- Para el mensaje de Coordenadas no encontradas -->
        <div id="coordenadasMessage3" class="coordenadas-message_3">
            <p><strong>Coordenadas no encontradas</strong><br>
                Verifica la información y considera:<br>
                1. No abreviar<br>
                2. No utilizar simbolos</p>
            <button id="message3CloseButton">Entendido</button>
        </div>
       

        <!-- Overlay para mensaje de coordenadas generadas_2 -->
        <div id="coordenadasOverlay_2" class="coordenadas-overlay_2">
            <div class="coordenadas-message_2">
                <p>Buscando coordenadas para la dirección...</p>
                <div class="loader_2"></div>
            </div>
        </div>

        <!-- Botón para centrar el mapa en el marcador -->
        <button id="center-map-button" title="Centrar mapa en el marcador">⌖</button>
        

        <!-- Dentro del div #qrScannerContainer, antes del video -->
        <div id="qrLoader" class="qr-loader">
            <div class="loader-content">
                <div class="loader-spinner"></div>
                <p>Escaneando QR...</p>
            </div>
        </div>

        <!-- Agrega esto en tu HTML, junto con los otros cuadros de diálogo -->
        <div id="customWarning" class="custom-warning">
            <p>¿Modificar la información?</p>
            <div class="button-container">
                <button id="warningModify">Modificar</button>
                <button id="warningCancel">Cancelar</button>
            </div>
        </div>


    <script>
        
        // Obtener la URL guardada en el LocalStorage o usar la predeterminada
        let currentUrl = localStorage.getItem('emergencyUrl') || '';// '' Aquí estaba la URL MPN

        const savedUrl = localStorage.getItem('emergencyUrl');
        if (savedUrl) {
            document.getElementById('newUrlInput').value = maskData(savedUrl);
        }

        // Función para mostrar la ventana de mensaje personalizada
        function showCustomAlert(message, alertType = 'error') {
            const customAlert = document.getElementById('customAlert');
            const overlay = document.getElementById('overlay');
            const alertMessage = document.getElementById('alertMessage');
            alertMessage.innerHTML = message;

            // Restablecer clases
            customAlert.className = 'custom-alert';

            // Cambiar el color de fondo según el tipo de alerta
            if (alertType === 'success') {
                customAlert.classList.add('success');
            } else if (alertType === 'confirmation') {
                customAlert.classList.add('confirmation');
            }
            
            // Mostrar tanto la alerta como el overlay
            customAlert.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Función para ocultar la ventana de mensaje personalizada
        function hideCustomAlert() {
            const customAlert = document.getElementById('customAlert');
            const alertMessage = document.getElementById('alertMessage').textContent;
            
            // Solo ocultar el overlay si no es un mensaje de error de validación de teléfono
            if (!alertMessage.includes("número de teléfono válido")) {
                const overlay = document.getElementById('overlay');
                overlay.style.display = 'none';
            }
            
            customAlert.style.display = 'none';
        }

        // Función para mostrar la alerta a C5
        function showCustomAlertC5() {
    const customAlertC5 = document.getElementById('customAlertC5');
    const overlay = document.getElementById('overlay');
    const video = document.getElementById('c5Video');
    
    customAlertC5.style.display = 'flex';
    overlay.style.display = 'block';
    
    // Reiniciar el video si ya estaba reproduciéndose
    video.currentTime = 0;
    video.play().catch(e => console.log("Error al reproducir video:", e));
}

function hideCustomAlertC5() {
    const customAlertC5 = document.getElementById('customAlertC5');
    const overlay = document.getElementById('overlay');
    const video = document.getElementById('c5Video');
    
    customAlertC5.style.display = 'none';
    overlay.style.display = 'none';
    video.pause();
}

        // Evento para cerrar la alerta a Conocido
        document.getElementById('alertC5CloseButton').addEventListener('click', hideCustomAlertC5);

        // Función para mostrar la alerta de cuadrante
        function showCustomAlertCuadrante() {
            const customAlertCuadrante = document.getElementById('customAlertCuadrante');
            const overlay = document.getElementById('overlay');
            
            customAlertCuadrante.style.display = 'flex';
            overlay.style.display = 'block';
        }

        // Función para ocultar la alerta de cuadrante
        function hideCustomAlertCuadrante() {
            const customAlertCuadrante = document.getElementById('customAlertCuadrante');
            const overlay = document.getElementById('overlay');
            
            customAlertCuadrante.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Evento para cerrar la alerta de cuadrante
        document.getElementById('alertCuadranteCloseButton').addEventListener('click', hideCustomAlertCuadrante);

        function showCustomAlertExtorsion() {
            const customAlertExtorsion = document.getElementById('customAlertExtorsion');
            const overlay = document.getElementById('overlay');
            
            customAlertExtorsion.style.display = 'flex';
            overlay.style.display = 'block';
        }

        function hideCustomAlertExtorsion() {
            const customAlertExtorsion = document.getElementById('customAlertExtorsion');
            const overlay = document.getElementById('overlay');
            
            customAlertExtorsion.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Evento para cerrar la alerta de extorsión
        document.getElementById('alertExtorsionCloseButton').addEventListener('click', hideCustomAlertExtorsion);

        // Función para mostrar la alerta a Conocido
        function showCustomAlertConocido() {
            const showCustomAlertConocido = document.getElementById('customAlertConocido');
            const overlay = document.getElementById('overlay');
            
            showCustomAlertConocido.style.display = 'flex';
            overlay.style.display = 'block';
        }

        // Función para ocultar la alerta a Conocido
        function hideCustomAlertConocido() {
            const customAlertConocido = document.getElementById('customAlertConocido');
            const overlay = document.getElementById('overlay');
            
            customAlertConocido.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Evento para cerrar la alerta a Conocido
        document.getElementById('alertConocidoCloseButton').addEventListener('click', hideCustomAlertConocido);


        // Función para mostrar el cuadro de confirmación personalizado
        function showCustomConfirm() {
            const customConfirm = document.getElementById('customConfirm');
            const overlay = document.getElementById('overlay');
            customConfirm.style.display = 'block';
            overlay.style.display = 'block';

            // Agregar la clase "active" al botón de emergencia
            const emergencyButton = document.getElementById('emergencyButton3D');
            emergencyButton.classList.add('active');
        }

        // Función para ocultar el cuadro de confirmación personalizado
        function hideCustomConfirm() {
            const customConfirm = document.getElementById('customConfirm');
            const overlay = document.getElementById('overlay');
            customConfirm.style.display = 'none';
            overlay.style.display = 'none';

            // Eliminar la clase "active" del botón de emergencia
            const emergencyButton = document.getElementById('emergencyButton3D');
            emergencyButton.classList.remove('active');
        }

        // Función para mostrar el cuadro de diálogo para modificar la URL
        function showCustomUrlInput() {
            const savedUrl = localStorage.getItem('emergencyUrl');
            
            // Si ya hay una URL guardada, mostrar advertencia
            if (savedUrl && savedUrl.trim() !== '') {
                showCustomWarning();
            } else {
                // Si no hay URL guardada, mostrar directamente el input
                const customUrlInput = document.getElementById('customUrlInput');
                const overlay = document.getElementById('overlay');
                const inputElement = document.getElementById('newUrlInput');
                
                inputElement.value = '';
                customUrlInput.style.display = 'block';
                overlay.style.display = 'block';
            }
        }

        // Función para mostrar la advertencia de modificación
        function showCustomWarning() {
            const customWarning = document.getElementById('customWarning');
            const overlay = document.getElementById('overlay');
            
            customWarning.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Función para ocultar la advertencia de modificación
        function hideCustomWarning() {
            const customWarning = document.getElementById('customWarning');
            const overlay = document.getElementById('overlay');
            
            customWarning.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Evento para el botón "Modificar" de la advertencia
        document.getElementById('warningModify').addEventListener('click', function() {
            hideCustomWarning();
            
            // Mostrar el input de URL
            const customUrlInput = document.getElementById('customUrlInput');
            const overlay = document.getElementById('overlay');
            const inputElement = document.getElementById('newUrlInput');
            
            // Mostrar el valor enmascarado
            const savedUrl = localStorage.getItem('emergencyUrl');
            inputElement.value = savedUrl ? maskData(savedUrl) : '';
            
            customUrlInput.style.display = 'block';
            overlay.style.display = 'block';
        });

        // Evento para el botón "Cancelar" de la advertencia
        document.getElementById('warningCancel').addEventListener('click', function() {
            hideCustomWarning();
        });

        // Función para ocultar el cuadro de diálogo para modificar la URL
        function hideCustomUrlInput(restorePrevious = true) {
            const customUrlInput = document.getElementById('customUrlInput');
            const overlay = document.getElementById('overlay');
            const inputElement = document.getElementById('newUrlInput');
            
            if (restorePrevious) {
                // Restaurar el valor guardado en localStorage pero enmascarado
                const savedUrl = localStorage.getItem('emergencyUrl');
                inputElement.value = savedUrl ? maskData(savedUrl) : '';
                
                // Limpiar la URL escaneada temporal
                scannedUrl = '';
            }
            
            customUrlInput.style.display = 'none';
            overlay.style.display = 'none';
        }

        
        // Función para mostrar el cuadro de diálogo para modificar el giro del negocio
        function showCustomGiroInput() {
            const customGiroInput = document.getElementById('customGiroInput');
            const customNombreInput = document.getElementById('customNombreInput');
            const overlay = document.getElementById('overlay');
            
            // Mostrar ambos inputs
            customGiroInput.style.display = 'block';
            customNombreInput.style.display = 'block';
            
            // Posicionar uno debajo del otro
            customGiroInput.style.top = '40%';
            customNombreInput.style.top = '80%';
            
            overlay.style.display = 'block';
            
            // Enfocar el input del giro automáticamente
            document.getElementById('newGiroInput').focus();
        }

        // Función para ocultar el cuadro de diálogo para modificar el giro del negocio
        function hideCustomGiroInput() {
            const customGiroInput = document.getElementById('customGiroInput');
            const customNombreInput = document.getElementById('customNombreInput');
            const overlay = document.getElementById('overlay');
            
            // Solo cerrar si el botón no está en estado "guardado"
            const saveButton = document.getElementById('giroSubmitButton');
            const cancelButton = document.getElementById('giroCancelButton');
            
            if (!saveButton.classList.contains('saved') || cancelButton.textContent === 'Cancelar') {
                customGiroInput.style.display = 'none';
            
                
                // Restablecer posiciones
                customGiroInput.style.top = '50%';
                customNombreInput.style.top = '50%';
                
                overlay.style.display = 'block';
            }
        }

        // Función para mostrar el cuadro de diálogo para modificar el nombre del negocio
        function showCustomNombreInput() {
            const customNombreInput = document.getElementById('customNombreInput');
            const overlay = document.getElementById('overlay');
            customNombreInput.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Función para ocultar el cuadro de diálogo para modificar el nombre del negocio
        function hideCustomNombreInput() {
            const customNombreInput = document.getElementById('customNombreInput');
            const customGiroInput = document.getElementById('customGiroInput');
            const overlay = document.getElementById('overlay');
            
            customNombreInput.style.display = 'none';
            customGiroInput.style.display = 'none';
            overlay.style.display = 'none';
            
            // Restablecer posiciones
            customGiroInput.style.top = '50%';
            customNombreInput.style.top = '50%';
        }

        // Evento para cerrar la ventana de mensaje
        document.getElementById('alertCloseButton').addEventListener('click', hideCustomAlert);
        

        // Evento para el botón "Sí" del cuadro de confirmación
        document.getElementById('confirmYes').addEventListener('click', function () {
            vibrateLong(); // Vibración larga al confirmar
            hideCustomConfirm();
            
            // Verificar si hay conexión a Internet
            if (!navigator.onLine) {
                showCustomAlert("No hay conexión a internet, o datos móviles.");
                return;
            }

            // Crear contenedor de cuenta regresiva
            const countdownContainer = document.createElement('div');
            countdownContainer.className = 'countdown-container';
            countdownContainer.innerHTML = `
                <div class="countdown-message">Enviando alerta de emergencia en...</div>
                <div class="countdown-number">5</div>
                <div class="countdown-progress-container">
                    <div class="countdown-progress-bar"></div>
                </div>
                <button class="countdown-cancel-btn">CANCELAR</button>
            `;

            document.body.appendChild(countdownContainer);
            const progressBar = countdownContainer.querySelector('.countdown-progress-bar');

            // Variables para los intervalos
            let vibrationInterval;
            let countdownInterval;

            // Función para limpiar todos los intervalos
            const clearAllIntervals = () => {
                clearInterval(vibrationInterval);
                clearInterval(countdownInterval);
                if (supportsVibration()) {
                    navigator.vibrate(0); // Detener cualquier vibración en curso
                }
            };

            // Botón para cancelar
            const cancelBtn = countdownContainer.querySelector('.countdown-cancel-btn');
            cancelBtn.addEventListener('click', function() {
                clearAllIntervals();
                document.body.removeChild(countdownContainer);
                return;
            });

            // Iniciar cuenta regresiva
            let seconds = 5;
            const countdownNumber = countdownContainer.querySelector('.countdown-number');
            
            // Intervalo de vibración (vibración corta cada segundo)
            vibrationInterval = setInterval(() => {
                if (seconds > 0) {
                    vibrateShort();
                }
            }, 1000);
            
            countdownInterval = setInterval(() => {
                seconds--;
                countdownNumber.textContent = seconds;
                
                // Actualizar barra de progreso (0% al inicio, 100% al final)
                progressBar.style.width = `${(5 - seconds) * 20}%`;
                
                if (seconds <= 0) {
                    clearAllIntervals();
                    // Mostrar mensaje "¡ENVIADO!" antes de enviar
                    countdownNumber.textContent = "¡ENVIADO!";
                    countdownNumber.classList.add('envio');
                    
                    // Vibración corta cuando aparece "ENVIADO"
                    vibrateLong();
                    
                    // Esperar 1 segundo antes de proceder con el envío
                    setTimeout(() => {
                        document.body.removeChild(countdownContainer);
                                
                        try {
                            const nuevaVentana = window.open(currentUrl, '_blank');

                            if (!nuevaVentana) {
                                throw new Error("No se pudo abrir la ventana. Verifica si hay un bloqueador de ventanas emergentes.");
                            }

                            guardarRegistroActivacion('Emergencia Negocio');
                            // Obtener la hora actual
                            const now = new Date();
                            const hours = String(now.getHours()).padStart(2, '0');
                            const minutes = String(now.getMinutes()).padStart(2, '0');
                            const seconds = String(now.getSeconds()).padStart(2, '0');
                            const timeString = `${hours}:${minutes}:${seconds}`;

                            setTimeout(() => {
                                if (!nuevaVentana.closed) {
                                    nuevaVentana.close();
                                    showCustomAlert(`¡Botón Activado!<br>Hora: ${timeString}`, 'confirmation');
                                }
                            }, 20000);
                        } catch (error) {
                            showCustomAlert(`Error: ${error.message}`);
                        }
                    }, 1000);
                }
            }, 1000);
        });

        // Evento para el botón "No" del cuadro de confirmación
        document.getElementById('confirmNo').addEventListener('click', function () {
            hideCustomConfirm();
        });

        // Evento para el botón "Aceptar" del cuadro de diálogo para modificar la URL
        document.getElementById('urlSubmitButton').addEventListener('click', function() {
            const inputElement = document.getElementById('newUrlInput');
            const savedUrl = localStorage.getItem('emergencyUrl');
            
            // Determinar qué URL guardar
            let urlToSave;
            
            // Si el valor del input está enmascarado (contiene asteriscos) y tenemos una URL escaneada
            if (inputElement.value.includes('*') && scannedUrl) {
                urlToSave = scannedUrl;
            } else {
                // Usar el valor del input (podría ser una nueva URL o la misma ya enmascarada)
                urlToSave = inputElement.value;
                
                // Si la URL está enmascarada pero no hay URL escaneada, usar la guardada
                if (inputElement.value.includes('*') && savedUrl) {
                    urlToSave = savedUrl;
                }
            }
            
            if (urlToSave) {
                // Guardar la URL sin enmascarar
                localStorage.setItem('emergencyUrl', urlToSave);
                currentUrl = urlToSave;
                
                // Actualizar el input con el valor enmascarado
                inputElement.value = maskData(urlToSave);
                
                // Limpiar la URL escaneada temporal
                scannedUrl = '';
                
                hideCustomUrlInput(false);
                showCustomAlert("URL modificada exitosamente.", 'success');
            } else {
                showCustomAlert("Ingresa una URL MPN válida.");
            }
        });

        // Evento para el botón "Cancelar" del cuadro de diálogo para modificar la URL
        document.getElementById('urlCancelButton').addEventListener('click', function() {
            hideCustomUrlInput(true); // Restaurar el valor anterior al cancelar
        })

        
        // Evento para el botón "Guardar" (en localStorage) del cuadro de diálogo para modificar el giro del negocio
        document.getElementById('giroSubmitButton').addEventListener('click', function () {
            const newGiro = document.getElementById('newGiroInput').value;
            const newNombre = document.getElementById('newNombreInput').value;
            
            if (newGiro) {
                // Validar que no exceda 16 caracteres
                if (newGiro.length > 16) {
                    showCustomAlert("El giro del negocio no debe exceder 16 caracteres.");
                    return;
                }
                
                // Actualizar el texto mostrado
                document.getElementById('giroNegocioText').textContent = newGiro.toUpperCase();
                
                // Guardar en localStorage
                localStorage.setItem('giroNegocio', newGiro);
                
                // También guardar el nombre si se modificó
                if (newNombre) {
                    const nombreConComillas = `"${newNombre}"`;
                    document.getElementById('nombreNegocioText').textContent = nombreConComillas.toUpperCase();
                    localStorage.setItem('nombreNegocio', nombreConComillas);
                }
                
                // Cambiar el botón Guardar a icono de validación
                this.innerHTML = '✓';
                this.classList.add('saved');
                this.disabled = true;
                
                // Cambiar el botón Cancelar a Borrar
                const cancelButton = document.getElementById('giroCancelButton');
                cancelButton.textContent = 'Borrar';
                cancelButton.classList.add('delete');
            }
            
            document.getElementById('newNombreInput').focus();
        });

        // Modificar el evento del botón Cancelar/Borrar el giro del negocio
        document.getElementById('giroCancelButton').addEventListener('click', function () {
            if (this.textContent === 'Borrar') {
                // Lógica para borrar
                document.getElementById('newGiroInput').value = '';
                localStorage.removeItem('giroNegocio');
                document.getElementById('giroNegocioText').textContent = 'GIRO DEL NEGOCIO';
                
                
                // Restaurar botones a su estado original
                const saveButton = document.getElementById('giroSubmitButton');
                saveButton.innerHTML = 'Guardar';
                saveButton.classList.remove('saved');
                saveButton.disabled = false;
                
                this.textContent = 'Cancelar';
                this.classList.remove('delete');
                
                // Posicionar el cursor en el input del giro
                document.getElementById('newGiroInput').focus();
                
                // No cerrar el overlay aquí
            } else {
                // Comportamiento normal de cancelar
                hideCustomGiroInput();
            }
        });

        // Cargar el giro del negocio desde localStorage al cargar la página
        window.addEventListener('load', function() {
            const savedGiro = localStorage.getItem('giroNegocio');
            if (savedGiro) {
                document.getElementById('newGiroInput').value = savedGiro;
                document.getElementById('giroCharCounter').textContent = `${savedGiro.length}/16`;
            }
        });

        // Evento para el botón "Guardar" (en localStorage) del cuadro de diálogo para modificar el nombre del negocio
        document.getElementById('nombreSubmitButton').addEventListener('click', function() {
            const newNombre = document.getElementById('newNombreInput').value;
            if (newNombre) {
                // Validar que no exceda 16 caracteres
                if (newNombre.length > 15) {
                    showCustomAlert("El nombre del negocio no debe exceder 15 caracteres.");
                    return;
                }
                
                // Asegurarse de que el nombre esté entre comillas
                const nombreConComillas = `"${newNombre}"`;
                document.getElementById('nombreNegocioText').textContent = nombreConComillas.toUpperCase();
                localStorage.setItem('nombreNegocio', nombreConComillas);
                hideCustomNombreInput();
            } else {
                showCustomAlert("Ingresa un nombre válido.");
            }
        });

        // Cargar el nombre del negocio desde localStorage al cargar la página
        window.addEventListener('load', function() {
            const savedNombre = localStorage.getItem('nombreNegocio');
            if (savedNombre) {
                // Eliminar las comillas si existen para mostrarlas en el input
                const nombreSinComillas = savedNombre.replace(/^"|"$/g, '');
                document.getElementById('newNombreInput').value = nombreSinComillas;
                document.getElementById('nombreCharCounter').textContent = `${nombreSinComillas.length}/15`;
            }
        });

        // Evento para el botón "Cancelar" del cuadro de diálogo para modificar el nombre del negocio
        document.getElementById('nombreCancelButton').addEventListener('click', function () {
            hideCustomNombreInput();
        });

        // Lógica del botón de emergencia 3D
        document.getElementById('emergencyButton3D').addEventListener('click', function() {
            vibrateShort(); // Vibración corta al presionar
    
            // Verificar si la URL está vacía
            if (!currentUrl || currentUrl.trim() === '') {
                showCustomAlert("Carga una URL MPN antes de activar la emergencia.");
            } else {
                showCustomConfirm();
            }
        });

        // Lógica del botón para modificar la URL
        document.getElementById('modifyUrlButton').addEventListener('click', function () {
            showCustomUrlInput();
        });

        // Lógica del botón para modificar el giro del negocio
        document.getElementById('modifyGiroButton').addEventListener('click', function () {
            showCustomGiroInput();
        });

        // Lógica del botón para modificar el nombre del negocio
        document.getElementById('modifyNombreButton').addEventListener('click', function () {
            showCustomNombreInput();
        });

        // Inicializar los botones como desactivados al cargar la página
        window.addEventListener('load', function () {
            document.getElementById('urlSubmitButton').disabled = true;
            document.getElementById('giroSubmitButton').disabled = true;
            document.getElementById('nombreSubmitButton').disabled = true;
        });

        // Habilitar/deshabilitar el botón "Guardar" cuando cambie el valor del campo de entrada
        document.getElementById('newUrlInput').addEventListener('input', function () {
            const urlSubmitButton = document.getElementById('urlSubmitButton');
            urlSubmitButton.disabled = !this.value.trim(); // Habilitar si hay texto
        });

        // Ocultar el botón de escanear QR cuando el campo de URL está enfocado
        document.getElementById('newUrlInput').addEventListener('focus', function () {
            const scanQRButton = document.getElementById('scanQRButton');
            scanQRButton.style.display = 'none'; // Ocultar el botón
        });

        // Mostrar el botón de escanear QR cuando el campo de URL pierde el foco
        document.getElementById('newUrlInput').addEventListener('blur', function () {
            const scanQRButton = document.getElementById('scanQRButton');
            scanQRButton.style.display = 'block'; // Mostrar el botón
        });

        // Habilitar/deshabilitar el botón de guardar giro
        document.getElementById('newGiroInput').addEventListener('input', function() {
            const currentLength = this.value.length;
            document.getElementById('giroCharCounter').textContent = `${currentLength}/16`;
            
            if (currentLength > 16) {
                this.value = this.value.substring(0, 16);
                document.getElementById('giroCharCounter').textContent = "16/16";
                showCustomAlert("Máximo 16 caracteres permitidos");
                return;
            }
            
            const giroSubmitButton = document.getElementById('giroSubmitButton');
            giroSubmitButton.disabled = !this.value.trim();
        });

        //Para tener un control sobre la función pegar (Ctrl+V) que no tenga más de 18 digitos, quitar esta función en su versión Web
        document.getElementById('newGiroInput').addEventListener('paste', function(e) {
            // Obtener el texto pegado
            const pastedText = e.clipboardData.getData('text/plain');
            
            // Si al pegar se excede el límite
            if (this.value.length + pastedText.length > 16) {
                e.preventDefault();
                showCustomAlert("El texto pegado excede el límite de 16 caracteres");
            }
        });

        // Evento para Habilitar/deshabilitar el botón de guardar nombre, para el input de nombre del negocio
        document.getElementById('newNombreInput').addEventListener('input', function() {
            const currentLength = this.value.length;
            document.getElementById('nombreCharCounter').textContent = `${currentLength}/15`;
            
            if (currentLength > 15) {
                this.value = this.value.substring(0, 15);
                document.getElementById('nombreCharCounter').textContent = "15/15";
                //showCustomAlert("Máximo 15 caracteres permitidos");
                return;
            }
            
            const nombreSubmitButton = document.getElementById('nombreSubmitButton');
            nombreSubmitButton.disabled = !this.value.trim();
        });

        // Evento para controlar el pegado de texto en el campo de nombre
        document.getElementById('newNombreInput').addEventListener('paste', function(e) {
            const pastedText = e.clipboardData.getData('text/plain');
            
            if (this.value.length + pastedText.length > 15) {
                e.preventDefault();
                showCustomAlert("El texto pegado excede el límite de 15 caracteres");
            }
        });
        // Mostrar el mensaje inicial y ocultarlo después de 2 segundos con animación
        document.addEventListener('DOMContentLoaded', function () {
            const initialMessageContent = document.getElementById('initialMessageContent');
            const initialMessageContainer = document.getElementById('initialMessageContainer');
            setTimeout(() => {
                initialMessageContent.classList.add('slide-up-and-fade');
                setTimeout(() => {
                    initialMessageContainer.style.display = 'none'; // Eliminar el fondo negro abruptamente
                }, 1000); // Ocultar después de que termine la animación
            }, 2000); // 2000 milisegundos = 2 segundos
        });

        
        let scannedUrl = ''; // Variable temporal para almacenar la URL escaneada

        function startQRScanner() {
            const video = document.getElementById('qrScanner');
            const qrScannerContainer = document.getElementById('qrScannerContainer');
            const closeScannerButton = document.getElementById('closeScannerButton');
            const qrLaser = document.getElementById('qrLaser');
            const qrLoader = document.getElementById('qrLoader');

            // Mostrar elementos
            qrScannerContainer.style.display = 'flex';
            video.style.display = 'block';
            closeScannerButton.style.display = 'block';
            qrLaser.style.display = 'block';
            
            // Mostrar el loader primero
            qrLoader.style.display = 'flex';

            // Solicitar acceso a la cámara
            navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
                .then(function(stream) {
                    // Ocultar el loader cuando la cámara esté lista
                    qrLoader.style.display = 'none';
                    
                    video.srcObject = stream;
                    video.setAttribute("playsinline", true);
                    video.play();
                    requestAnimationFrame(tick);
                })
                .catch(function(err) {
                    console.error("Error al acceder a la cámara: ", err);
                    // Ocultar el loader si hay error
                    qrLoader.style.display = 'none';
                    showCustomAlert("No se pudo acceder a la cámara. Asegúrate de haber dado los permisos necesarios.");
                    stopQRScanner();
                });

            function tick() {
                if (video.readyState === video.HAVE_ENOUGH_DATA) {
                    const canvas = document.createElement('canvas');
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    const context = canvas.getContext('2d');
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);
                    const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
                    const code = jsQR(imageData.data, imageData.width, canvas.height, {
                        inversionAttempts: "dontInvert",
                    });

                    if (code) {
                        // Mostrar el loader
                        qrLoader.style.display = 'flex';
                        qrLoader.querySelector('p').textContent = "Código QR detectado!";
                        
                        // Guardar la URL escaneada en la variable temporal
                        scannedUrl = code.data;
                        
                        // Esperar 1 segundo (mientras se muestra el loader)
                        setTimeout(() => {
                            qrLoader.style.display = 'none';
                            
                            // Mostrar el valor COMPLETO en el input (sin enmascarar)
                            document.getElementById('newUrlInput').value = scannedUrl;
                            
                            // Aplicar efecto de resplandor
                            const urlInput = document.getElementById('newUrlInput');
                            urlInput.classList.add('neon-glow');
                            
                            // Eliminar la clase después de que termine la animación
                            setTimeout(() => {
                                urlInput.classList.remove('neon-glow');
                            }, 1500);
                            
                            // Cerrar el escáner
                            stopQRScanner();
                            
                            // Habilitar el botón de guardar
                            document.getElementById('urlSubmitButton').disabled = false;
                        }, 1000);
                    }
                }
                requestAnimationFrame(tick);
            }
        }

        function stopQRScanner() {
            const video = document.getElementById('qrScanner');
            const qrScannerContainer = document.getElementById('qrScannerContainer');
            const closeScannerButton = document.getElementById('closeScannerButton');
            const qrLaser = document.getElementById('qrLaser');
            const qrLoader = document.getElementById('qrLoader');

            if (video.srcObject) {
                const tracks = video.srcObject.getTracks();
                tracks.forEach(track => track.stop());
                video.srcObject = null;
            }

            video.style.display = 'none';
            qrScannerContainer.style.display = 'none';
            closeScannerButton.style.display = 'none';
            qrLaser.style.display = 'none';
            qrLoader.style.display = 'none'; // Asegurarse de ocultar el loader
        }

        // Evento para el botón de cerrar el escáner de QR
        document.getElementById('closeScannerButton').addEventListener('click', function () {
            stopQRScanner();
        });

        // Evento para el botón de escanear QR
        document.getElementById('scanQRButton').addEventListener('click', function () {
            startQRScanner();
        });

        function maskData(value, unmask = false) {
    if (!value) return '';
    
    // Si estamos desenmascarando y el valor no está enmascarado, devolver el original
    if (unmask && !value.includes('*')) {
        return value;
    }
    
    // Si estamos enmascarando o el valor ya está enmascarado
    if (value.length <= 5) return value;
    
    // Mostrar exactamente 15 caracteres: 10 asteriscos + últimos 5 caracteres
    const masked = '*'.repeat(10) + value.slice(-5);
    return masked;
}

        
        //------- Estos son lo pequeños botones son los que aparecen debajo de los botones de emergencia -----------

        // Evento para el botón C5
        document.getElementById('c5Button').addEventListener('click', function() {
            manejarEstadoBotones(c5Button);
            //showCustomAlertC5();
            
            // Mostrar el botón de ayuda con animación
            const helpContainer = document.getElementById('c5HelpContainer');
            helpContainer.style.display = 'flex';
            helpContainer.classList.add('show');
            
            // Ocultar cuando se pulse cualquier otro botón
            document.querySelectorAll('.custom-button:not(#c5Button)').forEach(button => {
                button.addEventListener('click', function() {
                    helpContainer.style.display = 'none';
                    helpContainer.classList.remove('show');
                });
            });
        });

        // Evento para el botón de ayuda
        document.getElementById('c5Help').addEventListener('click', function() {
            showCustomAlertC5();
            
            // Efecto al hacer clic
            this.style.transform = 'scale(0.8)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 200);
        });

        // Evento para el botón Cuadrante
        document.getElementById('cuadranteButton').addEventListener('click', function() {
            manejarEstadoBotones(cuadranteButton);
            
            // Mostrar el botón de ayuda con animación
            const helpContainer = document.getElementById('cuadranteHelpContainer');
            helpContainer.style.display = 'flex';
            helpContainer.classList.add('show');
            
            // Ocultar el botón de ayuda de C5
            document.getElementById('c5HelpContainer').style.display = 'none';

            // Ocultar cuando se pulse cualquier otro botón
            document.querySelectorAll('.custom-button:not(#cuadranteButton)').forEach(button => {
                button.addEventListener('click', function() {
                    helpContainer.style.display = 'none';
                    helpContainer.classList.remove('show');
                });
            });
        });

        // Evento para el botón de ayuda de Cuadrante
        document.getElementById('cuadranteHelp').addEventListener('click', function() {
            showCustomAlertCuadrante();
            
            // Efecto al hacer clic
            this.style.transform = 'scale(0.8)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 200);
        });

        // Evento para el botón Extorsión
        document.getElementById('extorsionButton').addEventListener('click', function() {
            manejarEstadoBotones(extorsionButton);
            
            // Mostrar el botón de ayuda con animación
            const helpContainer = document.getElementById('extorsionHelpContainer');
            helpContainer.style.display = 'flex';
            helpContainer.classList.add('show');
            
            // Ocultar el botón de ayuda de C5
            document.getElementById('c5HelpContainer').style.display = 'none';

            // Ocultar cuando se pulse cualquier otro botón
            document.querySelectorAll('.custom-button:not(#extorsionButton)').forEach(button => {
                button.addEventListener('click', function() {
                    helpContainer.style.display = 'none';
                    helpContainer.classList.remove('show');
                });
            });
        });

        // Evento para el botón de ayuda de Extorsión
        document.getElementById('extorsionHelp').addEventListener('click', function() {
            showCustomAlertExtorsion();
            
            // Efecto al hacer clic
            this.style.transform = 'scale(0.8)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 200);
        });

        // Evento para el botón Conocido
        document.getElementById('conocidoButton').addEventListener('click', function() {
            manejarEstadoBotones(conocidoButton);
            
            // Mostrar el botón de ayuda con animación
            const helpContainer = document.getElementById('conocidoHelpContainer');
            helpContainer.style.display = 'flex';
            helpContainer.classList.add('show');
            
            // Ocultar el botón de ayuda de C5
            document.getElementById('c5HelpContainer').style.display = 'none';

            // Ocultar cuando se pulse cualquier otro botón
            document.querySelectorAll('.custom-button:not(#conocidoButton)').forEach(button => {
                button.addEventListener('click', function() {
                    helpContainer.style.display = 'none';
                    helpContainer.classList.remove('show');
                });
            });
        });

        // Evento para el botón de ayuda de Conocido
        document.getElementById('conocidoHelp').addEventListener('click', function() {
            showCustomAlertConocido();
            
            // Efecto al hacer clic
            this.style.transform = 'scale(0.8)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 200);
        });

        // Obtener referencias a los botones
        const c5Button = document.getElementById('c5Button');
        const cuadranteButton = document.getElementById('cuadranteButton');
        const extorsionButton = document.getElementById('extorsionButton');
        const conocidoButton = document.getElementById('conocidoButton');

        // Función para habilitar el botón C5
        function habilitarC5() {
            c5Button.disabled = false;
        }

        // Función para deshabilitar un botón y habilitar los demás
        function manejarEstadoBotones(botonPresionado) {
            // Deshabilitar el botón presionado
            botonPresionado.disabled = true;

            // Habilitar los demás botones
            if (botonPresionado !== c5Button) {
                c5Button.disabled = false;
            }
            if (botonPresionado !== cuadranteButton) {
                cuadranteButton.disabled = false;
            }
            if (botonPresionado !== extorsionButton) {
                extorsionButton.disabled = false;
            }
            if (botonPresionado !== conocidoButton) {
                conocidoButton.disabled = false;
            }
        }

        //--------------- Efecto Activar y Desactivar Botones Tipo de Emergencia ------------------------//

        // Función para manejar el estado de los botones
        function manejarEstadoBotones(botonPresionado) {
            // Restablecer todos los botones a su estado inicial
            c5Button.classList.remove('active');
            cuadranteButton.classList.remove('active');
            extorsionButton.classList.remove('active');
            conocidoButton.classList.remove('active');
            
            // Aplicar estilo activo solo al botón presionado
            botonPresionado.classList.add('active');
            
            // Habilitar todos los botones
            c5Button.disabled = false;
            cuadranteButton.disabled = false;
            extorsionButton.disabled = false;
            conocidoButton.disabled = false;
            
            // Deshabilitar el botón presionado
            botonPresionado.disabled = true;
        }

        // Modifica los eventos de clic de los botones para usar esta función
        c5Button.addEventListener('click', function() {
            manejarEstadoBotones(c5Button);
            // Mostrar el botón de ayuda con animación
            const helpContainer = document.getElementById('c5HelpContainer');
            helpContainer.style.display = 'flex';
            helpContainer.classList.add('show');
        });

        cuadranteButton.addEventListener('click', function() {
            manejarEstadoBotones(cuadranteButton);
            // Mostrar el botón de ayuda con animación
            const helpContainer = document.getElementById('cuadranteHelpContainer');
            helpContainer.style.display = 'flex';
            helpContainer.classList.add('show');
        });

        extorsionButton.addEventListener('click', function() {
            manejarEstadoBotones(extorsionButton);
            // Mostrar el botón de ayuda con animación
            const helpContainer = document.getElementById('extorsionHelpContainer');
            helpContainer.style.display = 'flex';
            helpContainer.classList.add('show');
        });

        conocidoButton.addEventListener('click', function() {
            manejarEstadoBotones(conocidoButton);
            // Mostrar el botón de ayuda con animación
            const helpContainer = document.getElementById('conocidoHelpContainer');
            helpContainer.style.display = 'flex';
            helpContainer.classList.add('show');
        });

        // Al cargar la página, activar el botón C5
        document.addEventListener('DOMContentLoaded', function() {
            // Activar el botón C5 al inicio
            c5Button.classList.add('active');
            c5Button.disabled = true;
            
            // Mostrar el contenedor de ayuda del C5
            document.getElementById('c5HelpContainer').style.display = 'flex';
            
            // Configurar el estado inicial de los otros botones
            cuadranteButton.classList.remove('active');
            extorsionButton.classList.remove('active');
            conocidoButton.classList.remove('active');
            cuadranteButton.disabled = false;
            extorsionButton.disabled = false;
            conocidoButton.disabled = false;
            
            // Configurar los botones de emergencia correspondientes
            document.getElementById('emergencyButtonContainer').style.display = 'block';
            document.getElementById('emergencyCuadranteButtonContainer').style.display = 'none';
            document.getElementById('emergencyExtorsionButtonContainer').style.display = 'none';
            document.getElementById('emergencyConocidoButtonContainer').style.display = 'none';
        });


        //----------------- Evento para el botón C5 ----------------------------------------------------//
        
        document.getElementById('c5Button').addEventListener('click', function () {
            // Restablecer el botón de emergencia
            document.getElementById('emergencyButtonContainer').style.display = 'block'; // Mostrar el botón de emergencia original
            document.getElementById('emergencyCuadranteButtonContainer').style.display = 'none'; // Ocultar el botón de emergencia cuadrante
            document.getElementById('emergencyExtorsionButtonContainer').style.display = 'none'; // Ocultar el botón de emergencia extorsión
            document.getElementById('emergencyConocidoButtonContainer').style.display = 'none'; // Ocultar el botón de emergencia conocido

            // Habilitar los botones deshabilitados
            document.getElementById('cuadranteButton').disabled = false;
            document.getElementById('extorsionButton').disabled = false;
            document.getElementById('conocidoButton').disabled = false;

            // Deshabilitar el botón C5
            this.disabled = true;
        });

        document.getElementById('cuadranteButton').addEventListener('click', function () {
            // Ocultar el botón de emergencia
            document.getElementById('emergencyButtonContainer').style.display = 'none';
            document.getElementById('emergencyExtorsionButtonContainer').style.display = 'none'; // Ocultar el botón de emergencia extorsión
            document.getElementById('emergencyConocidoButtonContainer').style.display = 'none'; // Ocultar el botón de emergencia conocido
            // Mostrar el botón EmergenciaCuadrante
            document.getElementById('emergencyCuadranteButtonContainer').style.display = 'flex';
            
            // Deshabilitar el botón Cuadrante
            this.disabled = true;
            
            // Habilitar los demás botones
            document.getElementById('c5Button').disabled = false;
            document.getElementById('extorsionButton').disabled = false;
            document.getElementById('conocidoButton').disabled = false;
        });

        // Evento para el botón "EmergenciaCuadrante"
        document.getElementById('emergencyCuadranteButtonContainer').addEventListener('click', function () {
            guardarRegistroActivacion('Emergencia Cuadrante');
            // Obtener la hora actual
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const timeString = `${hours}:${minutes}:${seconds}`;

            // Mostrar el mensaje con la hora de activación
            showCustomAlert(`Emergencia Cuadrante<br>Hora: ${timeString}`);
        });

        // Evento para el botón "Extorsión"
        document.getElementById('extorsionButton').addEventListener('click', function () {
            // Ocultar los botones de emergencia y emergencia cuadrante
            document.getElementById('emergencyButtonContainer').style.display = 'none';
            document.getElementById('emergencyCuadranteButtonContainer').style.display = 'none';
            document.getElementById('emergencyConocidoButtonContainer').style.display = 'none';
            // Mostrar el nuevo botón EmergenciaExtorsion
            document.getElementById('emergencyExtorsionButtonContainer').style.display = 'flex';
            
            // Deshabilitar el botón Extorsión
            this.disabled = true;
            
            // Habilitar los demás botones
            document.getElementById('c5Button').disabled = false;
            document.getElementById('cuadranteButton').disabled = false;
            document.getElementById('conocidoButton').disabled = false;
        });

        // Evento para el nuevo botón EmergenciaExtorsion
        document.getElementById('emergencyExtorsionButtonContainer').addEventListener('click', function () {
            guardarRegistroActivacion('Emergencia por Extorsión');
            // Obtener la hora actual
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const timeString = `${hours}:${minutes}:${seconds}`;

            // Aquí puedes agregar la lógica para manejar la emergencia por extorsión
            showCustomAlert(`Emergencia por Extorsión<br>Hora: ${timeString}`);
        });

        document.getElementById('conocidoButton').addEventListener('click', function () {
            // Ocultar los botones de emergencia, emergencia cuadrante y extorsión
            document.getElementById('emergencyButtonContainer').style.display = 'none';
            document.getElementById('emergencyCuadranteButtonContainer').style.display = 'none';
            document.getElementById('emergencyExtorsionButtonContainer').style.display = 'none';
            
            // Mostrar el nuevo botón EmergenciaConocido
            document.getElementById('emergencyConocidoButtonContainer').style.display = 'flex';
            
            // Deshabilitar el botón Conocido
            this.disabled = true;
            
            // Habilitar los demás botones
            document.getElementById('c5Button').disabled = false;
            document.getElementById('cuadranteButton').disabled = false;
            document.getElementById('extorsionButton').disabled = false;
        });

        // Evento para el nuevo botón EmergenciaConocido
        document.getElementById('emergencyConocidoButtonContainer').addEventListener('click', function () {
            guardarRegistroActivacion('Emergencia a Conocido');
            // Obtener la hora actual
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const timeString = `${hours}:${minutes}:${seconds}`;

            // Aquí puedes agregar la lógica para manejar la emergencia por conocido
            showCustomAlert(`Emergencia a Conocido <br>Hora: ${timeString}`);
        });

        // Guardar el teléfono de cuadrante en localStorage
        document.getElementById('modifyTelCuadranteButton').addEventListener('click', function () {
            // const newTelCuadrante = prompt("Ingresa el número de teléfono para Cuadrante:");
            if (newTelCuadrante) {
                localStorage.setItem('telCuadrante', newTelCuadrante);
                showCustomAlert("Teléfono de Cuadrante guardado exitosamente.", 'success');
            } else {
                showCustomAlert("Ingresa un número de teléfono válido.");
            }
        });

        // Guardar el teléfono de extorsión en localStorage
        document.getElementById('modifyTelExtorsionButton').addEventListener('click', function () {
            //const newTelExtorsion = prompt("Ingresa el número de teléfono para Extorsión:");
            if (newTelExtorsion) {
                localStorage.setItem('telExtorsion', newTelExtorsion);
                showCustomAlert("Teléfono de Extorsión guardado exitosamente.", 'success');
            } else {
                showCustomAlert("Ingresa un número de teléfono válido.");
            }
        });

        // Guardar el teléfono de conocido en localStorage
        document.getElementById('modifyTelConocidoButton').addEventListener('click', function () {
            //const newTelConocido = prompt("Ingresa el número de teléfono para Conocido:");
            if (newTelConocido) {
                localStorage.setItem('telConocido', newTelConocido);
                showCustomAlert("Teléfono de Conocido guardado exitosamente.", 'success');
            } else {
                showCustomAlert("Ingresa un número de teléfono válido.");
            }
        });

        // Cargar los números de teléfono desde localStorage al cargar la página
        window.addEventListener('load', function () {
            const savedTelCuadrante = localStorage.getItem('telCuadrante');
            const savedTelExtorsion = localStorage.getItem('telExtorsion');
            const savedTelConocido = localStorage.getItem('telConocido');

            if (savedTelCuadrante) {
                console.log("Teléfono de Cuadrante cargado:", savedTelCuadrante);
            }
            if (savedTelExtorsion) {
                console.log("Teléfono de Extorsión cargado:", savedTelExtorsion);
            }
            if (savedTelConocido) {
                console.log("Teléfono de Conocido cargado:", savedTelConocido);
            }
        });

        // Aquí se configuran los botones para que cuando se opriman se realice la llamada telefónica -----

        // Función para vibrar el dispositivo
        function vibrateLong() {
            // Verificar si el navegador soporta la API de vibración
            if ("vibrate" in navigator) {
                // Vibrar por 500ms (vibración larga)
                navigator.vibrate(500);
            }
        }

        // Función para mostrar el cuadro de diálogo para modificar el teléfono de cuadrante
        function showCustomTelCuadranteInput() {
            const customTelCuadranteInput = document.getElementById('customTelCuadranteInput');
            const overlay = document.getElementById('overlay');
            
            // Cargar el teléfono guardado si existe
            const savedTel = localStorage.getItem('telCuadrante');
            if (savedTel) {
                document.getElementById('newTelCuadranteInput').value = formatPhoneNumber(savedTel);
                document.getElementById('telCuadranteCharCounter').textContent = `${savedTel.length}/10`;
            } else {
                document.getElementById('newTelCuadranteInput').value = '';
                document.getElementById('telCuadranteCharCounter').textContent = '0/10';
            }
            
            customTelCuadranteInput.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Función para ocultar el cuadro de diálogo para modificar el teléfono de cuadrante
        function hideCustomTelCuadranteInput() {
            const customTelCuadranteInput = document.getElementById('customTelCuadranteInput');
            const overlay = document.getElementById('overlay');
            customTelCuadranteInput.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Evento para el botón "Guardar" del cuadro de diálogo para modificar el teléfono de cuadrante
        // Modificar las funciones de guardado para validar que sean exactamente 10 dígitos
        document.getElementById('telCuadranteSubmitButton').addEventListener('click', function () {
            const newTelCuadrante = document.getElementById('newTelCuadranteInput').value;
            if (newTelCuadrante && newTelCuadrante.length === 10 && /^\d+$/.test(newTelCuadrante)) {
                localStorage.setItem('telCuadrante', newTelCuadrante);
                hideCustomTelCuadranteInput();
                showCustomAlert("Teléfono de Cuadrante guardado exitosamente.", 'success');
            } else {
                showCustomAlert("Ingresa un número de teléfono válido de 10 dígitos.");
            }
        });

        // Evento para el botón "Cancelar" del cuadro de diálogo para modificar el teléfono de cuadrante
        document.getElementById('telCuadranteCancelButton').addEventListener('click', function () {
            hideCustomTelCuadranteInput();
        });

        // Evento para el botón "Tel Cuadrante"
        document.getElementById('modifyTelCuadranteButton').addEventListener('click', function () {
            showCustomTelCuadranteInput("");
        });

       // Evento para el botón "EmergenciaCuadrante"
        document.getElementById('emergencyCuadranteButtonContainer').addEventListener('click', function () {
            const telCuadrante = localStorage.getItem('telCuadrante');
            if (telCuadrante && telCuadrante.length === 10 && /^\d+$/.test(telCuadrante)) {
                vibrateLong(); // Vibración larga antes de la llamada
                window.location.href = `tel:${telCuadrante}`;
            } else {
                showCustomAlert("No hay un número de teléfono de Cuadrante guardado o no es válido.");
            }
        });

        // Mostrar el cuadro de diálogo para ingresar el número de teléfono de extorsión
        document.getElementById('modifyTelExtorsionButton').addEventListener('click', function () {
            showCustomTelExtorsionInput();
        });

        // Función para mostrar el cuadro de diálogo de teléfono de extorsión
        function showCustomTelExtorsionInput() {
            const customTelExtorsionInput = document.getElementById('customTelExtorsionInput');
            const overlay = document.getElementById('overlay');
            
            // Cargar el teléfono guardado si existe
            const savedTel = localStorage.getItem('telExtorsion');
            if (savedTel) {
                document.getElementById('newTelExtorsionInput').value = formatPhoneNumber(savedTel);
                document.getElementById('telExtorsionCharCounter').textContent = `${savedTel.length}/10`;
            } else {
                document.getElementById('newTelExtorsionInput').value = '';
                document.getElementById('telExtorsionCharCounter').textContent = '0/10';
            }
            
            customTelExtorsionInput.style.display = 'block';
            overlay.style.display = 'block';
        }


        // Función para ocultar el cuadro de diálogo de teléfono de extorsión
        function hideCustomTelExtorsionInput() {
            const customTelExtorsionInput = document.getElementById('customTelExtorsionInput');
            const overlay = document.getElementById('overlay');
            customTelExtorsionInput.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Guardar el número de teléfono de extorsión en localStorage
        document.getElementById('telExtorsionSubmitButton').addEventListener('click', function () {
            const newTelExtorsion = document.getElementById('newTelExtorsionInput').value;
            if (newTelExtorsion && newTelExtorsion.length === 10 && /^\d+$/.test(newTelExtorsion)) {
                localStorage.setItem('telExtorsion', newTelExtorsion);
                hideCustomTelExtorsionInput();
                showCustomAlert("Teléfono de Extorsión guardado exitosamente.", 'success');
            } else {
                showCustomAlert("Ingresa un número de teléfono válido de 10 dígitos.");
            }
        });

        // Cancelar la edición del número de teléfono de extorsión
        document.getElementById('telExtorsionCancelButton').addEventListener('click', function () {
            hideCustomTelExtorsionInput();
        });

        // Realizar la llamada cuando se pulse el botón "EmergenciaExtorsión"
        document.getElementById('emergencyExtorsionButtonContainer').addEventListener('click', function () {
            const telExtorsion = localStorage.getItem('telExtorsion');
            if (telExtorsion && telExtorsion.length === 10 && /^\d+$/.test(telExtorsion)) {
                vibrateLong(); // Vibración larga antes de la llamada
                window.location.href = `tel:${telExtorsion}`;
            } else {
                showCustomAlert("No se ha configurado un número de teléfono para extorsión o no es válido.");
            }
        });

        // Evento para el botón "Tel Conocido"
        document.getElementById('modifyTelConocidoButton').addEventListener('click', function () {
                    showCustomTelConocidoInput();
        });

        // Función para mostrar el cuadro de diálogo para modificar el teléfono de conocido
        function showCustomTelConocidoInput() {
            const customTelConocidoInput = document.getElementById('customTelConocidoInput');
            const overlay = document.getElementById('overlay');
            
            // Cargar el teléfono guardado si existe
            const savedTel = localStorage.getItem('telConocido');
            if (savedTel) {
                document.getElementById('newTelConocidoInput').value = formatPhoneNumber(savedTel);
                document.getElementById('telConocidoCharCounter').textContent = `${savedTel.length}/10`;
            } else {
                document.getElementById('newTelConocidoInput').value = '';
                document.getElementById('telConocidoCharCounter').textContent = '0/10';
            }
            
            customTelConocidoInput.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Función para ocultar el cuadro de diálogo para modificar el teléfono de conocido
        function hideCustomTelConocidoInput() {
            const customTelConocidoInput = document.getElementById('customTelConocidoInput');
            const overlay = document.getElementById('overlay');
            customTelConocidoInput.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Evento para el botón "Guardar" del cuadro de diálogo para modificar el teléfono de conocido
        document.getElementById('telConocidoSubmitButton').addEventListener('click', function () {
            const newTelConocido = document.getElementById('newTelConocidoInput').value;
            if (newTelConocido && newTelConocido.length === 10 && /^\d+$/.test(newTelConocido)) {
                localStorage.setItem('telConocido', newTelConocido);
                hideCustomTelConocidoInput();
                showCustomAlert("Teléfono de Conocido guardado exitosamente.", 'success');
            } else {
                showCustomAlert("Ingresa un número de teléfono válido de 10 dígitos.");
            }
        });

        // Evento para el botón "Cancelar" del cuadro de diálogo para modificar el teléfono de conocido
        document.getElementById('telConocidoCancelButton').addEventListener('click', function () {
            hideCustomTelConocidoInput();
        });

        // Evento para el botón "EmergenciaConocido"
        document.getElementById('emergencyConocidoButtonContainer').addEventListener('click', function () {
            const telConocido = localStorage.getItem('telConocido');
            if (telConocido && telConocido.length === 10 && /^\d+$/.test(telConocido)) {
                vibrateLong(); // Vibración larga antes de la llamada
                window.location.href = `tel:${telConocido}`;
            } else {
                showCustomAlert("No se ha configurado un número de teléfono para Conocido o no es válido.");
            }
        });

        // Función para manejar el conteo de caracteres en los inputs de teléfono
        function setupPhoneInputCounter(inputId, counterId) {
            const input = document.getElementById(inputId);
            const counter = document.getElementById(counterId);
            
            input.addEventListener('input', function() {
                const currentLength = this.value.length;
                counter.textContent = `${currentLength}/10`;
                
                // Validar que solo sean números
                this.value = this.value.replace(/\D/g, '');
                
                // Resaltar en rojo si no tiene 10 dígitos
                if (currentLength !== 10) {
                    this.style.borderColor = '#ff0000';
                    this.style.boxShadow = '0 0 5px #ff0000';
                } else {
                    this.style.borderColor = ''; // Restaurar color original
                    this.style.boxShadow = ''; // Restaurar sombra original
                }
            });
            
            // Validar también al pegar texto
            input.addEventListener('paste', function(e) {
                setTimeout(() => {
                    this.value = this.value.replace(/\D/g, '');
                    const currentLength = this.value.length;
                    counter.textContent = `${currentLength}/10`;
                }, 0);
            });
        }

        // Configurar los contadores para cada input de teléfono
        setupPhoneInputCounter('newTelCuadranteInput', 'telCuadranteCharCounter');
        setupPhoneInputCounter('newTelExtorsionInput', 'telExtorsionCharCounter');
        setupPhoneInputCounter('newTelConocidoInput', 'telConocidoCharCounter');
//------------------------------------ M E N U -------------------------------------------------------//
        // Función para mostrar/ocultar el menú
        function toggleMenu() {
            const menuOptions = document.getElementById('menuOptions');
            const menuOverlay = document.getElementById('menuOverlay');
            if (menuOptions.style.display === 'block') {
                menuOptions.style.display = 'none';
                menuOverlay.style.display = 'none'; // Ocultar el overlay
            } else {
                menuOptions.style.display = 'block';
                menuOverlay.style.display = 'block'; // Mostrar el overlay
            }
        }

        // Cerrar el menú si se hace clic fuera de él
        document.addEventListener('click', function(event) {
            const hamburgerMenu = document.getElementById('hamburgerMenu');
            const menuOptions = document.getElementById('menuOptions');
            const menuOverlay = document.getElementById('menuOverlay');
            if (!hamburgerMenu.contains(event.target)) {
                menuOptions.style.display = 'none';
                menuOverlay.style.display = 'none'; // Ocultar el overlay
            }
        });

        // Agregar eventos a los elementos del menú para ocultarlo al seleccionar una opción
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function() {
                toggleMenu(); // Ocultar el menú al seleccionar una opción
            });
        });

        // Función para guardar un registro de activación
        function guardarRegistroActivacion(tipoEmergencia) {
            const now = new Date();
            const fecha = now.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: '2-digit', day: '2-digit' });
            const horas = String(now.getHours()).padStart(2, '0');
            const minutos = String(now.getMinutes()).padStart(2, '0');
            const segundos = String(now.getSeconds()).padStart(2, '0');
            const registro = {
                tipo: tipoEmergencia,
                hora: `${horas}:${minutos}:${segundos}`,
                fecha: fecha
            };

            // Obtener los registros existentes o inicializar un array vacío
            const registros = JSON.parse(localStorage.getItem('registrosActivacion')) || [];
            registros.push(registro);

            // Guardar los registros actualizados en localStorage
            localStorage.setItem('registrosActivacion', JSON.stringify(registros));

            // Actualizar la lista de registros en la interfaz
            actualizarListaRegistros();
        }

        // Función para agrupar registros por día
        function agruparRegistrosPorDia(registros) {
            return registros.reduce((acc, registro) => {
                const fecha = registro.fecha;
                if (!acc[fecha]) {
                    acc[fecha] = [];
                }
                acc[fecha].push(registro);
                return acc;
            }, {});
        }

        document.getElementById('toggleRegistrosButton').addEventListener('click', function () {
            const registrosTitulo = document.getElementById('registrosTitulo');
            const registrosContainer = document.getElementById('registrosActivacion');
            const registrosOverlay = document.getElementById('registrosOverlay');
            
            if (registrosContainer.style.display === 'none' || registrosContainer.style.display === '') {
                registrosTitulo.style.display = 'flex';
                registrosContainer.style.display = 'block';
                registrosOverlay.style.display = 'block';
                this.textContent = '×';
            } else {
                registrosTitulo.style.display = 'none';
                registrosContainer.style.display = 'none';
                registrosOverlay.style.display = 'none';
                this.textContent = '≡';
            }
        });

        document.getElementById('closeRegistrosButton').addEventListener('click', function () {
            const registrosTitulo = document.getElementById('registrosTitulo');
            const registrosContainer = document.getElementById('registrosActivacion');
            const registrosOverlay = document.getElementById('registrosOverlay');
            
            registrosTitulo.style.display = 'none';
            registrosContainer.style.display = 'none';
            registrosOverlay.style.display = 'none';
            document.getElementById('toggleRegistrosButton').textContent = '≡';
        });

        function actualizarListaRegistros() {
            const listaRegistros = document.getElementById('listaRegistros');
            listaRegistros.innerHTML = ''; // Limpiar la lista actual

            // Obtener los registros de localStorage
            const registros = JSON.parse(localStorage.getItem('registrosActivacion')) || [];

            // Agrupar los registros por día
            const registrosPorDia = agruparRegistrosPorDia(registros);

            // Obtener la fecha actual
            const now = new Date();
            const fechaHoy = now.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: '2-digit', day: '2-digit' });

            // Convertir las fechas a objetos Date para poder ordenarlas
            const fechasOrdenadas = Object.keys(registrosPorDia)
                .map(fechaStr => {
                    // Convertir la cadena de fecha a objeto Date
                    const partes = fechaStr.split(', ');
                    if (partes.length === 2) {
                        const [diaSemana, resto] = partes;
                        const [dia, mes, año] = resto.split('/');
                        return new Date(`${mes}/${dia}/${año}`);
                    }
                    return new Date(); // Si el formato no es el esperado, usar fecha actual
                })
                .sort((a, b) => b - a); // Ordenar de más reciente a más antiguo

            // Mostrar los registros ordenados por fecha
            fechasOrdenadas.forEach(fechaObj => {
                const fechaStr = fechaObj.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: '2-digit', day: '2-digit' });
                
                if (registrosPorDia[fechaStr]) {
                    const liFecha = document.createElement('li');
                    liFecha.textContent = fechaStr === fechaHoy ? "Hoy" : fechaStr;
                    liFecha.style.fontWeight = 'bold';
                    liFecha.style.marginTop = '10px';
                    listaRegistros.appendChild(liFecha);

                    // Ordenar los registros del día por hora (de mayor a menor)
                    registrosPorDia[fechaStr].sort((a, b) => {
                        const horaA = a.hora.split(':').join('');
                        const horaB = b.hora.split(':').join('');
                        return horaB.localeCompare(horaA);
                    });

                    // Mostrar cada registro en la lista
                    registrosPorDia[fechaStr].forEach(registro => {
                        const li = document.createElement('li');
                        li.textContent = `${registro.tipo} - ${registro.hora}`;
                        li.style.marginLeft = '20px';

                        // Aplicar clases según el tipo de registro
                        switch (registro.tipo) {
                            case 'Emergencia Negocio':
                                li.classList.add('emergencia-negocio');
                                break;
                            case 'Emergencia por Extorsión':
                                li.classList.add('emergencia-extorsion');
                                break;
                            case 'Emergencia Cuadrante':
                                li.classList.add('emergencia-cuadrante');
                                break;
                            case 'Emergencia a Conocido':
                                li.classList.add('emergencia-conocido');
                                break;
                        }

                        listaRegistros.appendChild(li);
                    });
                }
            });
        }

        // Llamar a esta función al cargar la página para mostrar los registros existentes
        window.addEventListener('load', actualizarListaRegistros);

        //--------------- G R A F I C A S de dona --------------------------------------------------------------------- 

        // Función para mostrar/ocultar el contenedor de gráficas
        document.getElementById('toggleRegistrosButton').addEventListener('click', function() {

                const graficasContainer = document.getElementById('graficasContainer');
                const graficasOverlay = document.getElementById('graficasOverlay');
                
                if (graficasContainer.style.display === 'none' || graficasContainer.style.display === '') {
                    graficasContainer.style.display = 'block';
                    graficasOverlay.style.display = 'none';
                    actualizarGraficas();
                } else {
                    graficasContainer.style.display = 'none';
                    graficasOverlay.style.display = 'none';
                }
        })

        // Función para cerrar el contenedor de gráficas
        document.getElementById(/*'cerrarGraficasButton'*/'closeRegistrosButton').addEventListener('click', function () {
                const graficasContainer = document.getElementById('graficasContainer');
                const registrosOverlay = document.getElementById('registrosOverlay');
                graficasContainer.style.display = 'none';
                registrosOverlay.style.display = 'none';
        });

        // Variables para almacenar las instancias de Chart
        let chartNegocio, chartCuadrante, chartExtorsion, chartConocido;

        // Función para calcular porcentajes y conteos
        function calcularPorcentajes() {
        const registros = JSON.parse(localStorage.getItem('registrosActivacion')) || [];
        
            const conteo = {
                negocio: 0,
                cuadrante: 0,
                extorsion: 0,
                conocido: 0
            };
            
            registros.forEach(registro => {
                if (registro.tipo === 'Emergencia Negocio') conteo.negocio++;
                else if (registro.tipo === 'Emergencia Cuadrante') conteo.cuadrante++;
                else if (registro.tipo === 'Emergencia por Extorsión') conteo.extorsion++;
                else if (registro.tipo === 'Emergencia a Conocido') conteo.conocido++;
            });
            
            const total = conteo.negocio + conteo.cuadrante + conteo.extorsion + conteo.conocido;
            
            return {
                negocio: total > 0 ? Math.round((conteo.negocio / total * 100)) : 0,
                cuadrante: total > 0 ? Math.round((conteo.cuadrante / total * 100)) : 0,
                extorsion: total > 0 ? Math.round((conteo.extorsion / total * 100)) : 0,
                conocido: total > 0 ? Math.round((conteo.conocido / total * 100)) : 0,
                total: total,
                conteo: conteo
            };
        }
            
        // Función para crear/actualizar las gráficas
        function actualizarGraficas() {
            const data = calcularPorcentajes();
            const porcentajes = data;
            const conteo = data.conteo;
        
            // Actualizar los porcentajes y conteos
            document.getElementById('porcentajeNegocio').textContent = `${porcentajes.negocio}%`;
            document.getElementById('porcentajeCuadrante').textContent = `${porcentajes.cuadrante}%`;
            document.getElementById('porcentajeExtorsion').textContent = `${porcentajes.extorsion}%`;
            document.getElementById('porcentajeConocido').textContent = `${porcentajes.conocido}%`;
                
            document.getElementById('totalActivaciones').textContent = `Activaciones: ${porcentajes.total}`;    
                
            // Configuración común para las gráficas
            const config = {
                type: 'doughnut',
                    options: {
                        cutout: '70%',
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                enabled: false
                            }
                        },
                        animation: {
                            animateScale: true,
                            animateRotate: true,
                            duration: 1000
                        },
                        responsive: true,
                        maintainAspectRatio: false,
                        events: ['mousemove', 'mouseout', 'click', 'touchstart', 'touchmove']
                    }
            };    
                
            // Destruir gráficas existentes si existen
            if (chartNegocio) chartNegocio.destroy();
                if (chartCuadrante) chartCuadrante.destroy();
                if (chartExtorsion) chartExtorsion.destroy();
                if (chartConocido) chartConocido.destroy();
                
            // Gráfica de Negocio
            const donaNegocio = document.getElementById('donaNegocio').getContext('2d');
                chartNegocio = new Chart(donaNegocio, {
                    ...config,
                    data: {
                        datasets: [{
                            data: [porcentajes.negocio, 100 - porcentajes.negocio],
                            backgroundColor: [
                                'rgba(255, 0, 0, 0.8)',
                                'rgba(51, 51, 51, 0.3)'
                            ],
                            borderColor: [
                                'rgba(255, 0, 0, 1)',
                                'rgba(85, 85, 85, 0.5)'
                            ],
                            borderWidth: 2
                        }]
                    }
                });    
                
            // Gráfica de Cuadrante
            const donaCuadrante = document.getElementById('donaCuadrante').getContext('2d');
                chartCuadrante = new Chart(donaCuadrante, {
                    ...config,
                    data: {
                        datasets: [{
                            data: [porcentajes.cuadrante, 100 - porcentajes.cuadrante],
                            backgroundColor: [
                                'rgba(0, 191, 255, 0.8)',
                                'rgba(51, 51, 51, 0.3)'
                            ],
                            borderColor: [
                                'rgba(0, 191, 255, 1)',
                                'rgba(85, 85, 85, 0.5)'
                            ],
                            borderWidth: 2
                        }]
                    }
                });    
                
            // Gráfica de Extorsión
            const donaExtorsion = document.getElementById('donaExtorsion').getContext('2d');
                chartExtorsion = new Chart(donaExtorsion, {
                    ...config,
                    data: {
                        datasets: [{
                            data: [porcentajes.extorsion, 100 - porcentajes.extorsion],
                            backgroundColor: [
                                'rgba(255, 215, 0, 0.8)',
                                'rgba(51, 51, 51, 0.3)'
                            ],
                            borderColor: [
                                'rgba(255, 255, 0, 1)',
                                'rgba(85, 85, 85, 0.5)'
                            ],
                            borderWidth: 2
                        }]
                    }
                });    
                
            // Gráfica de Conocido
            const donaConocido = document.getElementById('donaConocido').getContext('2d');
                chartConocido = new Chart(donaConocido, {
                    ...config,
                    data: {
                        datasets: [{
                            data: [porcentajes.conocido, 100 - porcentajes.conocido],
                            backgroundColor: [
                                'rgba(255, 105, 180, 0.8)',
                                'rgba(51, 51, 51, 0.3)'
                            ],
                            borderColor: [
                                'rgba(255, 105, 180, 1)',
                                'rgba(85, 85, 85, 0.5)'
                            ],
                            borderWidth: 2
                        }]
                    }
                });    

            // Agregar eventos hover y clic a los wrappers
            const wrappers = document.querySelectorAll('.dona-wrapper');
                wrappers.forEach(wrapper => {
                    // Eventos hover
                    wrapper.addEventListener('mouseenter', function() {
                        this.classList.add('active');
                    });
                    
                    wrapper.addEventListener('mouseleave', function() {
                        this.classList.remove('active');
                    });
                    
                    // Evento clic para mostrar información detallada
                    wrapper.addEventListener('click', function() {
                        // Obtener el tipo de emergencia según el wrapper
                        let tipoEmergencia = '';
                        let color = '';
                        
                        if (this.id === 'donaNegocioWrapper') {
                            tipoEmergencia = 'Emergencia Negocio';
                            color = '#ff5252';
                        } else if (this.id === 'donaCuadranteWrapper') {
                            tipoEmergencia = 'Emergencia Cuadrante';
                            color = '#00bfff';
                        } else if (this.id === 'donaExtorsionWrapper') {
                            tipoEmergencia = 'Emergencia Extorsion';
                            color = '#ffd700';
                        } else if (this.id === 'donaConocidoWrapper') {
                            tipoEmergencia = 'Emergencia Conocido';
                            color = '#ff69b4';
                        }
                        
                        // Obtener conteo y porcentaje
                        const conteo = data.conteo[tipoEmergencia.split(' ')[1].toLowerCase()] || 0;
                        const porcentaje = porcentajes[tipoEmergencia.split(' ')[1].toLowerCase()] || 0;
                        
                        // Crear o actualizar el tooltip
                        let tooltip = this.querySelector('.emergency-tooltip');
                        if (!tooltip) {
                            tooltip = document.createElement('div');
                            tooltip.className = 'emergency-tooltip';
                            this.appendChild(tooltip);
                        }
                        
                        // Estilizar y posicionar el tooltip
                        tooltip.innerHTML = `
                            <strong>${tipoEmergencia}</strong><br>
                            Activaciones: ${conteo}<br>
                            Porcentaje: ${porcentaje}%
                        `;
                        tooltip.style.display = 'block';
                        tooltip.style.position = 'absolute';
                        tooltip.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
                        tooltip.style.color = color;
                        tooltip.style.padding = '10px';
                        tooltip.style.borderRadius = '5px';
                        tooltip.style.border = `1px solid ${color}`;
                        tooltip.style.boxShadow = `0 0 10px ${color}`;
                        tooltip.style.zIndex = '1000';
                        tooltip.style.textAlign = 'center';
                        tooltip.style.textShadow = 'none';
                        tooltip.style.top = '50%';
                        tooltip.style.left = '50%';
                        tooltip.style.transform = 'translate(-50%, -50%)';
                        tooltip.style.width = '150px';
                        
                        // Ocultar el tooltip después de 3 segundos
                        setTimeout(() => {
                            tooltip.style.display = 'none';
                        }, 3000);
                    });
                });    
        }    
            
        // Actualizar gráficas cada vez que se guarda un nuevo registro
        function guardarRegistroActivacion(tipoEmergencia) {
            const now = new Date();
            const fecha = now.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: '2-digit', day: '2-digit' });
            const horas = String(now.getHours()).padStart(2, '0');
            const minutos = String(now.getMinutes()).padStart(2, '0');
            const segundos = String(now.getSeconds()).padStart(2, '0');
            const registro = {
                tipo: tipoEmergencia,
                hora: `${horas}:${minutos}:${segundos}`,
                fecha: fecha
            };

            const registros = JSON.parse(localStorage.getItem('registrosActivacion')) || [];
            registros.push(registro);
            localStorage.setItem('registrosActivacion', JSON.stringify(registros));

            actualizarListaRegistros();
                
            // Actualizar gráficas si están visibles
            if (document.getElementById('graficasContainer').style.display === 'block') {
                actualizarGraficas();
            }
        }    
            
        //------------ Vibración cuando se activa los botones de alerta -------------------------------------------------------

        // Verificar soporte de vibración
        function supportsVibration() {
            return 'vibrate' in navigator;
        }

        // Función para vibración corta (al presionar el botón)
        function vibrateShort() {
            if (supportsVibration()) {
                navigator.vibrate(100); // 100ms de vibración
            }
        }

        // Función para vibración larga (al confirmar el envío)
        function vibrateLong() {
            if (supportsVibration()) {
                navigator.vibrate(500); // 500ms de vibración
            }
        }

        //--------------------- EFECTO de HUMO blanco permanente ----------------------------------------------------
        class SmokeEffect {
            constructor(element) {
                this.element = element;
                this.originalText = '';
                this.init();
            }
            
            init() {
                this.applyEffect();
                this.setupObservers();
            }
            
            applyEffect() {
                this.originalText = this.element.textContent;
                this.element.innerHTML = '';
                
                // Dividir el texto en palabras y espacios
                const wordsAndSpaces = this.originalText.split(/(\s+)/);
                
                wordsAndSpaces.forEach(segment => {
                    if (segment === '') return;
                    
                    if (segment.match(/^\s+$/)) {
                        // Es un espacio (o múltiples espacios)
                        const space = document.createElement('span');
                        space.className = 'space';
                        // Mantener todos los caracteres de espacio (incluyendo múltiples espacios)
                        space.innerHTML = '&nbsp;'.repeat(segment.length);
                        this.element.appendChild(space);
                    } else {
                        // Es una palabra o caracter
                        for (let i = 0; i < segment.length; i++) {
                            const char = segment[i];
                            const letter = document.createElement('span');
                            letter.className = 'smoke-letter';
                            letter.textContent = char;
                            letter.addEventListener('click', () => this.animateLetter(letter));
                            this.element.appendChild(letter);
                        }
                    }
                });
            }
        
            animateLetter(letter) {
                letter.classList.add('fade-out');
                setTimeout(() => {
                    letter.classList.remove('fade-out');
                    // Resetear estilos después de la animación
                    setTimeout(() => {
                        letter.style.opacity = '';
                        letter.style.transform = '';
                        letter.style.filter = '';
                        letter.style.textShadow = '';
                    }, 100);
                }, 5000);
            }
            
            updateText(newText) {
                this.originalText = newText;
                this.applyEffect();
            }
            
            setupObservers() {
                // Observar cambios en el contenido del elemento
                const observer = new MutationObserver(() => {
                    if (this.element.textContent !== this.originalText) {
                        this.applyEffect();
                    }
                });
                
                observer.observe(this.element, {
                    childList: true,
                    characterData: true,
                    subtree: true
                });
            }
        }

        // Aplicar al cargar la página
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar efectos
            const giroEffect = new SmokeEffect(document.getElementById('giroNegocioText'));
            const nombreEffect = new SmokeEffect(document.getElementById('nombreNegocioText'));
            
            // Cargar valores guardados
            const savedGiro = localStorage.getItem('giroNegocio') || 'GIRO DEL NEGOCIO';
            const savedNombre = localStorage.getItem('nombreNegocio') || '"NOMBRE DEL NEGOCIO"';
            
            document.getElementById('giroNegocioText').textContent = savedGiro.toUpperCase();
            document.getElementById('nombreNegocioText').textContent = savedNombre.toUpperCase();
            
            // Reaplicar efectos después de cargar los valores
            giroEffect.updateText(savedGiro.toUpperCase());
            nombreEffect.updateText(savedNombre.toUpperCase());
            
            // Modificar funciones de guardado para mantener el efecto
            document.getElementById('giroSubmitButton')?.addEventListener('click', function() {
                const newGiro = document.getElementById('newGiroInput').value;
                if (newGiro) {
                    giroEffect.updateText(newGiro.toUpperCase());
                    localStorage.setItem('giroNegocio', newGiro);
                }
            });
            
            document.getElementById('nombreSubmitButton')?.addEventListener('click', function() {
                const newNombre = document.getElementById('newNombreInput').value;
                if (newNombre) {
                    const nombreConComillas = `"${newNombre}"`;
                    nombreEffect.updateText(nombreConComillas.toUpperCase());
                    localStorage.setItem('nombreNegocio', nombreConComillas);
                }
            });
        });

        // Función auxiliar para asegurar la compatibilidad
        function ensureSmokeEffect(element) {
            if (!element._smokeEffect) {
                element._smokeEffect = new SmokeEffect(element);
            }
            return element._smokeEffect;
        }

        ['giroNegocioText', 'nombreNegocioText'].forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                const originalTextContent = Object.getOwnPropertyDescriptor(Object.getPrototypeOf(element), 'textContent');
                
                if (originalTextContent) {
                    Object.defineProperty(element, 'textContent', {
                        get: originalTextContent.get,
                        set: function(newValue) {
                            originalTextContent.set.call(this, newValue);
                            ensureSmokeEffect(this).updateText(newValue);
                        },
                        configurable: true
                    });
                }
            }
        });

        //------------- M A P A  en el HTML ------------------------------------------------

        // Inicializar el mapa con opciones de zoom control zoom inicial 5
        var map = L.map('map', {
            center: [19.4326, -99.1332], // Ciudad de México
            zoom: 5,  // Comenzar con zoom 5
            zoomControl: false // Desactivamos el control por defecto para crearlo manualmente
        });

        // Añadir capa de OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Función para el efecto de zoom gradual
        function zoomGradual() {
            let zoomActual = 5;
            const zoomFinal = 16;
            const intervalo = setInterval(() => {
                if (zoomActual < zoomFinal) {
                    zoomActual++;
                    map.setZoom(zoomActual);
                } else {
                    clearInterval(intervalo);
                }
            }, 300); // Ajusta este valor para cambiar la velocidad del zoom (en milisegundos)
        }

        // Ejecutar el zoom gradual después de un pequeño retraso para que el mapa se cargue
        setTimeout(zoomGradual, 1000);
                // Añadir un marcador
            L.marker([19.4326, -99.1332]) //.addTo(map) //Deshabilite el .addTo(Map) para quitar el globo de ubicación de la CDMX que aparecia en el mapa
                //.bindPopup('Centro CDMX')
                //.openPopup();

        // Añadir control de zoom en posición personalizada
        L.control.zoom({
            position: 'topleft' // Puede ser 'topleft', 'topright', 'bottomleft' o 'bottomright'
        }).addTo(map);

    
        // Función para cambiar entre modo oscuro y normal
        document.getElementById('theme-toggle').addEventListener('click', function() {
            const mapContainer = document.getElementById('map-container');
            const isDarkMode = mapContainer.classList.toggle('dark-mode');
            
            // Guardar el estado en localStorage
            localStorage.setItem('mapTheme', isDarkMode ? 'dark' : 'light');
            
            // Resto del código existente...
            const elements = document.querySelectorAll('h1.giroNegocio, h1.nombreNegocio');
            
            elements.forEach(el => {
                // Estilos comunes para ambos modos
                el.style.fontWeight = '900';
                el.style.width = '100%';  // Ocupar todo el ancho disponible
                el.style.maxWidth = '900px'; // Ancho máximo para mejor legibilidad
                el.style.margin = '0 auto'; // Centrar el texto
                el.style.padding = '10px';
                el.style.boxSizing = 'border-box';
                
                if(isDarkMode) {
                    el.style.color = '#ffffff';
                    el.style.textShadow = '0 0 2px #ff0000, 0 0 4px #ff0000';
                    //el.style.backgroundColor = 'rgba(0, 0, 0, 0.5)'; // Fondo semitransparente para mejor contraste
                } else {
                    el.style.color = '#000000';
                    el.style.textShadow = '4px 4px 6px #ffd700, 2px 2px 6px #ffd700';
                    //el.style.backgroundColor = 'rgba(255, 255, 255, 0.7)'; // Fondo semitransparente para mejor contraste
                }
            });
            
            this.textContent = isDarkMode ? '☀️' : '🌙';
        });
    
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar el tema guardado o usar light mode por defecto
            const savedTheme = localStorage.getItem('mapTheme') || 'light';
            const mapContainer = document.getElementById('map-container');
            const themeToggle = document.getElementById('theme-toggle');
            
            if (savedTheme === 'dark') {
                mapContainer.classList.add('dark-mode');
                themeToggle.textContent = '☀️';
            } else {
                mapContainer.classList.remove('dark-mode');
                themeToggle.textContent = '🌙';
            }
            
            // Aplicar estilos según el tema
            const isDarkMode = mapContainer.classList.contains('dark-mode');
            const elements = document.querySelectorAll('h1.giroNegocio, h1.nombreNegocio');
            
            elements.forEach(el => {
                // Estilos comunes para ambos modos
                el.style.fontWeight = '900';
                el.style.width = '100%';
                el.style.maxWidth = '800px';
                el.style.margin = '0 auto';
                el.style.padding = '10px';
                el.style.boxSizing = 'border-box';
                
                if(isDarkMode) {
                    el.style.color = '#ffffff';
                    el.style.textShadow = '0 0 2px #ff0000, 0 0 4px #ff0000';
                    //el.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
                } else {
                    el.style.color = '#000000';
                    el.style.textShadow = '4px 4px 6px #ffd700, 2px 2px 6px #ffd700';
                    //el.style.backgroundColor = 'rgba(255, 255, 255, 0.7)';
                }
            });
        });

        // Prevenir el zoom con gestos de pellizco
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });

        document.addEventListener('gesturechange', function(e) {
            e.preventDefault();
        });

        document.addEventListener('gestureend', function(e) {
            e.preventDefault();
        });
        

        //--------- Variables para el marcador y la ubicación -------------------------------

        let ubicacionMarker = null;
        let ubicacionData = null;

        // Función para mostrar el formulario de ubicación
        function mostrarFormularioUbicacion() {
            const ubicacionFormContainer = document.getElementById('ubicacionFormContainer');
            const overlay = document.getElementById('registrosOverlay');
            
            ubicacionFormContainer.style.display = 'block';
            overlay.style.display = 'block';
            
            // Cargar datos guardados si existen
            const savedUbicacion = localStorage.getItem('ubicacionNegocio');
            if (savedUbicacion) {
                ubicacionData = JSON.parse(savedUbicacion);
                document.getElementById('calle').value = ubicacionData.calle;
                document.getElementById('noExt').value = ubicacionData.noExt;
                document.getElementById('noInt').value = ubicacionData.noInt || '';
                document.getElementById('colonia').value = ubicacionData.colonia;
                document.getElementById('codigoPostal').value = ubicacionData.codigoPostal;
                document.getElementById('alcaldia').value = ubicacionData.alcaldia;
                document.getElementById('ciudad').value = ubicacionData.ciudad;
                
                // Mostrar coordenadas si existen
                if (ubicacionData.lat && ubicacionData.lng) {
                    const coordenadasContainer = document.getElementById('coordenadasContainer');
                    const coordenadasText = document.getElementById('coordenadasText');
                    coordenadasText.textContent = `Latitud: ${ubicacionData.lat.toFixed(6)}\nLongitud: ${ubicacionData.lng.toFixed(6)}`;
                    coordenadasContainer.style.display = 'block';
                }
            }
        }

        // Función para ocultar el formulario de ubicación
        function ocultarFormularioUbicacion() {
            const ubicacionFormContainer = document.getElementById('ubicacionFormContainer');
            const overlay = document.getElementById('registrosOverlay');
            
            ubicacionFormContainer.style.display = 'none';
            registrosOverlay.style.display = 'none';
        }

        // Función para geocodificar la dirección (convertir dirección a coordenadas)
        async function geocodificarDireccion(direccionCompleta) {
            try {
                if (!validarDireccion(direccionCompleta)) {
                    return null;
                }

                // Mostrar el overlay con el loader
                document.getElementById('coordenadasOverlay_2').style.display = 'flex';
                
                const controller = new AbortController();
                const timeoutId = setTimeout(() => {
                    controller.abort();
                    document.getElementById('coordenadasOverlay_2').style.display = 'none';
                }, 10000); // 10 segundos timeout
                
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(direccionCompleta)}&addressdetails=1&limit=1`,
                    { signal: controller.signal }
                );
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    throw new Error(`Error HTTP: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data && data.length > 0) {
                    // Ocultar el loader
                    document.getElementById('coordenadasOverlay_2').style.display = 'none';
                    
                    // Mostrar el mensaje de coordenadas generadas
                    document.getElementById('coordenadasGeneradas').style.display = 'flex';
                    setTimeout(() => {
                        document.getElementById('coordenadasGeneradas').style.display = 'none';
                    }, 3000);
                    
                    return {
                        lat: parseFloat(data[0].lat),
                        lng: parseFloat(data[0].lon),
                        direccionEncontrada: data[0].display_name
                    };
                } else {
                    document.getElementById('coordenadasOverlay_2').style.display = 'none';
                    showCoordenadasMessage3();
                    return null;
                }
            } catch (error) {
                console.error("Error en geocodificación:", error);
                document.getElementById('coordenadasOverlay_2').style.display = 'none';
                
                let mensajeError = "Error al buscar la ubicación";
                if (error.name === 'AbortError') {
                    mensajeError = "La búsqueda tardó demasiado. Verifique su conexión a internet.";
                } else if (error.message.includes("No se encontraron resultados")) {
                    mensajeError = error.message;
                }
                
                showCustomAlert(mensajeError);
                return null;
            }
        } 

        // Función mejorada para construir la dirección
        function construirDireccionCompleta() {
            const calle = document.getElementById('calle').value.trim();
            const noExt = document.getElementById('noExt').value.trim();
            const noInt = document.getElementById('noInt').value.trim();
            const colonia = document.getElementById('colonia').value.trim();
            const codigoPostal = document.getElementById('codigoPostal').value.trim();
            const alcaldia = document.getElementById('alcaldia').value.trim();
            const ciudad = document.getElementById('ciudad').value.trim();

            // Construir dirección en formato estándar
            let direccion = `${calle} ${noExt}`;
            if (noInt) direccion += ` Interior ${noInt}`;
            direccion += `, ${colonia}, ${alcaldia}, ${ciudad}`;
            
            return direccion;
        }

        // Evento submit mejorado
        document.getElementById('ubicacionForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!validarCamposUbicacion()) return;
            
            const direccionCompleta = construirDireccionCompleta();
            console.log("Dirección a geocodificar:", direccionCompleta);
            
            // Mostrar loader
            const loader = document.createElement('div');
            loader.className = 'loader';
            document.getElementById('ubicacionForm').appendChild(loader);
            
            const resultado = await geocodificarDireccion(direccionCompleta);
            
            // Ocultar loader
            document.getElementById('ubicacionForm').removeChild(loader);
            
            if (!resultado) {
                // Mostrar sugerencias para mejorar la dirección
                showCoordenadasMessage3();
                return;
            }
        
            // Mostrar resultados
            console.log("Resultado geocodificación:", resultado);
                
            // Actualizar datos de ubicación
            ubicacionData = {
                ...getFormData(),
                direccionCompleta,
                lat: resultado.lat,
                lng: resultado.lng,
                direccionEncontrada: resultado.direccionEncontrada
            };
                
            // Mostrar coordenadas
            document.getElementById('coordenadasText').textContent = 
                `Lat: ${resultado.lat.toFixed(6)}\nLon: ${resultado.lng.toFixed(6)}`;
            document.getElementById('coordenadasContainer').style.display = 'block';
                
            // Centrar mapa
            map.setView([resultado.lat, resultado.lng], 16);


            //-------- Overlay de Coordenadas Generadas ------//
            document.getElementById('coordenadasOverlay').style.display = 'flex';
            setTimeout(() => {
            document.getElementById('coordenadasOverlay').style.display = 'none';
            }, 3000); // Oculta el overlay después de 3 segundos
            document.getElementById('coordenadasGeneradas').addEventListener('click', function() {
            this.style.display = 'none';
            });
        });

        
        //-------------------MENSAJE DATOS INCORRECTOS O ERRONEOS---------------------------
        // Función para mostrar el mensaje de coordenadas no encontradas
        function showCoordenadasMessage3() {
            const coordenadasMessage3 = document.getElementById('coordenadasMessage3');
            const overlay = document.getElementById('coordenadasOverlay');
            
            coordenadasMessage3.style.display = 'flex';
            overlay.style.display = 'block';
        }

        // Función para ocultar el mensaje de coordenadas no encontradas
        function hideCoordenadasMessage3() {
            const coordenadasMessage3 = document.getElementById('coordenadasMessage3');
            const overlay = document.getElementById('coordenadasOverlay');
            
            coordenadasMessage3.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Evento para cerrar la alerta de Error de Datos de Ubicación
        document.getElementById('message3CloseButton').addEventListener('click', hideCoordenadasMessage3);

        //------------------------------------------------------------------------------//
        // Función para obtener datos del formulario
        function getFormData() {
            return {
                calle: document.getElementById('calle').value.trim(),
                noExt: document.getElementById('noExt').value.trim(),
                noInt: document.getElementById('noInt').value.trim(),
                colonia: document.getElementById('colonia').value.trim(),
                codigoPostal: document.getElementById('codigoPostal').value.trim(),
                alcaldia: document.getElementById('alcaldia').value.trim(),
                ciudad: document.getElementById('ciudad').value.trim()
            };
        }

        // Función de validación mejorada
        function validarCamposUbicacion() {
            const campos = [
                {id: 'calle', nombre: 'Calle'},
                {id: 'noExt', nombre: 'Número exterior'},
                {id: 'colonia', nombre: 'Colonia'},
                {id: 'codigoPostal', nombre: 'Código Postal'},
                {id: 'alcaldia', nombre: 'Alcaldía/Municipio'},
                {id: 'ciudad', nombre: 'Ciudad'}
            ];
            
            for (const campo of campos) {
                const valor = document.getElementById(campo.id).value.trim();
                if (!valor) {
                    showCustomAlert(`El campo ${campo.nombre} es obligatorio`);
                    document.getElementById(campo.id).focus();
                    return false;
                }
            }
            
            // Validar código postal (5 dígitos en México)
            const cp = document.getElementById('codigoPostal').value.trim();
            if (!/^\d{5}$/.test(cp)) {
                showCustomAlert("El Código Postal debe tener 5 dígitos");
                document.getElementById('codigoPostal').focus();
                return false;
            }
            
            return true;
        }

        // Evento para el botón "Mostrar Ubicación"
        document.getElementById('mostrarUbicacionButton').addEventListener('click', function() {
            if (!ubicacionData) return;
            
            // Mostrar el overlay con el loader (corresponde al boón Mostrar ubicación en Mapa)
            document.getElementById('coordenadasOverlay_2').style.display = 'flex';
            setTimeout(() => {
                document.getElementById('coordenadasOverlay_2').style.display = 'none';
            }, 3000);
            
            ubicacionFormContainer.style.display = 'none';
            registrosOverlay.style.display = 'none'; //oculta el overlay del Formulario de Ubicación

            // Actualizar el marcador en el mapa
            actualizarMarcadorUbicacion();
            
            // Guardar en localStorage
            localStorage.setItem('ubicacionNegocio', JSON.stringify(ubicacionData));
            
            // Mostrar mensaje de éxito
            //showCustomAlert("Ubicación guardada y mostrada en el mapa.", 'success');
        });

      
        // Función para actualizar el marcador de ubicación
        function actualizarMarcadorUbicacion() {
            // Eliminar el marcador existente si hay uno
            if (ubicacionMarker) {
                map.removeLayer(ubicacionMarker);
            }

            if (!ubicacionData) return;

            // Obtener el nombre del negocio para el popup
            const giroNegocio = localStorage.getItem('giroNegocio') || 'Giro';
            const nombreNegocio = localStorage.getItem('nombreNegocio') || 'Negocio';

            // Crear el contenido del popup
            const popupContent = `
                <b>${giroNegocio.replace(/"/g, '')}</b><br>
                <b>${nombreNegocio.replace(/"/g, '')}</b><br>
                ${ubicacionData.direccionCompleta}
            `;

            // Crear el marcador con estilo personalizado y hacerlo arrastrable
            ubicacionMarker = L.marker([ubicacionData.lat, ubicacionData.lng], {
                icon: L.divIcon({
                    className: 'ubicacion-marker',
                    iconSize: [22, 22],
                    popupAnchor: [0, -10]
                }),
                draggable: true
            }).addTo(map)
            .bindPopup(popupContent);

            // Evento cuando se termina de arrastrar el marcador
            ubicacionMarker.on('dragend', function(event) {
                const marker = event.target;
                const position = marker.getLatLng();
                
                // Actualizar las coordenadas en los datos
                ubicacionData.lat = position.lat;
                ubicacionData.lng = position.lng;
                
                // Vibración al soltar el marcador
                if (supportsVibration()) {
                    navigator.vibrate(100);
                }
                
                // Actualizar el texto de coordenadas
                document.getElementById('coordenadasText').textContent = 
                    `Lat: ${position.lat.toFixed(6)}\nLon: ${position.lng.toFixed(6)}`;
                
                // Guardar los cambios en localStorage
                localStorage.setItem('ubicacionNegocio', JSON.stringify(ubicacionData));
                
                // Mostrar mensaje de confirmación
                showCustomAlert("Ubicación actualizada", 'success');
            });

            // Centrar el mapa con zoom inicial más alejado (zoom 5)
            map.setView([ubicacionData.lat, ubicacionData.lng], 5);

            // Animación de acercamiento gradual
            setTimeout(() => {
                map.setView([ubicacionData.lat, ubicacionData.lng], 12);
                setTimeout(() => {
                    map.setView([ubicacionData.lat, ubicacionData.lng], 14);
                    setTimeout(() => {
                        // Centrar el mapa en el nivel de zoom 16
                        map.setView([ubicacionData.lat, ubicacionData.lng], 16, {
                            animate: true,
                            duration: 1
                        });
                        
                        // Desplazar el mapa 100 píxeles hacia arriba y 50 píxeles a la derecha después de un pequeño retraso
                        setTimeout(() => {
                            map.panBy([-40, 120], {  // Cambiado de [0, 120] a [50, 120] para desplazar 50px a la derecha
                                animate: true,
                                duration: 0.5
                            });
                            
                            // Mostrar el popup después de que termine toda la animación
                            setTimeout(() => {
                                ubicacionMarker.openPopup();

                                // Ocultar el popup después de 3 segundos
                                setTimeout(() => {
                                    if (ubicacionMarker.isPopupOpen()) {
                                        ubicacionMarker.closePopup();
                                    }
                                }, 3000);

                            }, 500);
                        }, 2000); // Retraso de 2 segundos después del centrado
                    }, 1000);
                }, 1000);
            }, 1000);

            // Eventos para el efecto de arrastre
            ubicacionMarker.on('dragstart', function() {
                this._icon.classList.add('dragging');
            });

            ubicacionMarker.on('dragend', function() {
                this._icon.classList.remove('dragging');
            });
        }

        // Evento para el botón "Cancelar" del formulario de ubicación
        document.getElementById('cancelarUbicacion').addEventListener('click', function() {
            ocultarFormularioUbicacion();
        });

        // Cargar ubicación guardada al iniciar la aplicación
        window.addEventListener('load', function() {
            const savedUbicacion = localStorage.getItem('ubicacionNegocio');
            if (savedUbicacion) {
                ubicacionData = JSON.parse(savedUbicacion);
                actualizarMarcadorUbicacion();
            }
        });

        // Función para editar la ubicación desde el menú
        function editarUbicacion() {
            const savedUbicacion = localStorage.getItem('ubicacionNegocio');
            if (savedUbicacion) {
                ubicacionData = JSON.parse(savedUbicacion);
                
                // Llenar el formulario con los datos existentes
                document.getElementById('calle').value = ubicacionData.calle;
                document.getElementById('noInt').value = ubicacionData.noInt || '';
                document.getElementById('noExt').value = ubicacionData.noExt;
                document.getElementById('colonia').value = ubicacionData.colonia;
                document.getElementById('codigoPostal').value = ubicacionData.codigoPostal;
                document.getElementById('alcaldia').value = ubicacionData.alcaldia;
                document.getElementById('ciudad').value = ubicacionData.ciudad;
                
                // Mostrar las coordenadas existentes
                const coordenadasContainer = document.getElementById('coordenadasContainer');
                const coordenadasText = document.getElementById('coordenadasText');
                coordenadasText.textContent = `Latitud: ${ubicacionData.lat.toFixed(6)}\nLongitud: ${ubicacionData.lng.toFixed(6)}`;
                coordenadasContainer.style.display = 'block';
                
                // Centrar el mapa en la ubicación guardada
                map.setView([ubicacionData.lat, ubicacionData.lng], 16);
            }
            
            mostrarFormularioUbicacion();
        }

        function validarDireccion(direccion) {
            if (!direccion || direccion.trim().length < 10) {
                showCustomAlert("La dirección es demasiado corta o no es válida");
                return false;
            }
            
            // Verificar que tenga al menos calle y número
            const partes = direccion.split(',');
            if (partes.length < 3) {
                showCustomAlert("La dirección debe incluir calle, número y colonia");
                return false;
            }
            
            return true;
        }

        //----- Para que el texto que se ingresa se transforme a Mayusculas en todos los inputs relevantes -----

        // Función para convertir texto a mayúsculas mientras se escribe
        function convertirAMayusculas(inputElement) {
            inputElement.addEventListener('input', function() {
                this.value = this.value.toUpperCase();
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Input de URL (Lo inhabilite porque los enlaces deben ir de forma literal)
            //convertirAMayusculas(document.getElementById('newUrlInput'));
            
            // Input de Giro del Negocio
            convertirAMayusculas(document.getElementById('newGiroInput'));
            
            // Input de Nombre del Negocio
            convertirAMayusculas(document.getElementById('newNombreInput'));
            
            // Inputs de teléfonos
            convertirAMayusculas(document.getElementById('newTelCuadranteInput'));
            convertirAMayusculas(document.getElementById('newTelExtorsionInput'));
            convertirAMayusculas(document.getElementById('newTelConocidoInput'));
            
            // Inputs de ubicación
            convertirAMayusculas(document.getElementById('calle'));
            convertirAMayusculas(document.getElementById('noExt'));
            convertirAMayusculas(document.getElementById('noInt'));
            convertirAMayusculas(document.getElementById('colonia'));
            convertirAMayusculas(document.getElementById('alcaldia'));
            convertirAMayusculas(document.getElementById('ciudad'));
        });
        
        // -------------- Evento para el botón de centrar mapa en el marcador -------------------------
        // Evento para el botón de centrar mapa en el marcador
        document.getElementById('center-map-button').addEventListener('click', function() {
    if (ubicacionMarker) {
        // Cerrar el popup si está abierto
        if (ubicacionMarker.isPopupOpen()) {
            ubicacionMarker.closePopup();
        }

        // Centrar el mapa en el marcador con zoom 16
        map.setView(ubicacionMarker.getLatLng(), 16, {
            animate: true,
            duration: 1
        });

        // Pequeño retraso para asegurar que el mapa se haya centrado
        setTimeout(() => {
            // Abrir el popup
            ubicacionMarker.openPopup();
            
            // Esperar a que el popup se renderice completamente
            setTimeout(() => {
                const popupElement = document.querySelector('.leaflet-popup-content-wrapper');
                if (popupElement) {
                    // Aplicar la animación
                    popupElement.classList.add('vibrating-popup');
                    
                    // Eliminar la clase después de que termine la animación
                    setTimeout(() => {
                        popupElement.classList.remove('vibrating-popup');
                    }, 500);
                    
                    // Cerrar el popup después de 3 segundos
                    setTimeout(() => {
                        if (ubicacionMarker.isPopupOpen()) {
                            ubicacionMarker.closePopup();
                        }
                    }, 3000);
                }
            }, 100);
        }, 300); // Tiempo para que el mapa termine de moverse

        // Vibración táctil
        if (supportsVibration()) {
            navigator.vibrate(100);
        }
    } else {
        showCustomAlert("No hay un marcador de ubicación establecido.");
    }
});

        //----------------------MODO OBSCURO del Botón Centrar el Mapa----------------------------------//
        const observer = new MutationObserver(() => {
            const isDark = document.getElementById('map-container').classList.contains('dark-mode');
            const btn = document.getElementById('center-map-button');
            if (isDark) {
                btn.style.background = 'rgba(0, 0, 0, 0.7)';
                btn.style.color = '#ffffff';
                btn.style.boxShadow = '0 0 5px rgba(255, 255, 255, 0.7)';
            } else {
                btn.style.background = 'rgba(255, 255, 255, 0.7)';
                btn.style.color = 'black';
                btn.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.7)';
            }
        });

        observer.observe(document.getElementById('map-container'), {
            attributes: true,
            attributeFilter: ['class']
        });

        //---------------- Poner ASTERISCOS para ocultar los números telefónicos ------------------------//
        function formatPhoneNumber(phoneNumber) {
            if (!phoneNumber) return '';
            // Mostrar solo los últimos 4 dígitos, el resto como asteriscos
            const visibleDigits = 4;
            const masked = phoneNumber.slice(0, -visibleDigits).replace(/./g, '*') + 
                        phoneNumber.slice(-visibleDigits);
            return masked;
        }

    </script>   
</body>
</html>
