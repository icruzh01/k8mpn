<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emergencia k8</title>
    <!-- Web App Manifest -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icons/favicon-32x32.png">
    <!-- Incluir jsQR desde un CDN -->
    <script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.min.js"></script>
    
    <!-- Incluir Chart.js desde un CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Meta tags para mejorar la experiencia -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Emergencia">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <!-- Estilos -->
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            background-color: #000000;
            font-family: Arial;
            position: relative;
        }

        /* Contenedor del fondo negro */
        #initialMessageContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgb(0, 0, 0);
            z-index: 1002;
        }

        /* Contenedor del contenido (texto y línea) */
        #initialMessageContent {
            position: absolute;
            font-family: sans-serif;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
            font-weight: 500;
            letter-spacing: 4px;
            min-height: auto;
            justify-content: center;
            align-items: center;
            font-size: 2.3rem;
            letter-spacing: 4px;
            z-index: 1000;
        }

        /* Animación para el contenido */
        @keyframes slideUpAndFade {
            0% {
                transform: translate(-50%, -50%);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -300%);
                opacity: 1;
            }
        }

        /* Clase para aplicar la animación */
        .slide-up-and-fade {
            animation: slideUpAndFade 1s forwards;
        }

        /* Resto de los estilos (mantén el resto del CSS sin cambios) */
        header {
            width: 100%;
            background-color: #000000;
            color: #b4b4b4;
            text-align: center;
            padding: 0;
        }
        
        header h1 {
            width: 100%;
            background-color: #000000;
            color: #b4b4b4;
            text-align: center;
            padding: 20px 0;
            margin: 0;
        }
        .codigos {
            margin-bottom: 10px;
            border: 0;
            height: 8px;
            width: 100%;
            background: linear-gradient(to right, #770000, #770000 41.33%, #770000 49.33%, #001eb4 53.33%, #001eb4 66.66%, #001eb4 100%);
            box-shadow: 0 0 5px #740000, 0 0 10px #740000, 0 0 20px #250000, 0 0 40px #00009b, 0 0 80px #00009b;
            animation: neon-blink 1s infinite;
            position: relative;
            overflow: hidden;
            border-radius: 50%;
            z-index: 1001;
        }

        /* Pseudo-elemento para el efecto de barra roja */
        .codigos::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 20%;
            height: 100%;
            background: linear-gradient(to right, transparent, #ff0000 50%, transparent);
            animation: move-red 1.5s infinite;
        }

        /* Pseudo-elemento para el efecto de barra azul */
        .codigos::after {
            content: '';
            position: absolute;
            top: 0;
            right: -100%;
            width: 20%;
            height: 100%;
            background: linear-gradient(to left, transparent, #00b7ff 50%, transparent);
            animation: move-blue 1.5s infinite;
        }

        /* Animación para mover la barra roja */
        @keyframes move-red {
            0% {
                left: 0%;
            }
            50% {
                left: 30%;
            }
            100% {
                left: 0%;
            }
        }

        /* Animación para mover la barra azul */
        @keyframes move-blue {
            0% {
                right: 0%;
            }
            50% {
                right: 30%;
            }
            100% {
                right: 0%;
            }
        }

        /* Animación de parpadeo neón */
        @keyframes neon-blink {
            0%, 60% {
                box-shadow: 0 0 2px #ff0000c0, 0 0 10px #ff0000c0, 0 0 20px #ff0000c0, 0 0 40px #ff0000c0, 0 0 80px #ff0000c0;
            }
            25%, 75% {
                box-shadow: 0 0 2px #000000, 0 0 10px #000000, 0 0 20px #000000, 0 0 40px #000000, 0 0 80px #000000;
            }
            100% {
                box-shadow: 0 0 2px #00b7ffc0, 0 0 10px #00b7ffc0, 0 0 20px #00b7ffc0, 0 0 40px #00b7ffc0, 0 0 80px #00b7ffc0;
            }
        }
        
        header h1.title_1 {
            padding: 0 0;
            font-family: sans-serif;
            text-transform:none;
            min-height: auto;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #b4b4b4;
            position: relative;
            font-weight: 500;
            font-size: 2.3rem;
            letter-spacing: 4px;
            z-index: 1000;
        }

        header h1.title_2 {
            margin: 0;
            margin-bottom: 150px;
            padding: 0 0;
            font-family: sans-serif;
            text-transform: lowercase;
            min-height: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #b4b4b4;
            position: relative;
            font-weight: 500;
            font-size: 2.3rem;
            letter-spacing: 4px;
            z-index: 1000; 
        }

        header h1.giroNegocio {
            margin: 0 0 0;
            padding: 0;
            font-size: 30px;
            color: #ffffff;
            margin-bottom: 10px;
        }

        header h1.nombreNegocio {
            margin: 0 0 0;
            padding: 0;
            font-size: 30px;
            color: #ffffff;
        }

        #emergencyButton {
            background-color: rgb(255, 0, 0);
            color: white;
            font-size: 20px;
            width: 150px;
            height: 150px;
            border: 15px solid #da2020;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
            box-sizing: border-box;
            margin: 40px;
            margin-bottom: 60px;
            animation: neon-color-change 2s infinite;
        }

        #emergencyButton:active, #emergencyButton.active {
            background-color: rgb(125, 2, 2);
            border-color: rgb(91, 67, 6);
            color: rgb(100, 101, 103);
            transform: scale(0.95);
        }

        @keyframes neon-color-change {
            0% {
                border-color: #fffb00;
                box-shadow: 0 0 10px #ff0000, 0 0 20px #ff0000, 0 0 40px #ff0000;
            }
            50% {
                border-color: #de9000;
                box-shadow: 0 0 10px #7b1300, 0 0 20px #7b1300, 0 0 40px #7b1300;
            }
            100% {
                border-color: #fffb00;
                box-shadow: 0 0 10px #ff0000, 0 0 20px #ff0000, 0 0 40px #ff0000;
            }
        }

        /*Oculte los botones URL, GIRO Y NOMBRE porque ya estan en el menu*/
        #modifyUrlButton, #modifyGiroButton, #modifyNombreButton {
            background-color: #000000;
            color: #7c7c7c;
            text-transform: uppercase;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 14px;
            width: 100px;
            height: 40px;
            border: 2px solid rgb(65, 61, 61);
            cursor: pointer;
            display: none; /*Le puse none para que no se vean los botones*/
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
            box-sizing: border-box;
            /*box-shadow: 3px 3px rgb(157, 151, 151); */
            position: absolute;
            bottom: 20px;
            left: 20px;
            margin: 0 0;
        }

        #modifyUrlButton:active, #modifyGiroButton:active, #modifyNombreButton:active {
            box-shadow: none;
            transform: translate(3px, 3px);
        }

        #modifyGiroButton {
            left: 130px;
        }

        #modifyNombreButton {
            left: 240px;
        }

        #modifyUrlButton:active, #modifyUrlButton.active, #modifyGiroButton:active, #modifyGiroButton.active, #modifyNombreButton:active, #modifyNombreButton.active {
            background-color: #1e90ff;
            border-color: #00bfff;
            transform: scale(0.95);
        }

        .custom-alert {
            display: none;
            position: fixed;
            width: 300px; /* Aumenta el ancho para mejor visualización */
            height: auto; /* Altura automática para adaptarse al contenido */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #837e7c;
            padding: 20px;
            color: #aaaaaa;
            box-shadow: 0 0 20px #ffffff;
            text-align: center;
            font-size: 20px;
            border-radius: 10px;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 15px; /* Espacio entre el texto y el botón */
            z-index: 1000;
        }

        #alertMessage {
            margin: 0; /* Elimina el margen predeterminado del párrafo */
            text-align: center;
            line-height: 1.5; /* Mejora la legibilidad del texto */
        }

        #alertCloseButton {
            background-color: #ff0000;
            color: #ffffff;
            padding: 10px 20px;
            border: 2px solid #ff0000;
            border-radius: 15px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            box-shadow: 0 0 10px #f80101;
            margin-top: 15px; /* Espacio adicional entre el texto y el botón */
        }

        #alertCloseButton:hover {
            background-color: #cc0000; /* Cambia el color de fondo al pasar el mouse */
            border: 2px solid #cc0000; /* Cambia el color del borde al pasar el mouse */
            box-shadow: 0 0 10px #cc0000; /* Cambia el color de la sombra al pasar el mouse */
        }

        #alertCloseButton:active {
            background-color: #990000; /* Cambia el color de fondo al hacer clic */
        }

        .custom-alert.confirmation {
            display: none;
            position: fixed;
            width: 250px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgb(0, 0, 0);
            border: 1px solid #3ea055;
            padding: 20px;
            color: rgb(207, 207, 207);
            box-shadow: 0px 0px 10px #02ff02;
            text-align: center;
            font-size: 20px;
            border-radius: 10px;
        }

        .custom-confirm {
            display: none;
            position: fixed;
            width: 230px;
            height: 130px;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #f70d1a;
            color: rgb(185, 185, 185);
            padding: 30px;
            box-shadow: 0 0 20px #ff0000;
            z-index: 1000;
            text-align: center;
            border-radius: 10px;
        }

        .custom-confirm p {
            margin: 0 0 20px;
            font-size: 18px;
        }

        .custom-confirm .button-container {
            display: flex;
            justify-content: center;
            gap: 40px;
        }

        .custom-confirm button {
            background-color: #000000;
            color: #ffffff;
            border: 2px solid #ff0000;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
            box-shadow: 0 0 10px #f8212c;
        }

        .custom-confirm button:hover {
            background-color: #000000;
            border: 3px solid #0095ff;
            box-shadow: 0 0 10px #0debf7;
        }

        #confirmNo {
            background-color: #000000;
            color: #ffffff;
            border: 2px solid #7a7a7a;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
            box-shadow: 0 0 10px #a4a3a3;
        }

        #confirmNo:hover {
            background-color: #000000;
            border: 3px solid #898989;
            box-shadow: 0 0 10px #ffffff;
        }

        .custom-url-input {
            position: relative; /* Asegura que el botón se posicione relativamente a este contenedor */
            display: none;
            position: fixed;
            width: 250px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #d4a017;
            padding: 20px;
            box-shadow: 0 0 20px #e8a317;
            z-index: 1000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            border-radius: 10px;
        }   

        #scanQRButton {
            position: absolute;
            right: 25px; /* Ajusta la posición a la derecha */
            top: 29%; /* Centra verticalmente */
            transform: translateY(-50%); /* Ajusta el centrado vertical */
            background-color: #000000;
            color: #d4a017;
            border: 0px solid #d4a017;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 15px;
            border-radius: 5px;
            z-index: 1001; /* Asegura que esté por encima del input */
        }

        #scanQRButton:hover {
            background-color: #d4a017;
            color: #000000;
        }

        .custom-url-input input {
            width: 90%;
            padding: 10px;
            margin-bottom: 7px;
            font-size: 16px;
            background: #ffe9bd;
            color: #000000;
            border: 1px solid #f5b104;
            box-shadow: 0 0 5px #e8a317;
            border-radius: 5px;
        }

        .custom-url-input input:hover {
            background: #000000;
            border: 0.5px solid #d4a017;
            color: #d4a017;
        }

        .custom-url-input input:focus {
            background: #000000;
            border: 0.5px solid #5cbd02;
            color: #d4a017;
        }

        .custom-url-input .button-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .custom-url-input .button-container button {
            background-color: #000000;
            color: white;
            border: 1px solid #d4a017;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
        }

        .custom-url-input .button-container button:hover {
            background-color: #000000;
            border: 2px solid #c20303;
            box-shadow: 0 0 10px #ff0000;
        }

        .custom-giro-input {
            display: none;
            position: fixed;
            width: 250px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #07edf5;
            padding: 20px;
            box-shadow: 0 0 20px #4ee2ec;
            z-index: 1000;
            text-align: center;
            border-radius: 10px;
        }

        .custom-giro-input input {
            width: 90%;
            padding: 10px;
            margin-bottom: 7px;
            font-size: 16px;
            background: #bbf9ff;
            color: #000000;
            border: 1px solid #07edf5;
            box-shadow: 0 0 5px #4ee2ec;
            border-radius: 5px;
        }

        .custom-giro-input input:hover {
            background: #000000;
            border: 0.5px solid #4ee2ec;
            color: #4ee2ec;
        }

        .custom-giro-input input:focus {
            background: #000000;
            border: 0.5px solid #5cbd02;
            color: #4ee2ec;
        }

        .custom-giro-input .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .custom-giro-input .button-container button {
            background-color: #000000;
            color: white;
            border: 1px solid #4ee2ec;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
        }

        .custom-giro-input .button-container button:hover {
            background-color: #000000;
            border: 2px solid #d7159d;
            box-shadow: 0 0 10px #ec4ebd;
        }

        .custom-nombre-input {
            display: none;
            position: fixed;
            width: 250px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #000000;
            border: 1px solid #f30086;
            padding: 20px;
            box-shadow: 0 0 20px #f507dd;
            z-index: 1000;
            text-align: center;
            border-radius: 10px;
        }

        .custom-nombre-input input {
            width: 90%;
            padding: 10px;
            margin-bottom: 7px;
            font-size: 16px;
            background: #ffb1f7;
            color: #000000;
            border: 1px solid #f507dd;
            box-shadow: 0 0 5px #f507dd;
            border-radius: 5px;
        }

        .custom-nombre-input input:hover {
            background: #000000;
            border: 0.5px solid #f507dd;
            color: #f507dd;
        }

        .custom-nombre-input input:focus {
            background: #000000;
            border: 0.5px solid #5cbd02;
            color: #f507dd;
        }

        .custom-nombre-input .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .custom-nombre-input .button-container button {
            background-color: #000000;
            color: white;
            border: 1px solid #f30086;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 15px;
        }

        .custom-nombre-input .button-container button:hover {
            background-color: #000000;
            border: 2px solid #027e94;
            box-shadow: 0 0 10px #00d9ff;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgb(0, 0, 0);
            z-index: 999;
        }

        /* Estilos para el contenedor del escáner con efecto glow */
        #qrScannerContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1999;
            display: none;
            justify-content: center;
            align-items: center;
        }

        /* Estilos para el video del escáner con efecto glow */
        #qrScanner {
            position: relative;
            width: 300px; /* Ancho del video */
            height: 300px; /* Alto del video */
            border: 2px solid rgb(0, 94, 255);
            object-fit: cover;
            z-index: 2000;
            background-color: black;
            display: none;
            border-radius: 15px;
            box-shadow: 0 0 10px rgba(1, 104, 133, 0.8), 0 0 20px rgba(0, 112, 211, 0.8), 0 0 30px rgba(1, 145, 255, 0.8);
        }

        /* Estilos para el botón de cerrar el escáner */
        #closeScannerButton {
            position: absolute;
            bottom: 150px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #ff0000;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            display: none;
            z-index: 2002; /* Asegurar que esté por encima del láser */
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.8);
        }

        #closeScannerButton:hover {
            background-color: #cc0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 1);
        }    






/* Estilos para los nuevos botones */
.button-container {
    display: flex;
    justify-content: center;
    gap: 10px; /* Espacio entre los botones */
    margin-top: 20px; /* Espacio debajo del botón de emergencia */
}

.custom-button {
    background-color: #000000;
    color: #FFFFFF;
    text-transform: uppercase;
    padding: 10px 20px;
    border-radius: 10px;
    font-size: 10px;
    width: 80px;
    height: 40px;
    border: 2px solid rgb(65, 61, 61);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
    box-sizing: border-box;
    box-shadow: 3px 3px rgb(157, 151, 151);
}

.custom-button:active {
    box-shadow: none;
    transform: translate(3px, 3px);
}

.custom-button:active, .custom-button.active {
    background-color: #1e90ff;
    border-color: #00bfff;
    transform: scale(0.95);
}

/* Estilo base para los botones */
.custom-button {
    background-color: #000000;
    color: #FFFFFF;
    text-transform: uppercase;
    padding: 10px 20px;
    border-radius: 10px;
    font-size: 10px;
    width: 70px;
    height: 40px;
    border: 2px solid rgb(65, 61, 61);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
    box-sizing: border-box;
    box-shadow: 3px 3px rgb(157, 151, 151);
}

/* Estilo cuando el botón está deshabilitado */
.custom-button:disabled {
    background-color: #023501; /* Fondo más oscuro */
    color: #09ff00; /* Texto más claro */
    border: 0.5px solid #09ff00; /* Borde más claro */
    cursor: not-allowed; /* Cambiar el cursor a "no permitido" */
    box-shadow: none; /* Eliminar la sombra */
    /*opacity: 0.7; /* Reducir la opacidad */
}




#emergenciaCuadranteButton {
    display: none;
    background-color: rgb(0, 110, 255);
    color: white;
    font-size: 15px;
    width: 150px;
    height: 150px;
    border: 15px solid #1e90ff;
    border-radius: 50%;
    cursor: pointer;
    align-items: center;
    justify-content: center;
    text-align: center;
    transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
    box-sizing: border-box;
    margin: 40px;
    margin-bottom: 60px;
    animation: neon-color-change-blue 2s infinite;
    
}

@keyframes neon-color-change-blue {
    0% {
        border-color: #00bfff;
        box-shadow: 0 0 10px #00bfff, 0 0 20px #00bfff, 0 0 40px #00bfff;
    }
    50% {
        border-color: #166fc9;
        box-shadow: 0 0 10px #1e90ff, 0 0 20px #1e90ff, 0 0 40px #1e90ff;
    }
    100% {
        border-color: #00bfff;
        box-shadow: 0 0 10px #00bfff, 0 0 20px #00bfff, 0 0 40px #00bfff;
    }
}



/* Estilo para el nuevo botón EmergenciaExtorsion */
#emergenciaExtorsionButton {
    display: none; /* Oculta el botón inicialmente */
    background-color: #c6004c;
    color: white;
    font-size: 15px;
    width: 150px;
    height: 150px;
    border: 15px solid #b70046;
    border-radius: 50%;
    cursor: pointer;
    transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
    box-sizing: border-box;
    margin: 40px;
    margin-bottom: 60px;
    animation: neon-color-change-green 2s infinite;
    
}

#emergenciaExtorsionButton::before {
/* Asegurar que el texto esté centrado */
display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}


@keyframes neon-color-change-green {
    0% {
        border-color: #e00257;
        box-shadow: 0 0 10px #e00257, 0 0 20px #e00257, 0 0 40px #e00257;
    }
    50% {
        border-color: #ff5890;
        box-shadow: 0 0 10px #92254e, 0 0 20px #92254e, 0 0 40px #92254e;
    }
    100% {
        border-color: #e00257;
        box-shadow: 0 0 10px #e00257, 0 0 20px #e00257, 0 0 40px #e00257;
    }
}


#emergenciaConocidoButton {
display: none;
background-color: rgb(251, 95, 162);
color: rgb(255, 255, 255);
font-size: 15px;
width: 150px;
height: 150px;
border: 15px solid #ff69b4;
border-radius: 50%;
cursor: pointer;
align-items: center;
justify-content: center;
text-align: center;
transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
box-sizing: border-box;
margin: 40px;
margin-bottom: 60px;
animation: neon-color-change-pink 2s infinite;

}



@keyframes neon-color-change-pink {
    0% {
        border-color: #ff69b4;
        box-shadow: 0 0 10px #fb1b8b, 0 0 20px #fb1b8b, 0 0 40px #fb1b8b;
    }
    50% {
        border-color: #a83f77;
        box-shadow: 0 0 10px #a83f77, 0 0 20px #a83f77, 0 0 40px #a83f77;
    }
    100% {
        border-color: #ff69b4;
        box-shadow: 0 0 10px #ff69b4, 0 0 20px #ff69b4, 0 0 40px #ff69b4;
    }
}



/*Oculte los botones URL, GIRO Y NOMBRE porque ya estan en el menu---------------------------------*/
#modifyTelCuadranteButton, #modifyTelExtorsionButton, #modifyTelConocidoButton {
    background-color: #000000;
    color: #7c7c7c;
    text-transform: uppercase;
    padding: 10px 20px;
    border-radius: 10px;
    font-size: 14px;
    width: 100px;
    height: 40px;
    border: 2px solid rgb(65, 61, 61);
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    text-align: center;
    transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
    box-sizing: border-box;
    position: absolute;
    bottom: 20px;
    left: 350px; /* Ajusta la posición según sea necesario */
    margin: 0 0;
}

#modifyTelExtorsionButton {
    left: 460px; /* Ajusta la posición según sea necesario */
}

#modifyTelConocidoButton {
    left: 570px; /* Ajusta la posición según sea necesario */
}

#modifyTelCuadranteButton:active, #modifyTelExtorsionButton:active, #modifyTelConocidoButton:active {
    box-shadow: none;
    transform: translate(3px, 3px);
}

#modifyTelCuadranteButton:active, #modifyTelCuadranteButton.active, #modifyTelExtorsionButton:active, #modifyTelExtorsionButton.active, #modifyTelConocidoButton:active, #modifyTelConocidoButton.active {
    background-color: #1e90ff;
    border-color: #00bfff;
    transform: scale(0.95);
}


/* Estilos para el cuadro de diálogo de teléfono, pero de CUADRANTE*/
.custom-tel-cuadrante-input {
    display: none;
    position: fixed;
    width: 250px;
    height: 100px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #000000;
    border: 1px solid #d4a017;
    padding: 20px;
    box-shadow: 0 0 20px #e8a317;
    z-index: 1000;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    border-radius: 10px;
}

.custom-tel-cuadrante-input input {
    width: 90%;
    padding: 10px;
    margin-bottom:7px;
    font-size: 16px;
    background: #ffe9bd;
    color: #000000;
    border: 1px solid #f5b104;
    box-shadow: 0 0 5px #e8a317;
    border-radius: 5px;
}

.custom-tel-cuadrante-input .button-container {
    display: flex;
    justify-content: center;
    gap: 20px;
}

.custom-tel-cuadrante-input .button-container button {
    background-color: #000000;
    color: white;
    border: 1px solid #d4a017;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 16px;
    border-radius: 15px;
}

.custom-tel-cuadrante-input .button-container button:hover {
    background-color: #000000;
    border: 2px solid #c20303;
    box-shadow: 0 0 10px #ff0000;
}




/* Estilos para el cuadro de diálogo de teléfono, pero de EXTORSIÓN (Checarlo porque comparte los mismos estilos que el imput para CUADRANTE)*/
.custom-tel-extorsion-input {
    display: none;
    position: fixed;
    width: 250px;
    height: 100px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #000000;
    border: 1px solid #037787;
    padding: 20px;
    box-shadow: 0 0 20px #00d9ff;
    z-index: 1000;
    text-align: center;
    border-radius: 10px;
}

.custom-tel-extorsion-input input {
    width: 90%;
    padding: 10px;
    margin-bottom:7px;
    font-size: 16px;
    background: #9ef4ff;
    color: #000000;
    border: 1px solid #037787;
    box-shadow: 0 0 5px #00d9ff;
    border-radius: 5px;
}

.custom-tel-extorsion-input input:hover {
    background: #000000;
    border: 0.5px solid #004c5b;
    color: #00d5ff;
}

.custom-tel-extorsion-input input:focus {
    background: #000000;
    border: .5px solid #007292;
    color: #00e1ff;
}

.custom-tel-extorsion-input .button-container {
    display: flex;
    justify-content: center;
    gap: 20px;
}

.custom-tel-extorsion-input .button-container button {
    background-color: #000000;
    color: white;
    border: 1px solid #00d9ff;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 16px;
    border-radius: 15px;
}

.custom-tel-extorsion-input .button-container button:hover {
    background-color: #000000;
    border: 2px solid #00d5ff;
    box-shadow: 0 0 10px #00d9ff;
}


/* Estilos para el cuadro de diálogo de teléfono, pero de CONOCIDO*/
.custom-tel-conocido-input {
    display: none;
    position: fixed;
    width: 250px;
    height: 100px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #000000;
    border: 1px solid #318c00;
    padding: 20px;
    box-shadow: 0 0 20px #59ff00;
    z-index: 1000;
    text-align: center;
    border-radius: 10px;
}

.custom-tel-conocido-input input {
    width: 90%;
    padding: 10px;
    margin-bottom:7px;
    font-size: 16px;
    background: #d1f9bb;
    color: #000000;
    border: 1px solid #389f00;
    box-shadow: 0 0 5px #59ff00;
    border-radius: 5px;
}

.custom-tel-conocido-input input:hover {
    background: #000000;
    border: 0.5px solid #59ff00;
    color: #389f00;
}

.custom-tel-conocido-input input:focus {
    background: #000000;
    border: 0.5px solid #389f00;
    color: #59ff00;
}

.custom-tel-conocido-input .button-container {
    display: flex;
    justify-content: center;
    gap: 20px;
}

.custom-tel-conocido-input .button-container button {
    background-color: #000000;
    color: white;
    border: 1px solid #59ff00;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 16px;
    border-radius: 15px;
}

.custom-tel-conocido-input .button-container button:hover {
    background-color: #000000;
    border: 2px solid #389f00;
    box-shadow: 0 0 10px #59ff00;
}




/* Estilos para el botón de Registro */
#toggleRegistrosButton {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background-color: #000000;
            color: #FFFFFF;
            text-transform: uppercase;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 10px;
            width: 80px;
            height: 40px;
            border: 2px solid rgb(65, 61, 61);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
            box-sizing: border-box;
            box-shadow: 3px 3px rgb(157, 151, 151);
        }

        #toggleRegistrosButton:active {
            box-shadow: none;
            transform: translate(3px, 3px);
        }

        #toggleRegistrosButton:active, #toggleRegistrosButton.active {
            background-color: #1e90ff;
            border-color: #00bfff;
            transform: scale(0.95);
        }

        /* Estilos para el menú de hamburguesa */
        .hamburger-menu {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 998;
        }

        .hamburger-icon {
            background-color: #000000;
            color: #999999;
            border: 2px solid #999999;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }

        .hamburger-icon:hover {
            background-color: #ffffff;
            color: #000000;
        }

        .menu-options {
            display: none;
            position: absolute;
            bottom: 60px;
            right: 0;
            background-color: #000000;
            border: 1px solid #ffffff;
            border-radius: 10px;
            padding: 10px;
            width: 150px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            z-index: 1000; /* Asegurar que esté por encima del overlay */
        }

        .menu-item {
            color: #ffffff;
            padding: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .menu-item:hover {
            background-color: #ffffff;
            color: #000000;
            border-radius: 5px;
        }

        /* Estilos para el overlay del menú */
        .menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Fondo opaco */
            z-index: 998; /* Asegurar que esté por encima de otros elementos */
        }




.registros-container {
    position: center; /*tenía fixed*/
    bottom: -5px;
    left: 20px;
    background-color: #000000;
    border: 0px solid #00e1ff;
    border-radius: 10px;
    padding: 10px;
    height: 500px;
    width: 300px;
    color: #ffffff;
    z-index: 1005;
    max-height: 200px; /* Ajusta este valor según sea necesario */
    overflow-y: auto; /* Habilita el desplazamiento vertical */
    box-shadow: 0 0 20px #00bfff;
}

.registros-container h2 {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #000000; /* Fondo para que el texto sea legible */
    margin: 0 0 10px;
    font-size: 16px;
    padding: 10px 0; /* Añadir padding para mejor apariencia */
    position: sticky;
    top: 0;
    z-index: 1005; /* Asegurar que esté por encima de los registros */
}

.close-button {
    background-color: #ff0000;
    color: #ffffff;
    border: none;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    margin-left: 10px; /* Espacio entre el título y el botón */
}

.close-button:hover {
    background-color: #cc0000;
}

#listaRegistros {
    list-style-type: none;
    padding: 0;
    margin: 0;
}

#listaRegistros li {
    padding: 5px 0;
    border-bottom: 1px solid #444;
}

#listaRegistros li:last-child {
    border-bottom: none;
}


/* Estilo para el overlay semitransparente */
.registros-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgb(0, 0, 0); /* Fondo semitransparente */
    z-index: 1005; /* Asegurar que esté por encima de otros elementos */
}


/* Estilos para el botón de Registro */
#toggleRegistrosButton {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background-color: #000000;
            color: #a5a5a5;
            text-transform: uppercase;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 10px;
            width: 80px;
            height: 40px;
            border: 2px solid rgb(65, 61, 61);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: background-color 0.3s, border-color 0.3s, transform 0.2s;
            box-sizing: border-box;
            box-shadow: 0 0 rgb(157, 151, 151);
        }

        #toggleRegistrosButton:active {
            box-shadow: none;
            transform: translate(3px, 3px);
        }

        #toggleRegistrosButton:active, #toggleRegistrosButton.active {
            background-color: #1e90ff;
            border-color: #00bfff;
            transform: scale(0.95);
        }

        .emergencia-negocio {
            color: yellow;
        }

        .emergencia-extorsion {
            color: red;
        }

        .emergencia-cuadrante {
            color: rgb(0, 195, 255);
        }

        .emergencia-conocido {
            color: rgb(254, 0, 216);
        }


        /* Estilos para el contenedor de gráficas */
        #graficasContainer {
            display: none;
            position: fixed;
            margin: 0;
            top: 33.5%;
            left: 50%;
            transform: translate(-50%, -50%);
            /*background-color: #000000;
            /*border: 1px solid #ffffff;*/
            padding: 0;
            z-index: 1005;
            width: 99%; /* Ajustar el ancho del contenedor */
            height: 66.5%;
            max-width: 800px; /* Aumentar el ancho máximo */
            color: #ffffff;
            text-align: center;
        }

        /* Contenedor flexible para las gráficas */
        .graficas-flex {
            
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        gap: 50px;
        padding: 20px;
        }

/* Estilos mejorados para las gráficas con efecto neón */
.grafica {
        flex: 1;
        min-width: 100px;
        max-width: 150px;
        position: relative;
        transition: all 0.3s ease;
    }

    .grafica canvas {
        max-width: 100%;
        height: auto;
        filter: drop-shadow(0 0 10px currentColor);
        transition: all 0.3s ease;
    }

    .grafica:hover canvas {
        transform: scale(1.1);
        filter: drop-shadow(0 0 20px currentColor);
    }

    /* Efecto de halo neón base */
    .grafica::before {
        content: '';
        position: absolute;
        top: -15px;
        left: -15px;
        right: -15px;
        bottom: -15px;
        border-radius: 50%;
        z-index: -1;
        opacity: 0;
        transition: all 0.5s ease;
        background: radial-gradient(circle, currentColor, transparent 70%);
    }

    .grafica:hover::before {
        opacity: 0.5;
        animation: neon-pulse 1.5s infinite alternate;
    }

    /* Efectos neón específicos para cada tipo de gráfica */
    .grafica-negocio {
        color: #FFFF00; /* Amarillo neón */
    }

    .grafica-cuadrante {
        color: #00FFFF; /* Cian neón */
    }

    .grafica-extorsion {
        color: #FF0000; /* Rojo neón */
    }

    .grafica-conocido {
        color: #FF00FF; /* Magenta neón */
    }

    /* Animación de pulsación para el efecto neón */
    @keyframes neon-pulse {
        0% {
            box-shadow: 0 0 5px currentColor;
        }
        100% {
            box-shadow: 0 0 20px currentColor;
        }
    }

    /* Estilo para el título de activaciones con efecto neón mejorado */
    #graficasContainer h2 {
        color: #0ff;
        text-shadow: 
            0 0 5px #0090b4,
            0 0 10px #0090b4,
            0 0 15px #0ff,
            0 0 20px #0ff;
        animation: neon-glow 1.5s infinite alternate;
        font-size: 1.8rem;
        margin-bottom: 20px;
        text-align: center;
        padding: 10px;
        border-radius: 10px;
        background-color: rgba(0, 0, 0, 0.5);
    }

    /* Animación mejorada para el efecto neón del título */
    @keyframes neon-glow {
        from {
            text-shadow: 
                0 0 5px #0090b4,
                0 0 10px #0090b4,
                0 0 15px #0ff,
                0 0 20px #0ff;
        }
        to {
            text-shadow: 
                0 0 10px #0090b4,
                0 0 20px #0090b4,
                0 0 30px #0ff,
                0 0 40px #0ff;
        }
    }

    /* Estilo mejorado para el número de activaciones */
    #totalActivacionesGraficas {
        color: #0ff;
        font-weight: bold;
        font-size: 1.5rem;
        animation: neon-pulse-number 1s infinite alternate;
        display: inline-block;
        padding: 5px 15px;
        border-radius: 20px;
        background-color: rgba(0, 0, 0, 0.3);
    }

    @keyframes neon-pulse-number {
        from {
            text-shadow: 
                0 0 5px #0ff,
                0 0 10px #0ff;
            transform: scale(1);
        }
        to {
            text-shadow: 
                0 0 10px #0ff,
                0 0 20px #0ff;
            transform: scale(1.05);
        }
    }




        
    </style>
</head>
<body>

    <!-- Contenedor del fondo negro -->
    <div id="initialMessageContainer">
        <!-- Contenido del mensaje inicial -->
        <div id="initialMessageContent">
            <hr class="codigos">EMERGENCIA<br>k8
        </div>
    </div>

    <!-- Resto del contenido de la página -->
    <div id="overlay" class="overlay"></div>

    <!-- Overlay para el menú -->
    <div id="menuOverlay" class="menu-overlay"></div>

    <!-- Overlay para los registros de activación -->
    <div id="registrosOverlay" class="registros-overlay"></div>


    <header>
        <hr class="codigos">
        <h1 class="title_1">EMERGENCIA</h1>
        <h1 class="title_2">k8</h1>
               
        <h1 id="giroNegocioText" class="giroNegocio">GIRO DEL NEGOCIO</h1>
        <h1 id="nombreNegocioText" class="nombreNegocio">"NOMBRE DEL NEGOCIO"</h1>
    </header>
   
    <!-- Botón de emergencia -->
    <button id="emergencyButton" aria-label="Activar emergencia">Negocio</button>
    
    <!-- Nuevo botón EmergenciaCuadrante (inicialmente oculto) -->
    <button id="emergenciaCuadranteButton" class="custom-button">Cuadrante<br>Negocio</button>

    <!-- Nuevo botón EmergenciaExtorsion (inicialmente oculto) -->
    <button id="emergenciaExtorsionButton" class="custom-button">Denunciar<br>Extorsión</button>

    <!-- Nuevo botón EmergenciaConocido (inicialmente oculto) -->
    <button id="emergenciaConocidoButton" class="custom-button">Llamar a<br>Conocido</button>


   



    <!-- Nuevos botones -->
    <div class="button-container">
        <button id="c5Button" class="custom-button" disabled>C5</button>
        <button id="cuadranteButton" class="custom-button">Cuadrante</button>
        <button id="extorsionButton" class="custom-button">Extorsión</button>
        <button id="conocidoButton" class="custom-button">Conocido</button>
    </div>


    <button id="modifyUrlButton" aria-label="Modificar URL">URL MPN</button>
    <button id="modifyGiroButton" aria-label="Modificar Giro">Giro</button>
    <button id="modifyNombreButton" aria-label="Modificar Nombre">Nombre</button>
    <button id="modifyTelCuadranteButton" aria-label="Modificar Tel Cuadrante">Tel Cuadrante</button>
    <button id="modifyTelExtorsionButton" aria-label="Modificar Tel Extorsión">Tel Extorsión</button>
    <button id="modifyTelConocidoButton" aria-label="Modificar Tel Conocido">Tel Conocido</button>



    <!-- Ventana de mensaje personalizada -->
    <div id="customAlert" class="custom-alert">
        <p id="alertMessage"></p>
        <button id="alertCloseButton">Entendido</button>
    </div>

    <!-- Cuadro de confirmación personalizado -->
    <div id="customConfirm" class="custom-confirm">
        <p>¿Confirma activar la emergencia? <br>Esto enviará una alerta a las autoridades.</p>
        <div class="button-container">
            <button id="confirmYes">Activar</button>
            <button id="confirmNo">Cancelar</button>
        </div>
    </div>

    <!-- Cuadro de diálogo para modificar la URL -->
    <div id="customUrlInput" class="custom-url-input">
        <input type="text" id="newUrlInput" placeholder="Ingresa una URL MPN">
        <div class="button-container">
            <button id="urlSubmitButton">Guardar</button>
            <button id="urlCancelButton">Cancelar</button>
            
        </div>
        <button id="scanQRButton">[-]</button>  
    </div>
    
    <div id="qrScannerContainer">
        <video id="qrScanner"></video>
            <button id="closeScannerButton">Cerrar</button>
    </div>

    <!-- Cuadro de diálogo para modificar el giro del negocio -->
    <div id="customGiroInput" class="custom-giro-input">
        <input type="text" id="newGiroInput" placeholder="Ingresa Giro del Negocio">
        <div class="button-container">
            <button id="giroSubmitButton">Guardar</button>
            <button id="giroCancelButton">Cancelar</button>
        </div>
    </div>

    <!-- Cuadro de diálogo para modificar el nombre del negocio -->
    <div id="customNombreInput" class="custom-nombre-input">
        <input type="text" id="newNombreInput" placeholder="Ingresa Nombre del Negocio">
        <div class="button-container">
            <button id="nombreSubmitButton">Guardar</button>
            <button id="nombreCancelButton">Cancelar</button>
        </div>
    </div>  




<!-- Cuadro de diálogo para ingresar el número de teléfono -->
<div id="customTelCuadranteInput" class="custom-tel-cuadrante-input">
    <input type="tel" id="newTelCuadranteInput" placeholder="Ingresa un número de 10 dígitos" maxlength="10">
    <div class="button-container">
        <button id="telCuadranteSubmitButton">Guardar</button>
        <button id="telCuadranteCancelButton">Cancelar</button>
    </div>
</div>


<!-- Cuadro de diálogo para ingresar el número de teléfono -->
<div id="customTelExtorsionInput" class="custom-tel-extorsion-input">
    <input type="tel" id="newTelExtorsionInput" placeholder="Ingresa un número de 10 dígitos" maxlength="10">
    <div class="button-container">
        <button id="telExtorsionSubmitButton">Guardar</button>
        <button id="telExtorsionCancelButton">Cancelar</button>
    </div>
</div>

<!-- Cuadro de diálogo para modificar el teléfono de conocido -->
<div id="customTelConocidoInput" class="custom-tel-conocido-input">
    <input type="tel" id="newTelConocidoInput" placeholder="Ingresa un número de 10 dígitos" maxlength="10">
    <div class="button-container">
        <button id="telConocidoSubmitButton">Guardar</button>
        <button id="telConocidoCancelButton">Cancelar</button>
    </div>
</div>




<!-- Menú de hamburguesa -->
<div id="hamburgerMenu" class="hamburger-menu">
    <div class="hamburger-icon" onclick="toggleMenu()">&#9776;</div>
    <div id="menuOptions" class="menu-options">
        <div class="menu-item" onclick="showCustomUrlInput()">URL</div>
        <div class="menu-item" onclick="showCustomGiroInput()">Giro</div>
        <div class="menu-item" onclick="showCustomNombreInput()">Nombre</div>
        <div class="menu-item" onclick="showCustomTelCuadranteInput()">Tel Cuadrante</div>
        <div class="menu-item" onclick="showCustomTelExtorsionInput()">Tel Extorsión</div>
        <div class="menu-item" onclick="showCustomTelConocidoInput()">Tel Conocido</div>
    </div>
</div>



<!-- Apartado para mostrar los registros de activación -->
<div id="registrosActivacion" class="registros-container" style="display: none;">
    <h2>Registros de Activación <button id="closeRegistrosButton" class="close-button">X</button></h2>
    
    <ul id="listaRegistros"></ul>
</div>

<!-- Botón para consultar los registros de activación -->
<button id="toggleRegistrosButton" class="custom-button">Registros</button>


<!-- Contenedor de gráficas -->
<div id="graficasContainer">
    <h2>Activaciones: <span id="totalActivacionesGraficas">0</span></h2>
    <div class="graficas-flex">
        <div class="grafica">
            <canvas id="graficaNegocio"></canvas>
        </div>
        <div class="grafica">
            <canvas id="graficaCuadrante"></canvas>
        </div>
        <div class="grafica">
            <canvas id="graficaExtorsion"></canvas>
        </div>
        <div class="grafica">
            <canvas id="graficaConocido"></canvas>
        </div>
    </div>
    <!--  <button id="cerrarGraficasButton">X</button> ---- Este botón esta deshabilitado porque el contenedor se cierra con el de registro--> 
</div>

<!--<div id="totalActivaciones" style="text-align: center; color: rgb(131, 32, 32); font-size: .9rem; margin-top: 20px;">
    Activaciones: <span id="activacionesCount">0</span>
</div> ---------Este boton se ubica en la parte inferior donde estan los botones de emergencia y muetra el total de activaciones ----->
<!---    <h2>Activaciones: <span id="totalActivacionesGraficas">0</span></h2>  ----->





    <script>
        /*-----Esta sección donde se guarda el giro y nombre en el localStorage------*/

        // Guardar el giro del negocio en localStorage
        document.getElementById('giroSubmitButton').addEventListener('click', function () {
            const newGiro = document.getElementById('newGiroInput').value;
            if (newGiro) {
                document.getElementById('giroNegocioText').textContent = newGiro.toUpperCase();
                localStorage.setItem('giroNegocio', newGiro);
                hideCustomGiroInput();
            } else {
                showCustomAlert("Ingresa un giro válido.");
            }
        });

        // Cargar el giro del negocio desde localStorage al cargar la página
        window.addEventListener('load', function () {
            const savedGiro = localStorage.getItem('giroNegocio');
            if (savedGiro) {
                document.getElementById('giroNegocioText').textContent = savedGiro.toUpperCase();
            }
        });

        // Guardar el nombre del negocio en localStorage
        document.getElementById('nombreSubmitButton').addEventListener('click', function () {
            const newNombre = document.getElementById('newNombreInput').value;
            if (newNombre) {
                // Asegurarse de que el nombre esté entre comillas
                const nombreConComillas = `"${newNombre}"`;
                document.getElementById('nombreNegocioText').textContent = nombreConComillas.toUpperCase();
                localStorage.setItem('nombreNegocio', nombreConComillas); // Guardar con comillas
                hideCustomNombreInput();
            } else {
                showCustomAlert("Ingresa un nombre válido.");
            }
        });

        // Cargar el nombre del negocio desde localStorage al cargar la página
        window.addEventListener('load', function () {
            const savedNombre = localStorage.getItem('nombreNegocio');
            if (savedNombre) {
                // Verificar si el nombre ya tiene comillas
                const nombreConComillas = savedNombre.startsWith('"') && savedNombre.endsWith('"') 
                    ? savedNombre 
                    : `"${savedNombre}"`;
                document.getElementById('nombreNegocioText').textContent = nombreConComillas.toUpperCase();
            }
        });

        // Cargar el nombre del negocio desde localStorage al cargar la página
        window.addEventListener('load', function () {
            const savedNombre = localStorage.getItem('nombreNegocio');
            if (savedNombre) {
                document.getElementById('nombreNegocioText').textContent = savedNombre.toUpperCase();
            }
        });

        // Obtener la URL guardada en el LocalStorage o usar la predeterminada
        let currentUrl = localStorage.getItem('emergencyUrl') || '';// '' Aquí estaba la URL MPN


        const savedUrl = localStorage.getItem('emergencyUrl');
        if (savedUrl) {
            document.getElementById('newUrlInput').value = maskData(savedUrl);
        }








        // Función para mostrar la ventana de mensaje personalizada
        function showCustomAlert(message, alertType = 'error') {
            const customAlert = document.getElementById('customAlert');
            const overlay = document.getElementById('overlay');
            const alertMessage = document.getElementById('alertMessage');
            alertMessage.innerHTML = message; // Usar innerHTML en lugar de textContent

            // Restablecer clases
            customAlert.className = 'custom-alert';

            // Cambiar el color de fondo según el tipo de alerta (es referente al botón de confirmación
            // de activación exitosa que aparece despúes de los 5s)
            if (alertType === 'success') {
                customAlert.classList.add('success');
            } else if (alertType === 'confirmation') {
                customAlert.classList.add('confirmation');
            }
            customAlert.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Función para ocultar la ventana de mensaje personalizada
        function hideCustomAlert() {
            const customAlert = document.getElementById('customAlert');
            const overlay = document.getElementById('overlay');
            customAlert.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Función para mostrar el cuadro de confirmación personalizado
        function showCustomConfirm() {
            const customConfirm = document.getElementById('customConfirm');
            const overlay = document.getElementById('overlay');
            customConfirm.style.display = 'block';
            overlay.style.display = 'block';

            // Agregar la clase "active" al botón de emergencia
            const emergencyButton = document.getElementById('emergencyButton');
            emergencyButton.classList.add('active');
        }

        // Función para ocultar el cuadro de confirmación personalizado
        function hideCustomConfirm() {
            const customConfirm = document.getElementById('customConfirm');
            const overlay = document.getElementById('overlay');
            customConfirm.style.display = 'none';
            overlay.style.display = 'none';

            // Eliminar la clase "active" del botón de emergencia
            const emergencyButton = document.getElementById('emergencyButton');
            emergencyButton.classList.remove('active');
        }

        // Función para mostrar el cuadro de diálogo para modificar la URL
        function showCustomUrlInput() {
            const customUrlInput = document.getElementById('customUrlInput');
            const overlay = document.getElementById('overlay');
            customUrlInput.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Función para ocultar el cuadro de diálogo para modificar la URL
        function hideCustomUrlInput() {
            const customUrlInput = document.getElementById('customUrlInput');
            const overlay = document.getElementById('overlay');
            customUrlInput.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Función para mostrar el cuadro de diálogo para modificar el giro del negocio
        function showCustomGiroInput() {
            const customGiroInput = document.getElementById('customGiroInput');
            const overlay = document.getElementById('overlay');
            customGiroInput.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Función para ocultar el cuadro de diálogo para modificar el giro del negocio
        function hideCustomGiroInput() {
            const customGiroInput = document.getElementById('customGiroInput');
            const overlay = document.getElementById('overlay');
            customGiroInput.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Función para mostrar el cuadro de diálogo para modificar el nombre del negocio
        function showCustomNombreInput() {
            const customNombreInput = document.getElementById('customNombreInput');
            const overlay = document.getElementById('overlay');
            customNombreInput.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Función para ocultar el cuadro de diálogo para modificar el nombre del negocio
        function hideCustomNombreInput() {
            const customNombreInput = document.getElementById('customNombreInput');
            const overlay = document.getElementById('overlay');
            customNombreInput.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Evento para cerrar la ventana de mensaje
        document.getElementById('alertCloseButton').addEventListener('click', hideCustomAlert);

        // Evento para el botón "Sí" del cuadro de confirmación
        document.getElementById('confirmYes').addEventListener('click', function () {
            hideCustomConfirm();

            // Verificar si hay conexión a Internet
            if (!navigator.onLine) {
                showCustomAlert("No hay conexión a internet, o datos móviles.");
                return;
            }

            try {
                const nuevaVentana = window.open(currentUrl, '_blank');

                if (!nuevaVentana) {
                    throw new Error("No se pudo abrir la ventana. Verifica si hay un bloqueador de ventanas emergentes.");
                }

                guardarRegistroActivacion('Emergencia Negocio');
                // Obtener la hora actual
                const now = new Date();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                const timeString = `${hours}:${minutes}:${seconds}`;





                setTimeout(() => {
                    if (!nuevaVentana.closed) {
                        nuevaVentana.close();
                        showCustomAlert(`¡Activación Exitosa!<br>Hora: ${timeString}`, 'confirmation');
                    }
                }, 5000);
            } catch (error) {
                showCustomAlert(`Error: ${error.message}`);
            }
        });



        // Evento para el botón "No" del cuadro de confirmación
        document.getElementById('confirmNo').addEventListener('click', function () {
            hideCustomConfirm();
        });

        // Evento para el botón "Aceptar" del cuadro de diálogo para modificar la URL
        document.getElementById('urlSubmitButton').addEventListener('click', function () {
            const newUrl = document.getElementById('newUrlInput').value;
            if (newUrl) {
                currentUrl = newUrl;
                localStorage.setItem('emergencyUrl', newUrl); // Guardar la nueva URL en el LocalStorage
                hideCustomUrlInput();
                showCustomAlert("URL modificada exitosamente.", 'success');
            } else {
                showCustomAlert("Ingresa una URL MPN válida.");
            }
        });

        // Evento para el botón "Cancelar" del cuadro de diálogo para modificar la URL
        document.getElementById('urlCancelButton').addEventListener('click', function () {
            hideCustomUrlInput();
        });

        // Evento para el botón "Aceptar" del cuadro de diálogo para modificar el giro del negocio
        document.getElementById('giroSubmitButton').addEventListener('click', function () {
            const newGiro = document.getElementById('newGiroInput').value;
            if (newGiro) {
                document.getElementById('giroNegocioText').textContent = newGiro.toUpperCase();
                hideCustomGiroInput();
            } else {
                showCustomAlert("Ingresa un giro válido.");
            }
        });

        // Evento para el botón "Cancelar" del cuadro de diálogo para modificar el giro del negocio
        document.getElementById('giroCancelButton').addEventListener('click', function () {
            hideCustomGiroInput();
        });

        // Evento para el botón "Aceptar" del cuadro de diálogo para modificar el nombre del negocio
        document.getElementById('nombreSubmitButton').addEventListener('click', function () {
            const newNombre = document.getElementById('newNombreInput').value;
            if (newNombre) {
                document.getElementById('nombreNegocioText').textContent = newNombre.toUpperCase();
                hideCustomNombreInput();
            } else {
                showCustomAlert("Ingresa un nombre válido.");
            }
        });

        // Evento para el botón "Cancelar" del cuadro de diálogo para modificar el nombre del negocio
        document.getElementById('nombreCancelButton').addEventListener('click', function () {
            hideCustomNombreInput();
        });

        // Lógica del botón de emergencia
        document.getElementById('emergencyButton').addEventListener('click', function () {
            // Verificar si la URL está vacía
            if (!currentUrl || currentUrl.trim() === '') {
                showCustomAlert("Carga una URL MPN antes de activar la emergencia.");
            } else {
                showCustomConfirm();
            }
        });

        // Lógica del botón para modificar la URL
        document.getElementById('modifyUrlButton').addEventListener('click', function () {
            showCustomUrlInput();
        });

        // Lógica del botón para modificar el giro del negocio
        document.getElementById('modifyGiroButton').addEventListener('click', function () {
            showCustomGiroInput();
        });

        // Lógica del botón para modificar el nombre del negocio
        document.getElementById('modifyNombreButton').addEventListener('click', function () {
            showCustomNombreInput();
        });

        // Inicializar los botones como desactivados al cargar la página
        window.addEventListener('load', function () {
            document.getElementById('urlSubmitButton').disabled = true;
            document.getElementById('giroSubmitButton').disabled = true;
            document.getElementById('nombreSubmitButton').disabled = true;
        });

       // Habilitar/deshabilitar el botón "Guardar" cuando cambie el valor del campo de entrada
        document.getElementById('newUrlInput').addEventListener('input', function () {
            const urlSubmitButton = document.getElementById('urlSubmitButton');
            urlSubmitButton.disabled = !this.value.trim(); // Habilitar si hay texto
        });

        // Ocultar el botón de escanear QR cuando el campo de URL está enfocado
        document.getElementById('newUrlInput').addEventListener('focus', function () {
            const scanQRButton = document.getElementById('scanQRButton');
            scanQRButton.style.display = 'none'; // Ocultar el botón
        });

        // Mostrar el botón de escanear QR cuando el campo de URL pierde el foco
        document.getElementById('newUrlInput').addEventListener('blur', function () {
            const scanQRButton = document.getElementById('scanQRButton');
            scanQRButton.style.display = 'block'; // Mostrar el botón
        });


        // Habilitar/deshabilitar el botón de guardar giro
        document.getElementById('newGiroInput').addEventListener('input', function () {
            const giroSubmitButton = document.getElementById('giroSubmitButton');
            giroSubmitButton.disabled = !this.value.trim();
        });

        // Habilitar/deshabilitar el botón de guardar nombre
        document.getElementById('newNombreInput').addEventListener('input', function () {
            const nombreSubmitButton = document.getElementById('nombreSubmitButton');
            nombreSubmitButton.disabled = !this.value.trim();
        });

        // Mostrar el mensaje inicial y ocultarlo después de 2 segundos con animación
        document.addEventListener('DOMContentLoaded', function () {
            const initialMessageContent = document.getElementById('initialMessageContent');
            const initialMessageContainer = document.getElementById('initialMessageContainer');
            setTimeout(() => {
                initialMessageContent.classList.add('slide-up-and-fade');
                setTimeout(() => {
                    initialMessageContainer.style.display = 'none'; // Eliminar el fondo negro abruptamente
                }, 1000); // Ocultar después de que termine la animación
            }, 2000); // 2000 milisegundos = 2 segundos
        });

        function startQRScanner() {
            const video = document.getElementById('qrScanner');
            const qrScannerContainer = document.getElementById('qrScannerContainer');
            const closeScannerButton = document.getElementById('closeScannerButton');
            const newUrlInput = document.getElementById('newUrlInput');

                // Mostrar el contenedor y el video
                qrScannerContainer.style.display = 'flex';
                video.style.display = 'block';
                closeScannerButton.style.display = 'block';

            // Solicitar acceso a la cámara
            navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
                .then(function(stream) {
                    video.srcObject = stream;
                    video.setAttribute("playsinline", true);
                    video.play();
                    requestAnimationFrame(tick);
                })
                .catch(function(err) {
                    console.error("Error al acceder a la cámara: ", err);
                    alert("No se pudo acceder a la cámara.");
                });

            function tick() {
                if (video.readyState === video.HAVE_ENOUGH_DATA) {
                    const canvas = document.createElement('canvas');
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    const context = canvas.getContext('2d');
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);
                    const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
                    const code = jsQR(imageData.data, imageData.width, imageData.height, {
                        inversionAttempts: "dontInvert",
                    });

                    if (code) {
                        // Asignar el valor escaneado al campo de entrada de la URL
                        newUrlInput.value = code.data;

                        // Habilitar el botón de guardar
                        document.getElementById('urlSubmitButton').disabled = false;

                        // Detener el escáner después de un breve momento
                        setTimeout(() => {
                            stopQRScanner();
                        }, 1000); // Reducido a 1 segundo para una respuesta más rápida
                    }
                }
                requestAnimationFrame(tick);
            }
        }

        function stopQRScanner() {
            const video = document.getElementById('qrScanner');
            const qrScannerContainer = document.getElementById('qrScannerContainer');
            const closeScannerButton = document.getElementById('closeScannerButton');
        
            if (video.srcObject) {
                const tracks = video.srcObject.getTracks();
                tracks.forEach(track => track.stop());
                video.srcObject = null;
            }

            video.style.display = 'none';
            qrScannerContainer.style.display = 'none';
            closeScannerButton.style.display = 'none';
        }

        // Evento para el botón de escanear QR
        document.getElementById('scanQRButton').addEventListener('click', function () {
            startQRScanner();
        });

        // Evento para el botón de cerrar el escáner de QR
        document.getElementById('closeScannerButton').addEventListener('click', function () {
            stopQRScanner();
        });

        // Evento para el botón de escanear QR
        document.getElementById('scanQRButton').addEventListener('click', function () {
            startQRScanner();
        });

        function maskData(value) {
            if (!value) return '';
            const length = value.length;
            if (length <= 5) return value; // Si el valor es corto, no lo enmascares
            const masked = '*'.repeat(length - 5) + value.slice(-5);
            return masked;
        }




// Eventos para los nuevos botones
document.getElementById('c5Button').addEventListener('click', function () {
    // showCustomAlert("Botón C5 presionado."); //
});

document.getElementById('cuadranteButton').addEventListener('click', function () {
   // showCustomAlert("Botón Cuadrante presionado."); //
});

document.getElementById('extorsionButton').addEventListener('click', function () {
    // showCustomAlert("Botón Extorsión presionado."); //
});

document.getElementById('conocidoButton').addEventListener('click', function () {
   //  showCustomAlert("Botón Conocido presionado."); //
});




// Obtener referencias a los botones
const c5Button = document.getElementById('c5Button');
const cuadranteButton = document.getElementById('cuadranteButton');
const extorsionButton = document.getElementById('extorsionButton');
const conocidoButton = document.getElementById('conocidoButton');

// Función para habilitar el botón C5
function habilitarC5() {
    c5Button.disabled = false;
}

// Función para deshabilitar un botón y habilitar los demás
function manejarEstadoBotones(botonPresionado) {
    // Deshabilitar el botón presionado
    botonPresionado.disabled = true;

    // Habilitar los demás botones
    if (botonPresionado !== c5Button) {
        c5Button.disabled = false;
    }
    if (botonPresionado !== cuadranteButton) {
        cuadranteButton.disabled = false;
    }
    if (botonPresionado !== extorsionButton) {
        extorsionButton.disabled = false;
    }
    if (botonPresionado !== conocidoButton) {
        conocidoButton.disabled = false;
    }
}

// Eventos para los botones (sin mostrar alertas)
cuadranteButton.addEventListener('click', function () {
    manejarEstadoBotones(cuadranteButton);
    // showCustomAlert("Botón Cuadrante presionado."); // Eliminar esta línea
});

extorsionButton.addEventListener('click', function () {
    manejarEstadoBotones(extorsionButton);
    // showCustomAlert("Botón Extorsión presionado."); // Eliminar esta línea
});

conocidoButton.addEventListener('click', function () {
    manejarEstadoBotones(conocidoButton);
    // showCustomAlert("Botón Conocido presionado."); // Eliminar esta línea
});

c5Button.addEventListener('click', function () {
    manejarEstadoBotones(c5Button);
    // showCustomAlert("Botón C5 presionado."); // Eliminar esta línea
});




// Evento para el botón C5
document.getElementById('c5Button').addEventListener('click', function () {
    // Restablecer el botón de emergencia
    document.getElementById('emergencyButton').style.display = 'block'; // Mostrar el botón de emergencia original
    document.getElementById('emergenciaCuadranteButton').style.display = 'none'; // Ocultar el botón de emergencia cuadrante
    document.getElementById('emergenciaExtorsionButton').style.display = 'none'; // Ocultar el botón de emergencia extorsión
    document.getElementById('emergenciaConocidoButton').style.display = 'none'; // Ocultar el botón de emergencia conocido

    // Habilitar los botones deshabilitados
    document.getElementById('cuadranteButton').disabled = false;
    document.getElementById('extorsionButton').disabled = false;
    document.getElementById('conocidoButton').disabled = false;

    // Deshabilitar el botón C5
    this.disabled = true;
});



document.getElementById('cuadranteButton').addEventListener('click', function () {
    // Ocultar el botón de emergencia
    document.getElementById('emergencyButton').style.display = 'none';
    document.getElementById('emergenciaExtorsionButton').style.display = 'none'; // Ocultar el botón de emergencia extorsión
    document.getElementById('emergenciaConocidoButton').style.display = 'none'; // Ocultar el botón de emergencia conocido
    // Mostrar el botón EmergenciaCuadrante
    document.getElementById('emergenciaCuadranteButton').style.display = 'flex';
    
    // Deshabilitar el botón Cuadrante
    this.disabled = true;
    
    // Habilitar los demás botones
    document.getElementById('c5Button').disabled = false;
    document.getElementById('extorsionButton').disabled = false;
    document.getElementById('conocidoButton').disabled = false;
});

// Evento para el botón "EmergenciaCuadrante"
document.getElementById('emergenciaCuadranteButton').addEventListener('click', function () {
    guardarRegistroActivacion('Emergencia Cuadrante');
    // Obtener la hora actual
    const now = new Date();
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    const timeString = `${hours}:${minutes}:${seconds}`;

    // Mostrar el mensaje con la hora de activación
    showCustomAlert(`Emergencia Cuadrante<br>Hora: ${timeString}`);
});





// Evento para el botón "Extorsión"
document.getElementById('extorsionButton').addEventListener('click', function () {
    // Ocultar los botones de emergencia y emergencia cuadrante
    document.getElementById('emergencyButton').style.display = 'none';
    document.getElementById('emergenciaCuadranteButton').style.display = 'none';
    document.getElementById('emergenciaConocidoButton').style.display = 'none';
    // Mostrar el nuevo botón EmergenciaExtorsion
    document.getElementById('emergenciaExtorsionButton').style.display = 'flex';
    
    // Deshabilitar el botón Extorsión
    this.disabled = true;
    
    // Habilitar los demás botones
    document.getElementById('c5Button').disabled = false;
    document.getElementById('cuadranteButton').disabled = false;
    document.getElementById('conocidoButton').disabled = false;
});

// Evento para el nuevo botón EmergenciaExtorsion
document.getElementById('emergenciaExtorsionButton').addEventListener('click', function () {
    guardarRegistroActivacion('Emergencia por Extorsión');
    // Obtener la hora actual
    const now = new Date();
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    const timeString = `${hours}:${minutes}:${seconds}`;

    // Aquí puedes agregar la lógica para manejar la emergencia por extorsión
    showCustomAlert(`Emergencia por Extorsión<br>Hora: ${timeString}`);
});






document.getElementById('conocidoButton').addEventListener('click', function () {
    // Ocultar los botones de emergencia, emergencia cuadrante y extorsión
    document.getElementById('emergencyButton').style.display = 'none';
    document.getElementById('emergenciaCuadranteButton').style.display = 'none';
    document.getElementById('emergenciaExtorsionButton').style.display = 'none';
    
    // Mostrar el nuevo botón EmergenciaConocido
    document.getElementById('emergenciaConocidoButton').style.display = 'flex';
    
    // Deshabilitar el botón Conocido
    this.disabled = true;
    
    // Habilitar los demás botones
    document.getElementById('c5Button').disabled = false;
    document.getElementById('cuadranteButton').disabled = false;
    document.getElementById('extorsionButton').disabled = false;
});

// Evento para el nuevo botón EmergenciaConocido
document.getElementById('emergenciaConocidoButton').addEventListener('click', function () {
    guardarRegistroActivacion('Emergencia a Conocido');
    // Obtener la hora actual
    const now = new Date();
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    const timeString = `${hours}:${minutes}:${seconds}`;

    // Aquí puedes agregar la lógica para manejar la emergencia por conocido
    showCustomAlert(`Emergencia a Conocido <br>Hora: ${timeString}`);
});


// Guardar el teléfono de cuadrante en localStorage
document.getElementById('modifyTelCuadranteButton').addEventListener('click', function () {
    // const newTelCuadrante = prompt("Ingresa el número de teléfono para Cuadrante:");
    if (newTelCuadrante) {
        localStorage.setItem('telCuadrante', newTelCuadrante);
        showCustomAlert("Teléfono de Cuadrante guardado exitosamente.", 'success');
    } else {
        showCustomAlert("Ingresa un número de teléfono válido.");
    }
});

// Guardar el teléfono de extorsión en localStorage
document.getElementById('modifyTelExtorsionButton').addEventListener('click', function () {
    //const newTelExtorsion = prompt("Ingresa el número de teléfono para Extorsión:");
    if (newTelExtorsion) {
        localStorage.setItem('telExtorsion', newTelExtorsion);
        showCustomAlert("Teléfono de Extorsión guardado exitosamente.", 'success');
    } else {
        showCustomAlert("Ingresa un número de teléfono válido.");
    }
});

// Guardar el teléfono de conocido en localStorage
document.getElementById('modifyTelConocidoButton').addEventListener('click', function () {
    //const newTelConocido = prompt("Ingresa el número de teléfono para Conocido:");
    if (newTelConocido) {
        localStorage.setItem('telConocido', newTelConocido);
        showCustomAlert("Teléfono de Conocido guardado exitosamente.", 'success');
    } else {
        showCustomAlert("Ingresa un número de teléfono válido.");
    }
});

// Cargar los números de teléfono desde localStorage al cargar la página
window.addEventListener('load', function () {
    const savedTelCuadrante = localStorage.getItem('telCuadrante');
    const savedTelExtorsion = localStorage.getItem('telExtorsion');
    const savedTelConocido = localStorage.getItem('telConocido');

    if (savedTelCuadrante) {
        console.log("Teléfono de Cuadrante cargado:", savedTelCuadrante);
    }
    if (savedTelExtorsion) {
        console.log("Teléfono de Extorsión cargado:", savedTelExtorsion);
    }
    if (savedTelConocido) {
        console.log("Teléfono de Conocido cargado:", savedTelConocido);
    }
});





// Función para mostrar el cuadro de diálogo para modificar el teléfono de cuadrante
function showCustomTelCuadranteInput() {
    const customTelCuadranteInput = document.getElementById('customTelCuadranteInput');
    const overlay = document.getElementById('overlay');
    customTelCuadranteInput.style.display = 'block';
    overlay.style.display = 'block';
}

// Función para ocultar el cuadro de diálogo para modificar el teléfono de cuadrante
function hideCustomTelCuadranteInput() {
    const customTelCuadranteInput = document.getElementById('customTelCuadranteInput');
    const overlay = document.getElementById('overlay');
    customTelCuadranteInput.style.display = 'none';
    overlay.style.display = 'none';
}

// Evento para el botón "Guardar" del cuadro de diálogo para modificar el teléfono de cuadrante
document.getElementById('telCuadranteSubmitButton').addEventListener('click', function () {
    const newTelCuadrante = document.getElementById('newTelCuadranteInput').value;
    if (newTelCuadrante && newTelCuadrante.length === 10 && /^\d+$/.test(newTelCuadrante)) {
        localStorage.setItem('telCuadrante', newTelCuadrante);
        hideCustomTelCuadranteInput();
        showCustomAlert("Teléfono de Cuadrante guardado exitosamente.", 'success');
    } else {
        showCustomAlert("Ingresa un número de teléfono válido de 10 dígitos.");
    }
});

// Evento para el botón "Cancelar" del cuadro de diálogo para modificar el teléfono de cuadrante
document.getElementById('telCuadranteCancelButton').addEventListener('click', function () {
    hideCustomTelCuadranteInput();
});

// Evento para el botón "Tel Cuadrante"
document.getElementById('modifyTelCuadranteButton').addEventListener('click', function () {
    showCustomTelCuadranteInput("");
});

// Evento para el botón "EmergenciaCuadrante"
document.getElementById('emergenciaCuadranteButton').addEventListener('click', function () {
    const telCuadrante = localStorage.getItem('telCuadrante');
    if (telCuadrante) {
        window.location.href = `tel:${telCuadrante}`;
    } else {
        showCustomAlert("No hay un número de teléfono de Cuadrante guardado.");
    }
});





// Mostrar el cuadro de diálogo para ingresar el número de teléfono de extorsión
document.getElementById('modifyTelExtorsionButton').addEventListener('click', function () {
    showCustomTelExtorsionInput();
});

// Función para mostrar el cuadro de diálogo de teléfono de extorsión
function showCustomTelExtorsionInput() {
    const customTelExtorsionInput = document.getElementById('customTelExtorsionInput');
    const overlay = document.getElementById('overlay');
    customTelExtorsionInput.style.display = 'block';
    overlay.style.display = 'block';
}

// Función para ocultar el cuadro de diálogo de teléfono de extorsión
function hideCustomTelExtorsionInput() {
    const customTelExtorsionInput = document.getElementById('customTelExtorsionInput');
    const overlay = document.getElementById('overlay');
    customTelExtorsionInput.style.display = 'none';
    overlay.style.display = 'none';
}

// Guardar el número de teléfono de extorsión en localStorage
document.getElementById('telExtorsionSubmitButton').addEventListener('click', function () {
    const newTelExtorsion = document.getElementById('newTelExtorsionInput').value;
    if (newTelExtorsion && newTelExtorsion.length === 10) {
        localStorage.setItem('telExtorsion', newTelExtorsion);
        hideCustomTelExtorsionInput();
        showCustomAlert("Número de teléfono guardado exitosamente.", 'success');
    } else {
        showCustomAlert("Ingresa un número de teléfono válido de 10 dígitos.");
    }
});

// Cancelar la edición del número de teléfono de extorsión
document.getElementById('telExtorsionCancelButton').addEventListener('click', function () {
    hideCustomTelExtorsionInput();
});

// Realizar la llamada cuando se pulse el botón "EmergenciaExtorsión"
document.getElementById('emergenciaExtorsionButton').addEventListener('click', function () {
    const telExtorsion = localStorage.getItem('telExtorsion');
    if (telExtorsion) {
        window.location.href = `tel:${telExtorsion}`;
    } else {
        showCustomAlert("No se ha configurado un número de teléfono para extorsión.");
    }
});



// Función para mostrar el cuadro de diálogo para modificar el teléfono de conocido
function showCustomTelConocidoInput() {
    const customTelConocidoInput = document.getElementById('customTelConocidoInput');
    const overlay = document.getElementById('overlay');
    customTelConocidoInput.style.display = 'block';
    overlay.style.display = 'block';
}

// Función para ocultar el cuadro de diálogo para modificar el teléfono de conocido
function hideCustomTelConocidoInput() {
    const customTelConocidoInput = document.getElementById('customTelConocidoInput');
    const overlay = document.getElementById('overlay');
    customTelConocidoInput.style.display = 'none';
    overlay.style.display = 'none';
}

// Evento para el botón "Guardar" del cuadro de diálogo para modificar el teléfono de conocido
document.getElementById('telConocidoSubmitButton').addEventListener('click', function () {
    const newTelConocido = document.getElementById('newTelConocidoInput').value;
    if (newTelConocido && newTelConocido.length === 10 && /^\d+$/.test(newTelConocido)) {
        localStorage.setItem('telConocido', newTelConocido);
        hideCustomTelConocidoInput();
        showCustomAlert("Teléfono de Conocido guardado exitosamente.", 'success');
    } else {
        showCustomAlert("Ingresa un número de teléfono válido de 10 dígitos.");
    }
});

// Evento para el botón "Cancelar" del cuadro de diálogo para modificar el teléfono de conocido
document.getElementById('telConocidoCancelButton').addEventListener('click', function () {
    hideCustomTelConocidoInput();
});

// Evento para el botón "EmergenciaConocido"
document.getElementById('emergenciaConocidoButton').addEventListener('click', function () {
    const telConocido = localStorage.getItem('telConocido');
    if (telConocido) {
        window.location.href = `tel:${telConocido}`;
    } else {
        showCustomAlert("No se ha configurado un número de teléfono para Conocido.");
    }
});

// Evento para el botón "Tel Conocido"
document.getElementById('modifyTelConocidoButton').addEventListener('click', function () {
    showCustomTelConocidoInput();
});





// Función para mostrar/ocultar el menú
function toggleMenu() {
    const menuOptions = document.getElementById('menuOptions');
    const menuOverlay = document.getElementById('menuOverlay');
    if (menuOptions.style.display === 'block') {
        menuOptions.style.display = 'none';
        menuOverlay.style.display = 'none'; // Ocultar el overlay
    } else {
        menuOptions.style.display = 'block';
        menuOverlay.style.display = 'block'; // Mostrar el overlay
    }
}

// Cerrar el menú si se hace clic fuera de él
document.addEventListener('click', function(event) {
    const hamburgerMenu = document.getElementById('hamburgerMenu');
    const menuOptions = document.getElementById('menuOptions');
    const menuOverlay = document.getElementById('menuOverlay');
    if (!hamburgerMenu.contains(event.target)) {
        menuOptions.style.display = 'none';
        menuOverlay.style.display = 'none'; // Ocultar el overlay
    }
});

// Agregar eventos a los elementos del menú para ocultarlo al seleccionar una opción
document.querySelectorAll('.menu-item').forEach(item => {
    item.addEventListener('click', function() {
        toggleMenu(); // Ocultar el menú al seleccionar una opción
    });
});


 // Función para guardar un registro de activación
 function guardarRegistroActivacion(tipoEmergencia) {
            const now = new Date();
            const fecha = now.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: '2-digit', day: '2-digit' });
            const horas = String(now.getHours()).padStart(2, '0');
            const minutos = String(now.getMinutes()).padStart(2, '0');
            const segundos = String(now.getSeconds()).padStart(2, '0');
            const registro = {
                tipo: tipoEmergencia,
                hora: `${horas}:${minutos}:${segundos}`,
                fecha: fecha
            };

            // Obtener los registros existentes o inicializar un array vacío
            const registros = JSON.parse(localStorage.getItem('registrosActivacion')) || [];
            registros.push(registro);

            // Guardar los registros actualizados en localStorage
            localStorage.setItem('registrosActivacion', JSON.stringify(registros));

            // Actualizar la lista de registros en la interfaz
            actualizarListaRegistros();

            // Actualizar el contador de activaciones
            actualizarContadorActivaciones();
        }

// Función para agrupar registros por día
function agruparRegistrosPorDia(registros) {
    return registros.reduce((acc, registro) => {
        const fecha = registro.fecha;
        if (!acc[fecha]) {
            acc[fecha] = [];
        }
        acc[fecha].push(registro);
        return acc;
    }, {});
}

document.getElementById('toggleRegistrosButton').addEventListener('click', function () {
    const registrosContainer = document.getElementById('registrosActivacion');
    const registrosOverlay = document.getElementById('registrosOverlay');
    
    if (registrosContainer.style.display === 'none' || registrosContainer.style.display === '') {
        registrosContainer.style.display = 'block';
        registrosOverlay.style.display = 'block'; // Mostrar el overlay
        this.textContent = 'Ocultar Registros';
    } else {
        registrosContainer.style.display = 'none';
        registrosOverlay.style.display = 'none'; // Ocultar el overlay
        this.textContent = 'Registros';
    }
});

document.getElementById('closeRegistrosButton').addEventListener('click', function () {
    const registrosContainer = document.getElementById('registrosActivacion');
    const registrosOverlay = document.getElementById('registrosOverlay');
    
    registrosContainer.style.display = 'none';
    registrosOverlay.style.display = 'none'; // Ocultar el overlay
    document.getElementById('toggleRegistrosButton').textContent = 'Registros';
});

function actualizarListaRegistros() {
    const listaRegistros = document.getElementById('listaRegistros');
    listaRegistros.innerHTML = ''; // Limpiar la lista actual

    // Obtener los registros de localStorage
    const registros = JSON.parse(localStorage.getItem('registrosActivacion')) || [];

    // Agrupar los registros por día
    const registrosPorDia = agruparRegistrosPorDia(registros);

    // Obtener la fecha actual
    const now = new Date();
    const fechaHoy = now.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: '2-digit', day: '2-digit' });


    // Convertir las fechas a objetos Date para poder ordenarlas
    const fechasOrdenadas = Object.keys(registrosPorDia)
        .map(fechaStr => {
            // Convertir la cadena de fecha a objeto Date
            const partes = fechaStr.split(', ');
            if (partes.length === 2) {
                const [diaSemana, resto] = partes;
                const [dia, mes, año] = resto.split('/');
                return new Date(`${mes}/${dia}/${año}`);
            }
            return new Date(); // Si el formato no es el esperado, usar fecha actual
        })
        .sort((a, b) => b - a); // Ordenar de más reciente a más antiguo

    // Mostrar los registros ordenados por fecha
    fechasOrdenadas.forEach(fechaObj => {
        const fechaStr = fechaObj.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: '2-digit', day: '2-digit' });
        
        if (registrosPorDia[fechaStr]) {
            const liFecha = document.createElement('li');
            liFecha.textContent = fechaStr === fechaHoy ? "Hoy" : fechaStr;
            liFecha.style.fontWeight = 'bold';
            liFecha.style.marginTop = '10px';
            listaRegistros.appendChild(liFecha);

            // Ordenar los registros del día por hora (de mayor a menor)
            registrosPorDia[fechaStr].sort((a, b) => {
                const horaA = a.hora.split(':').join('');
                const horaB = b.hora.split(':').join('');
                return horaB.localeCompare(horaA);
            });

            // Mostrar cada registro en la lista
            registrosPorDia[fechaStr].forEach(registro => {
                const li = document.createElement('li');
                li.textContent = `${registro.tipo} - ${registro.hora}`;
                li.style.marginLeft = '20px';

                // Aplicar clases según el tipo de registro
                switch (registro.tipo) {
                    case 'Emergencia Negocio':
                        li.classList.add('emergencia-negocio');
                        break;
                    case 'Emergencia por Extorsión':
                        li.classList.add('emergencia-extorsion');
                        break;
                    case 'Emergencia Cuadrante':
                        li.classList.add('emergencia-cuadrante');
                        break;
                    case 'Emergencia a Conocido':
                        li.classList.add('emergencia-conocido');
                        break;
                }

                listaRegistros.appendChild(li);
            });
        }
    });
}

// Función para agrupar registros por día
function agruparRegistrosPorDia(registros) {
    return registros.reduce((acc, registro) => {
        const fecha = registro.fecha; // Asume que cada registro tiene una propiedad 'fecha'
        if (!acc[fecha]) {
            acc[fecha] = [];
        }
        acc[fecha].push(registro);
        return acc;
    }, {});
}

// Llamar a esta función al cargar la página para mostrar los registros existentes
window.addEventListener('load', actualizarListaRegistros);

        // Función para mostrar/ocultar el contenedor de gráficas
        document.getElementById('toggleRegistrosButton').addEventListener('click', function() {
    const graficasContainer = document.getElementById('graficasContainer');
    const registrosOverlay = document.getElementById('registrosOverlay');
    
    if (graficasContainer.style.display === 'none' || graficasContainer.style.display === '') {
        // Inicializar el contador a cero antes de mostrar
        document.getElementById('totalActivacionesGraficas').textContent = '0';
        graficasContainer.style.display = 'block';
        registrosOverlay.style.display = 'block';
        actualizarGraficas();
    } else {
        graficasContainer.style.display = 'none';
        registrosOverlay.style.display = 'none';
    }
});

        // Función para cerrar el contenedor de gráficas
        document.getElementById(/*'cerrarGraficasButton'*/'closeRegistrosButton').addEventListener('click', function () {
            const graficasContainer = document.getElementById('graficasContainer');
            const registrosOverlay = document.getElementById('registrosOverlay');
            graficasContainer.style.display = 'none';
            registrosOverlay.style.display = 'none';
        });


  

        function actualizarGraficas() {
    const registros = JSON.parse(localStorage.getItem('registrosActivacion')) || [];
    const datos = {
        negocio: 0,
        cuadrante: 0,
        extorsion: 0,
        conocido: 0
    };

    // Contar las activaciones por tipo
    registros.forEach(registro => {
        switch (registro.tipo) {
            case 'Emergencia Negocio':
                datos.negocio++;
                break;
            case 'Emergencia Cuadrante':
                datos.cuadrante++;
                break;
            case 'Emergencia por Extorsión':
                datos.extorsion++;
                break;
            case 'Emergencia a Conocido':
                datos.conocido++;
                break;
        }
    });

    // Calcular el total de activaciones
    const totalActivaciones = registros.length;
    
    // Animación del contador total
    animateCounter('totalActivacionesGraficas', totalActivaciones);

    // Calcular porcentajes finales
    const porcentajesFinales = {
        negocio: totalActivaciones > 0 ? Math.round((datos.negocio / totalActivaciones) * 100 * 10) / 10 : 0,
        cuadrante: totalActivaciones > 0 ? Math.round((datos.cuadrante / totalActivaciones) * 100 * 10) / 10 : 0,
        extorsion: totalActivaciones > 0 ? Math.round((datos.extorsion / totalActivaciones) * 100 * 10) / 10 : 0,
        conocido: totalActivaciones > 0 ? Math.round((datos.conocido / totalActivaciones) * 100 * 10) / 10 : 0
    };

    // Destruir gráficas existentes si las hay
    ['graficaNegocio', 'graficaCuadrante', 'graficaExtorsion', 'graficaConocido'].forEach(id => {
        const chart = Chart.getChart(id);
        if (chart) chart.destroy();
    });

    // Crear gráficas con animación desde cero
    crearGraficasConAnimacion(porcentajesFinales, datos);
}

// Función para animar el contador
function animateCounter(elementId, targetValue) {
    const element = document.getElementById(elementId);
    let current = 0;
    const increment = targetValue / 100; // Ajustar para que la animación dure aproximadamente 1 segundo
    
    const timer = setInterval(() => {
        current += increment;
        if (current >= targetValue) {
            current = targetValue;
            clearInterval(timer);
        }
        element.textContent = Math.round(current);
    }, 30);
}

function crearGraficasConAnimacion(porcentajesFinales, datos) {
    // Configuración común para todas las gráficas
    const configComun = {
        type: 'doughnut',
        options: {
            responsive: true,
            maintainAspectRatio: true,
            circumference: 360,
            rotation: -90,
            cutout: '70%',
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `${context.label}: ${context.raw}%`;
                        }
                    }
                }
            }
        }
    };

    // Crear gráficas iniciales con 0%
    const charts = {
        negocio: crearGraficaInicial('graficaNegocio', '#FFFF00', '#FFD700', 'Negocio', datos.negocio),
        cuadrante: crearGraficaInicial('graficaCuadrante', '#00FFFF', '#008B8B', 'Cuadrante', datos.cuadrante),
        extorsion: crearGraficaInicial('graficaExtorsion', '#FF0000', '#8B0000', 'Extorsión', datos.extorsion),
        conocido: crearGraficaInicial('graficaConocido', '#FF00FF', '#8B008B', 'Conocido', datos.conocido)
    };

    // Animación para cada gráfica
    Object.keys(porcentajesFinales).forEach((tipo, index) => {
        setTimeout(() => {
            animarGrafica(charts[tipo], porcentajesFinales[tipo], tipo, datos);
        }, index * 300); // Retraso escalonado para cada gráfica
    });
}

function crearGraficaInicial(id, color, colorOscuro, nombreGrafica, activaciones) {
    const container = document.getElementById(id).parentElement;
    container.classList.add(`grafica-${id.replace('grafica', '').toLowerCase()}`);
    
    return new Chart(document.getElementById(id).getContext('2d'), {
        type: 'doughnut',
        data: {
            labels: [nombreGrafica, 'Otros'],
            datasets: [{
                data: [0, 100], // Comienza en 0%
                backgroundColor: [
                    `rgba(${hexToRgb(color).r}, ${hexToRgb(color).g}, ${hexToRgb(color).b}, 0.8)`,
                    `rgba(${hexToRgb(colorOscuro).r}, ${hexToRgb(colorOscuro).g}, ${hexToRgb(colorOscuro).b}, 0.4)`
                ],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            circumference: 360,
            rotation: -90,
            cutout: '70%',
            plugins: {
                legend: { display: false },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            if(context.dataIndex === 0) {
                                return `Activación: ${activaciones}`;
                            }
                            return '';
                        }
                    }
                },
                title: {
                    display: true,
                    text: '0%',
                    color: color,
                    font: { size: 24, weight: 'bold' }
                }
            },
            animation: { duration: 0 } // Desactivar animación inicial
        }
    });
}

function animarGrafica(chart, porcentajeFinal, tipo, datos) {
    let porcentajeActual = 0;
    const duracion = 1500; // 1.5 segundos
    const incremento = porcentajeFinal / (duracion / 16); // 60fps
    
    const animacion = setInterval(() => {
        porcentajeActual += incremento;
        if (porcentajeActual >= porcentajeFinal) {
            porcentajeActual = porcentajeFinal;
            clearInterval(animacion);
        }
        
        // Actualizar datos del gráfico
        chart.data.datasets[0].data = [porcentajeActual, 100 - porcentajeActual];
        
        // Actualizar título con porcentaje
        chart.options.plugins.title.text = `${Math.round(porcentajeActual)}%`;
        
        chart.update();
    }, 16); // ~60fps
}

function hexToRgb(hex) {
    hex = hex.replace('#', '');
    const r = parseInt(hex.substring(0, 2), 16);
    const g = parseInt(hex.substring(2, 4), 16);
    const b = parseInt(hex.substring(4, 6), 16);
    return {r, g, b};
}
   
    // Función para crear gráficas con efecto neón
function crearGraficaNeon(id, porcentaje, color, colorOscuro) {
    const porcentajeRestante = 100 - porcentaje;
    
    // Obtener el número absoluto de activaciones
    let activaciones = 0;
    switch(id) {
        case 'graficaNegocio':
            activaciones = datos.negocio;
            break;
        case 'graficaCuadrante':
            activaciones = datos.cuadrante;
            break;
        case 'graficaExtorsion':
            activaciones = datos.extorsion;
            break;
        case 'graficaConocido':
            activaciones = datos.conocido;
            break;
    }
    
    // Determinar el nombre de la gráfica basado en el ID
    let nombreGrafica = '';
    switch(id) {
        case 'graficaNegocio':
            nombreGrafica = 'Negocio';
            break;
        case 'graficaCuadrante':
            nombreGrafica = 'Cuadrante';
            break;
        case 'graficaExtorsion':
            nombreGrafica = 'Extorsión';
            break;
        case 'graficaConocido':
            nombreGrafica = 'Conocido';
            break;
    }
    
   // Añadir clase para el efecto hover y color específico
   const container = document.getElementById(id).parentElement;
    container.classList.add(`grafica-${id.replace('grafica', '').toLowerCase()}`);

    
    new Chart(document.getElementById(id).getContext('2d'), {
        ...configComun,
        data: {
            labels: [nombreGrafica, 'Otros'],
            datasets: [{
                data: [porcentaje, porcentajeRestante],
                backgroundColor: [
                    `rgba(${hexToRgb(color).r}, ${hexToRgb(color).g}, ${hexToRgb(color).b}, 0.8)`,
                    `rgba(${hexToRgb(colorOscuro).r}, ${hexToRgb(colorOscuro).g}, ${hexToRgb(colorOscuro).b}, 0.4)`
                ],
                borderWidth: 0,
                hoverBackgroundColor: [
                    color,
                    colorOscuro
                ],
                hoverBorderWidth: 2,
                hoverBorderColor: '#ffffff'
            }]
        },
        options: {
            ...configComun.options,
            plugins: {
                ...configComun.options.plugins,
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            // Mostrar "Activaciones: X" en lugar del porcentaje
                            if(context.dataIndex === 0) {
                                return `Activación: ${activaciones}`;
                            } else {
                                return '';
                            }
                        }
                    },
                    bodyFont: {
                        size: 14,
                        weight: 'bold'
                    },
                    boxPadding: 10,
                    boxWidth: 20,
                    usePointStyle: true,
                    borderColor: 'rgba(255,255,255,0.3)',
                    borderWidth: 1,
                    backgroundColor: 'rgba(0,0,0,0.8)',
                    titleFont: {
                        size: 16
                    },
                    footerFont: {
                        size: 12
                    }
                },
                title: {
                    display: true,
                    text: `${porcentaje}%`,
                    color: color,
                    font: {
                        size: 24, // Tamaño aumentado
                        weight: 'bold',
                        family: 'Arial'
                    },
                    padding: {
                        top: 20,
                        bottom: 30
                    }
                }
            },
            animation: {
                animateScale: true,
                animateRotate: true,
                duration: 1500 // Animación más lenta
            }
        }
    });
}

    // Función para convertir color hex a rgb
    function hexToRgb(hex) {
        // Eliminar el # si está presente
        hex = hex.replace('#', '');
        
        // Convertir a valores RGB
        const r = parseInt(hex.substring(0, 2), 16);
        const g = parseInt(hex.substring(2, 4), 16);
        const b = parseInt(hex.substring(4, 6), 16);
        
        return {r, g, b};
    }

    // Crear las gráficas con efectos neón
    crearGraficaNeon('graficaNegocio', porcentajes.negocio, '#FFFF00', '#FFD700'); // Amarillo neón - Oro
    crearGraficaNeon('graficaCuadrante', porcentajes.cuadrante, '#00FFFF', '#008B8B'); // Cian neón - Cian oscuro
    crearGraficaNeon('graficaExtorsion', porcentajes.extorsion, '#FF0000', '#8B0000'); // Rojo neón - Rojo oscuro
    crearGraficaNeon('graficaConocido', porcentajes.conocido, '#FF00FF', '#8B008B'); // Magenta neón - Magenta oscuro

         // Función para actualizar el contador de activaciones
        function actualizarContadorActivaciones() {
                    const registros = JSON.parse(localStorage.getItem('registrosActivacion')) || [];
                    const totalActivaciones = registros.length;
                    document.getElementById('activacionesCount').textContent = totalActivaciones;
                }


         
        // Llamar a esta función al cargar la página para mostrar el contador inicial
        window.addEventListener('load', function() {
        actualizarContadorActivaciones();
    
            // Si el contenedor de gráficas está visible al cargar la página
            if (document.getElementById('graficasContainer').style.display === 'block') {
                actualizarGraficas();
            }
        });

       



    </script>   
</body>
</html>
